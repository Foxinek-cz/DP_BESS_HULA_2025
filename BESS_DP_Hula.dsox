<?xml version="1.0"?>
<!-- DetStudio project descriptor -->
<DetStation scheme="0">
  <guid>7374c23a-54dc-4cd7-a294-cbb8885fede7</guid>
  <!--AMiNi5-->
  <DSversion>3.2.12</DSversion>
  <StationDescriptor>
    <Version>1.0.0</Version>
    <Copyright>(c) 2025, Bc. Jiří Hula</Copyright>
    <Comment>Diplomový projekt.
Řízení bateriového úložiště </Comment>
    <Author>Bc. Jiří Hula</Author>
    <TridetLink>
    </TridetLink>
    <VersionAutoIncrement>False</VersionAutoIncrement>
    <PostBuild>
    </PostBuild>
    <Sapp>False</Sapp>
    <EepromClear>True</EepromClear>
    <UseIoCache>True</UseIoCache>
    <ExternalTerminalPort>ESI_COM_0</ExternalTerminalPort>
    <ExternalTerminalBaudRate>9600</ExternalTerminalBaudRate>
    <ExternalTerminalFullDuplex>0</ExternalTerminalFullDuplex>
    <SaveSourceCode>False</SaveSourceCode>
    <SourceCodePassword>ohN7g7AKuLkwh454d98geA==</SourceCodePassword>
    <PreprocessDirective>
    </PreprocessDirective>
    <DebugConsoleRemotePort>32320</DebugConsoleRemotePort>
    <DebugConsoleIP>255.255.255.255</DebugConsoleIP>
    <DebugConsoleAutoOpen>False</DebugConsoleAutoOpen>
    <Notes><![CDATA[{\rtf1\ansi\ansicpg1250\deff0\nouicompat\deflang1029{\fonttbl{\f0\fnil\fcharset238 Segoe UI;}{\f1\fnil\fcharset0 Segoe UI;}{\f2\fnil\fcharset2 Symbol;}}
{\colortbl ;\red0\green0\blue255;}
{\*\generator Riched20 10.0.22621}\viewkind4\uc1 
\pard{\*\pn\pnlvlcont\pnf2\pnindent500{\pntxtb\'B7}}\li135\ri135\f0\fs29 Tento projekt je p\'f8\f1\lang1033\'ed\f0\lang1029 loha k DIPLOMOV\f1\lang1033\'c9\f0\lang1029  PR\f1\lang1033\'c1\f0\lang1029 CI:\f1\lang1033\line\par
HULA, Ji\f0\'f8\f1\'ed. \f0\'d8\f1\'edzen\'ed bateriov\'e9ho \'falo\f0\'9ei\'9at\'ec pomoc\f1\'ed PLC spole\f0\'e8nosti AMiT. Brno, 2025.\par
Dostupn\f1\'e9 tak\'e9 z: {{\field{\*\fldinst{HYPERLINK https://www.vut.cz/studenti/zav-prace/detail/165768 }}{\fldrslt{https://www.vut.cz/studenti/zav-prace/detail/165768\ul0\cf0}}}}\f1\fs29 . Di-\par
plomov\'e1 pr\'e1ce. Vysok\'e9 u\f0\'e8en\f1\'ed technick\'e9 v Brn\f0\'ec, Fakulta strojn\f1\'edho in\f0\'9een\f1\'fdrstv\'ed, \'dastav\par
automatizace a informatiky, Vedouc\'ed pr\'e1ce: Ing. et Ing. Stanislav Lang, Ph.D.\f0\lang1029\par
}
]]></Notes>
  </StationDescriptor>
  <ExternalStationManager>
    <Stations />
  </ExternalStationManager>
  <Languages Actual="cs-CZ">
    <Language ci="cs-CZ" />
  </Languages>
  <Project Class="Amit.Ngs.Ide.NgsIde">
    <Data Class="Amit.Ngs.Core.NgsData">
      <HeaderEditMode>0</HeaderEditMode>
      <SecurityConfig>
        <DisableUDP>False</DisableUDP>
      </SecurityConfig>
      <CommunicationProfileManager>
        <Active>0</Active>
        <CommunicationProfile Name="Profile1" Class="Amit.Ngs.Core.NgsEthernetProfile">
          <StationAddress>1</StationAddress>
          <Comment>
          </Comment>
          <IP>192.168.1.1</IP>
          <Port>75</Port>
          <Timeout>2000</Timeout>
          <User>
          </User>
          <Password>ohN7g7AKuLkwh454d98geA==</Password>
          <Pin>ohN7g7AKuLkwh454d98geA==</Pin>
        </CommunicationProfile>
      </CommunicationProfileManager>
      <HwDescriptor>
        <VariableBackup>True</VariableBackup>
        <Ident1>
        </Ident1>
        <Ident2>
        </Ident2>
      </HwDescriptor>
      <ObjectList>
        <Object Name="IO" Class="Amit.Ngs.Core.HwAmini5" Def="HwAmini5">
          <Id>1</Id>
          <Authority>3</Authority>
          <Object Name="DI00" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>2</Id>
            <Authority>3</Authority>
            <Channel>0</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DI01" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>3</Id>
            <Authority>3</Authority>
            <Channel>1</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DI02" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>4</Id>
            <Authority>3</Authority>
            <Channel>2</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DI03" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>5</Id>
            <Authority>3</Authority>
            <Channel>3</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DI04" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>6</Id>
            <Authority>3</Authority>
            <Channel>4</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DI05" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>7</Id>
            <Authority>3</Authority>
            <Channel>5</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DI06" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>8</Id>
            <Authority>3</Authority>
            <Channel>6</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DI07" Class="Amit.Ngs.Core.NgsIoDi" Def="IoDI">
            <Id>9</Id>
            <Authority>3</Authority>
            <Channel>7</Channel>
            <Negation>False</Negation>
            <AC>False</AC>
          </Object>
          <Object Name="DO00" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>10</Id>
            <Authority>3</Authority>
            <Channel>0</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="DO01" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>11</Id>
            <Authority>3</Authority>
            <Channel>1</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="DO02" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>12</Id>
            <Authority>3</Authority>
            <Channel>2</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="DO03" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>13</Id>
            <Authority>3</Authority>
            <Channel>3</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="DO04" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>14</Id>
            <Authority>3</Authority>
            <Channel>4</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="DO05" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>15</Id>
            <Authority>3</Authority>
            <Channel>5</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="DO06" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>16</Id>
            <Authority>3</Authority>
            <Channel>6</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="DO07" Class="Amit.Ngs.Core.NgsIoDo" Def="IoDO">
            <Id>17</Id>
            <Authority>3</Authority>
            <Channel>7</Channel>
            <Negation>False</Negation>
          </Object>
          <Object Name="AI00" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>18</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>0</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AI01" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>19</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>1</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AI02" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>20</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>2</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AI03" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>21</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>3</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AI04" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>22</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>4</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AI05" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>23</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>5</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AI06" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>24</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>6</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AI07" Class="Amit.Ngs.Core.NgsIoAi" Def="IoAIRangeRtd">
            <Id>25</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>7</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <RtdType>1</RtdType>
            <NtcType>1</NtcType>
            <Filter>0</Filter>
            <Negation>False</Negation>
            <BindInterpol>
            </BindInterpol>
            <ValidMode>1,0,2,3</ValidMode>
            <A>1</A>
            <B>0</B>
            <Range>10</Range>
          </Object>
          <Object Name="AO0" Class="Amit.Ngs.Core.NgsIoAo" Def="IoAORange">
            <Id>26</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>0</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <ValidMode>1</ValidMode>
          </Object>
          <Object Name="AO1" Class="Amit.Ngs.Core.NgsIoAo" Def="IoAORange">
            <Id>27</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>1</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <ValidMode>1</ValidMode>
          </Object>
          <Object Name="AO2" Class="Amit.Ngs.Core.NgsIoAo" Def="IoAORange">
            <Id>28</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>2</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <ValidMode>1</ValidMode>
          </Object>
          <Object Name="AO3" Class="Amit.Ngs.Core.NgsIoAo" Def="IoAORange">
            <Id>29</Id>
            <Authority>3</Authority>
            <Mode>1</Mode>
            <Channel>3</Channel>
            <ElectricalMinimum>0</ElectricalMinimum>
            <ElectricalMaximum>10</ElectricalMaximum>
            <PhysicalMinimum>0</PhysicalMinimum>
            <PhysicalMaximum>10</PhysicalMaximum>
            <ValidMode>1</ValidMode>
          </Object>
          <Object Name="MtxDI" Class="Amit.Ngs.Core.NgsIoLocMtxDi" Def="IoLocMtxDI">
            <Comment>.</Comment>
            <Id>30</Id>
            <Authority>3</Authority>
          </Object>
          <Object Name="MtxDO" Class="Amit.Ngs.Core.NgsIoLocMtxDo" Def="IoLocMtxDO">
            <Comment>.</Comment>
            <Id>31</Id>
            <Authority>3</Authority>
          </Object>
          <Object Name="MtxAI" Class="Amit.Ngs.Core.NgsIoLocMtxAi" Def="IoLocMtxAI">
            <Comment>.</Comment>
            <Id>32</Id>
            <Authority>3</Authority>
          </Object>
          <Object Name="MtxAO" Class="Amit.Ngs.Core.NgsIoLocMtxAo" Def="IoLocMtxAO">
            <Comment>.</Comment>
            <Id>33</Id>
            <Authority>3</Authority>
          </Object>
        </Object>
        <Object Name="DateTime" Class="Amit.Ngs.Core.DsGenericObject" Def="DateTime">
          <Id>34</Id>
          <Authority>3</Authority>
          <Comment>
          </Comment>
          <Property BindId="0" Value="0" />
          <Property BindId="1" Value="0" />
          <Property BindId="2" Value="0" />
          <Property BindId="3" Value="0" />
          <Property BindId="4" Value="0" />
          <Property BindId="5" Value="0" />
          <Property BindId="6" Value="0" />
          <Property BindId="7" Value="0" />
          <Property BindId="8" Value="0" />
        </Object>
        <Object Name="App" Class="Amit.Ngs.Core.DsGenericObject" Def="App">
          <Id>35</Id>
          <Authority>3</Authority>
          <Comment>
          </Comment>
          <Property BindId="0" Value="0" />
          <Property BindId="1" Value="0" />
          <Property BindId="2" Value="0" />
          <Property BindId="3" Value="0" />
          <Property BindId="4" Value="0" />
        </Object>
        <Object Name="EEprom" Class="Amit.Ngs.Core.NgsEEpromVariables" Def="">
          <Id>36</Id>
          <Authority>3</Authority>
        </Object>
        <Object Name="WebServer" Class="Amit.Ngs.Core.DsWebServer" Def="WebServer">
          <Id>37</Id>
          <Authority>3</Authority>
          <HttpPort>80</HttpPort>
          <HttpsPort>443</HttpsPort>
          <FtpPort>21</FtpPort>
          <FtpEnabled>True</FtpEnabled>
          <HttpEnabled>True</HttpEnabled>
          <StorageDevice>1</StorageDevice>
        </Object>
        <Object Name="RamConnector" Class="Amit.Ngs.Core.NgsRamConnector" Def="">
          <Id>38</Id>
          <Authority>3</Authority>
        </Object>
        <Object Name="PersistentStorage" Class="Amit.Ngs.Core.PersistentMemoryManager" Def="">
          <Id>39</Id>
          <Authority>3</Authority>
        </Object>
        <Object Name="Ela" Class="Amit.Ngs.Core.NgsElaStorage" Def="">
          <Id>40</Id>
          <Authority>3</Authority>
          <ELAStorage>
            <Object Name="TMP" Class="Amit.Ngs.Core.NgsElaVarMatrix" Def="">
              <Id>41</Id>
              <Authority>3</Authority>
              <Typ>5</Typ>
              <DimRow>1</DimRow>
              <DimCol>1</DimCol>
            </Object>
            <Object Name="TMPF" Class="Amit.Ngs.Core.NgsElaVarMatrix" Def="">
              <Id>42</Id>
              <Authority>3</Authority>
              <Typ>6</Typ>
              <DimRow>1</DimRow>
              <DimCol>1</DimCol>
            </Object>
          </ELAStorage>
          <RSKey />
        </Object>
        <Object Name="BackupRamConnector" Class="Amit.Ngs.Core.NgsBackupRamConnector" Def="">
          <Id>43</Id>
          <Authority>3</Authority>
        </Object>
        <Object Name="EEpromConnector" Class="Amit.Ngs.Core.NgsEEpromConnector" Def="">
          <Id>44</Id>
          <Authority>65535</Authority>
        </Object>
        <Object Name="ProcessInit" Class="Amit.Ngs.Core.NgsProcessInit" Def="ProcessInit">
          <Id>45</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[]]><Regions /></Body>
        </Object>
        <Object Name="SysCom" Class="Amit.Ngs.Core.NgsRemoteEsi" Def="SysCom">
          <Id>46</Id>
          <Authority>3</Authority>
          <SerialPort>0</SerialPort>
          <Baudrate>38400</Baudrate>
          <Parity>1</Parity>
          <Mode>0</Mode>
          <Enabled>True</Enabled>
        </Object>
        <Object Name="DateTimeSettings" Class="Amit.Ngs.Core.DsGenericObject" Def="DateTimeSettings">
          <Id>47</Id>
          <Authority>3</Authority>
          <Comment>
          </Comment>
          <Property BindId="0" Value="1" />
          <Property BindId="1" Value="true" />
          <Property BindId="2" Value="time.google.com" />
          <Property BindId="3" Value="true" />
          <Property BindId="4" Value="0" />
          <Property BindId="5" Value="60" />
        </Object>
        <Object Name="SystemLogger" Class="Amit.Ngs.Core.DsLogger" Def="Logger">
          <Id>48</Id>
          <Authority>3</Authority>
          <Depth>100</Depth>
          <WriteSystemEvent>True</WriteSystemEvent>
          <Enabled>True</Enabled>
        </Object>
        <Object Name="BAT_BMS_CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
          <Id>49</Id>
          <Authority>3</Authority>
          <Typ>1</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>True</CfcPin>
        </Object>
        <Object Name="BAT_CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
          <Id>50</Id>
          <Authority>3</Authority>
          <Typ>1</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>True</CfcPin>
        </Object>
        <Object Name="BAT_STR_CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
          <Id>51</Id>
          <Authority>3</Authority>
          <Typ>1</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>True</CfcPin>
        </Object>
        <Object Name="BAT_STR_write_CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
          <Id>52</Id>
          <Authority>3</Authority>
          <Typ>1</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>True</CfcPin>
        </Object>
        <Object Name="BAT_write_CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
          <Id>53</Id>
          <Authority>3</Authority>
          <Typ>1</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>True</CfcPin>
        </Object>
        <Object Name="MR_BAT" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>54</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>30</DimCol>
        </Object>
        <Object Name="MR_BAT_BMS" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>55</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>44</DimCol>
        </Object>
        <Object Name="MR_BAT_BMS_SET" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>56</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>3</DimCol>
        </Object>
        <Object Name="MR_BAT_SET" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>57</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>10</DimCol>
        </Object>
        <Object Name="MR_BAT_STR" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>58</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>47</DimCol>
        </Object>
        <Object Name="MR_BAT_STR_SET" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>59</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>6</DimCol>
        </Object>
        <Object Name="MR_BAT_TOT" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>60</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>10</DimCol>
        </Object>
        <Object Name="MS_BAT_BMS_COL_DEF" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>61</Id>
          <Authority>3</Authority>
          <Typ>19</Typ>
          <Kind>3</Kind>
          <InitDataFormat>5</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>44</DimRow>
          <DimCol>80</DimCol>
          <InitData>"BasicStatus";"ProtectionInfo";"AlarmInfo";"Napětí";"Proud";"Teplota";"SOC";"SOE";"SOH";"ForceChargeRequest";"BalanceChargeRequest";"MaxVoltage";"MaxChargeCurrent";"MinVoltage";"MaxDisCurrent";"MaxCellVoltage";"MinCellVoltage";"SnOfMaxCellVoltage";"SnOfMinCellVoltage";"MaxCellTemp";"MinCellTemp";"SnOfMaxCellTemp";"SnOfMinCellTemp";"MaxModuleVoltage";"MinModuleVoltage";"SnOfMaxModuleVoltage";"SnOfMinModuleVoltage";"MaxModuleTemp";"MinModuleTemp";"SnOfMaxModuleTemp";"SnOfMinModuleTemp";"RemainCap";"TotalChargeCap";"TotalDischargeCap";"NumberOfCells";"NumberOfModules";"ModulNominalVoltage";"ModulNominalCap";"TerminalMaxTemp";"TerminalMinTemp";"ModulePCBmaxTemp";"ModulePCBminTemp";"AlarmStatus2";"ErrorCode1";</InitData>
        </Object>
        <Object Name="MS_BAT_BMS_SET_COL_DEF" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>62</Id>
          <Authority>3</Authority>
          <Typ>19</Typ>
          <Kind>2</Kind>
          <InitDataFormat>5</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>3</DimRow>
          <DimCol>80</DimCol>
          <InitData>"Typ";"BAT_idx";"Zakazano_Odpojeno";</InitData>
        </Object>
        <Object Name="MS_BAT_COL_DEF" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>63</Id>
          <Authority>3</Authority>
          <Typ>19</Typ>
          <Kind>2</Kind>
          <InitDataFormat>5</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>30</DimRow>
          <DimCol>80</DimCol>
          <InitData>"AktualniCinny";"AktualniCinnyL1";"AktualniCinnyL2";"AktualniCinnyL3";"AktualniJalovy";"AktualniJalovyL1";"AktualniJalovyL2";"AktualniJalovyL3";"Ucinik";"Nabijeni";"Vybijeni";"Napeti_DC";"Proud_DC";"Vykon_DC";"MaxNabijeciVykon";"MaxVybijeciVykon";"MaxVykonSTR";"SoC";"SoH";"SoE - DostupnaKapacita";"TotalDodavka";"TotalOdber";"NuceneNabijeni";"BalancingRequest";"OperationStatus";"AlarmStatus";"RizeniP_Povoleno";"RizeniQ_Povolena";"RizeniP";"RizeniQ";</InitData>
        </Object>
        <Object Name="MS_BAT_SET_COL_DEF" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>64</Id>
          <Authority>3</Authority>
          <Typ>19</Typ>
          <Kind>2</Kind>
          <InitDataFormat>5</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>10</DimRow>
          <DimCol>80</DimCol>
          <InitData>"Typ";"ManualniRizeni";"RucneVykon";"RizeniZakazano";"Pocet_Stridacu";"Pocet_BMS";"MaxDC_Napeti";"MinDC_Napeti";"CelkovyVykon";"CelkovaKapacita";</InitData>
        </Object>
        <Object Name="MS_BAT_STR_COL_DEF" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>65</Id>
          <Authority>3</Authority>
          <Typ>19</Typ>
          <Kind>2</Kind>
          <InitDataFormat>5</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>47</DimRow>
          <DimCol>80</DimCol>
          <InitData>"AktualniCinny";"AktualniCinnyL1";"AktualniCinnyL2";"AktualniCinnyL3";"AktualniJalovy";"AktualniJalovyL1";"AktualniJalovyL2";"AktualniJalovyL3";"AktualniZdanlivy";"AktualniZdanlivyL1";"AktualniZdanlivyL2";"AktualniZdanlivyL3";"Frekvence";"NapetiL1";"NapetiL2";"NapetiL3";"ProudL1";"ProudL2";"ProudL3";"Ucinik";"UcinikL1";"UcinikL2";"UcinikL3";"NapetiL1L2";"NapetiL2L3";"NapetiL3L1";"CelkemCinny";"CelkemCinnyOdber";"CelkemCinnyDodavka";"CelkemJalovy";"CelkemJalovyOdber";"CelkemJalovyDodavka";"Napeti_DC";"Proud_DC";"Vykon_DC";"Teplota_Heatsink";"Teplota_PCB";"Heartbeat_Read";"Heartbeat_Write";"MaxPower";"Status";"Alarm";"ReportRizeniP";"ReportRizeniQ";"RezimRizeni";"RizeniP";"RizeniQ";</InitData>
        </Object>
        <Object Name="MS_BAT_STR_SET_COL_DEF" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>66</Id>
          <Authority>3</Authority>
          <Typ>19</Typ>
          <Kind>2</Kind>
          <InitDataFormat>5</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>6</DimRow>
          <DimCol>80</DimCol>
          <InitData>"Typ";"BAT_idx";"ManualniRizeni";"RucneVykon";"ZakazanoRizeni";"Vykon";</InitData>
        </Object>
        <Object Name="MS_BAT_TOT_COL_DEF" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>67</Id>
          <Authority>3</Authority>
          <Typ>19</Typ>
          <Kind>2</Kind>
          <InitDataFormat>5</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>10</DimRow>
          <DimCol>80</DimCol>
          <InitData>"ActivePower";"Nabijeni";"Vybijeni";"SOC";"DostupnaKapacita";"CelkovaKapacita";"MaxNabijeciVykon";"MaxVybijeciVykon";"PovoleniRizeniP";"RizeniP";</InitData>
        </Object>
        <Object Name="BAT_read" Class="Amit.Ngs.Core.NgsProcessPeriod" Def="Process">
          <ParentObject>Global</ParentObject>
          <Id>68</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[BAT_AktVykon = 0;
BAT_Nabijeni = 0.0;
BAT_Vybijeni = 0.0;
BAT_MaxVybVykon = 0;
BAT_MaxNabVykon = 0;
BAT_DostupnaKapacita = 0.0;
BAT_CelkovaKapacita = 0.0;
BAT_SoC = 0;
CountBAT_OK = 0;
MR_BAT_TOT[0, 0] = 0.0;
MR_LOK_SET[0, 4] = 0.0;
MR_LOK_SET[0, 5] = 0.0;

BAT_CurrentRowInt = 0;
BAT_STR_CurrentRowInt = 0;
BAT_BMS_CurrentRowInt = 0;

For Hodnota = 0 To (GetDimRow(MR_BAT_STR) - 1) Do
	BAT_STR_CurrentRowInt = Hodnota;
	
    Call BAT_Refu_Read_v3;
    
EndFor;   
    
For Hodnota = 0 To (GetDimRow(MR_BAT_BMS) - 1) Do
	BAT_BMS_CurrentRowInt = Hodnota;
	
    Call BMS_PylonTech;
    
EndFor;     
    
For Hodnota = 0 To (GetDimRow(MR_BAT) - 1) Do
	BAT_CurrentRowInt = Hodnota;    

    Call BAT_Assignment;
    
    // pokud není BAT zakázána nebo v ručním řízení nebo není v chybě
    if (MR_BAT_SET[BAT_CurrentRowInt, 1] == 0) and (MR_BAT_SET[BAT_CurrentRowInt, 3] == 0) and (MR_BAT[BAT_CurrentRowInt, 24] != 7) then
        CountBAT_OK = CountBAT_OK + 1;
        
        BAT_SoC = BAT_SoC + MR_BAT[BAT_CurrentRowInt, 17]; // Soc
        BAT_AktVykon = BAT_AktVykon + MR_BAT[BAT_CurrentRowInt, 0]; // aktuální výkon celkový
        BAT_Nabijeni = BAT_Nabijeni + MR_BAT[BAT_CurrentRowInt, 9];
	    BAT_Vybijeni = BAT_Vybijeni + MR_BAT[BAT_CurrentRowInt, 10];
        BAT_MaxNabVykon = BAT_MaxNabVykon + MR_BAT[BAT_CurrentRowInt, 14]; // max. nabíjecí výkon Lokality
        BAT_MaxVybVykon = BAT_MaxVybVykon + MR_BAT[BAT_CurrentRowInt, 15]; // max. vybíjecí výkon Lokality
        BAT_DostupnaKapacita = BAT_DostupnaKapacita + MR_BAT[BAT_CurrentRowInt, 19]; // dostupná kapacita Lokality
        BAT_CelkovaKapacita = BAT_CelkovaKapacita + MR_BAT_SET[BAT_CurrentRowInt, 9]; // celková kapacita Lokality
    endif;
    
EndFor;     

BAT_SoC = BAT_SoC / CountBAT_OK; // výpočet průměrné SoC

MR_BAT_TOT[0, 0] = BAT_AktVykon;
MR_BAT_TOT[0, 1] = BAT_Nabijeni;
MR_BAT_TOT[0, 2] = BAT_Vybijeni;
MR_BAT_TOT[0, 3] = BAT_SoC;
MR_BAT_TOT[0, 4] = BAT_DostupnaKapacita;
MR_BAT_TOT[0, 5] = BAT_CelkovaKapacita;
MR_BAT_TOT[0, 6] = BAT_MaxNabVykon;
MR_BAT_TOT[0, 7] = BAT_MaxVybVykon;

MR_LOK_SET[0, 4] = BAT_MaxNabVykon;
MR_LOK_SET[0, 5] = BAT_MaxVybVykon;

MR_LOK[0, 13] = BAT_Nabijeni; //kWh
MR_LOK[0, 14] = BAT_Vybijeni; //kWh]]><Regions /></Body>
          <Object Name="BAT_Vybijeni" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>69</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Hodnota" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>70</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BAT_Nabijeni" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>71</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BAT_CelkovaKapacita" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>72</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BAT_DostupnaKapacita" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>73</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Hodnota_2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>74</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BAT_AktVykon" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>75</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BAT_MaxNabVykon" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>76</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BAT_MaxVybVykon" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>77</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BAT_SoC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>78</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="CountBAT_OK" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>79</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Period>100</Period>
          <Offset>0</Offset>
          <Priority>1</Priority>
          <RunOrder>0</RunOrder>
        </Object>
        <Object Name="BAT_write" Class="Amit.Ngs.Core.NgsProcessPeriod" Def="Process">
          <ParentObject>Global</ParentObject>
          <Id>80</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[
//CHARGE -
//DISCHARGE +

BAT_STR_write_CurrentRowInt = 0;
BAT_write_CurrentRowInt = 0;



For Hodnota = 0 To (GetDimRow(MR_BAT) - 1) Do
    BAT_write_CurrentRowInt = Hodnota;
    
    if (MR_BAT_SET[BAT_write_CurrentRowInt, 1] == 0) and (MR_BAT_SET[BAT_write_CurrentRowInt, 3] == 0) and (MR_BAT[BAT_write_CurrentRowInt, 24] != 7) then
    
        // výpočet požadovaného výkonu pro konkrétní BAT z požadavku z BAT_TOT, rozdeleny na vyb/nab  ( pozadovanyP * (MaxBAT / MaxBAT_TOT))  + zohlednění nepoměru SoC 
       // SoC_PoweCompensation = (MR_BAT_TOT[0, 3] - MR_BAT[BAT_write_CurrentRowInt, 17]) / 100; // výpočet zohlednění nerovnoměrnosti SoC
        if MR_BAT_TOT[0, 9] > 0 then
            MR_BAT[BAT_write_CurrentRowInt, 28] = MR_BAT_TOT[0, 9] * ((MR_BAT[BAT_write_CurrentRowInt, 15] / MR_BAT_TOT[0, 7])) ; // vybíjení
        else
            MR_BAT[BAT_write_CurrentRowInt, 28] = MR_BAT_TOT[0, 9] * ((MR_BAT[BAT_write_CurrentRowInt, 14] / MR_BAT_TOT[0, 6])); // nabíjení
        endif;
        
        MR_BAT[BAT_write_CurrentRowInt, 26] = MR_BAT_TOT[0, 8]; // povolení řízení při požadovaném výkonu
        
    endif;
    
    // ochrana - omezení maximálními výkony
    if MR_BAT[BAT_write_CurrentRowInt, 28] > MR_BAT[BAT_write_CurrentRowInt, 15] then
        MR_BAT[BAT_write_CurrentRowInt, 28] = MR_BAT[BAT_write_CurrentRowInt, 15]; // limitování max. vyb. výkonem
    endif;
    if MR_BAT[BAT_write_CurrentRowInt, 28] < -MR_BAT[BAT_write_CurrentRowInt, 14] then
        MR_BAT[BAT_write_CurrentRowInt, 28] = -MR_BAT[BAT_write_CurrentRowInt, 14]; // limitování max. nab. výkonem
    endif;
        
    // distribuce řízení z matic BAT do matic STR 
    Call BAT_to_STR_write;
     
EndFor;


// propsání řízení všech matic STR do modbusu


For Hodnota = 0 To (GetDimRow(MR_BAT_STR) - 1) Do
	BAT_STR_write_CurrentRowInt = Hodnota;
	Case Real_To_Int(MR_BAT_STR_SET[BAT_STR_write_CurrentRowInt, 0]) Of
		0: //Refu
            Call BAT_Refu_Write_v2;
            
	EndCase;

EndFor;
]]><Regions /></Body>
          <Object Name="Hodnota" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>81</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SoC_PoweCompensation" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>83</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Period>100</Period>
          <Offset>0</Offset>
          <Priority>1</Priority>
          <RunOrder>1</RunOrder>
        </Object>
        <Object Name="MR_LOK" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>84</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>15</DimCol>
        </Object>
        <Object Name="MR_LOK_SET" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>85</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>True</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>8</DimCol>
          <InitData>0;0;100;0;0;0;0;0;</InitData>
        </Object>
        <Object Name="fb_BMS_Control" Class="Amit.Ngs.Core.NgsFunctionBlock" Def="fb_BMS_Control">
          <ParentObject>Global</ParentObject>
          <Id>-1</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[//TMP_Balance = 0;
TMP_Charge = 0;
TMP_MaxChargeP = 0;
TMP_MaxDischargeP = 0;

// výpočet výkonů z max.proudů a aktuálního napětí
//TMP_MaxChargeP = (MaxChargeI * BatU) / 1000; // kW
//TMP_MaxDischargeP = (MaxDischargeI * BatU * -1) / 1000; // kW

// Výpočet přizpůsobené nabíjecí křivky - s ohledem na teplotu a napětí článků
ChargeTCurve(Input = MaxCellT);
ChargeCurve(Input = MaxCellU);
TMP_MaxChargeI = MIN(CellCap * ChargeCurve.Output,CellCap * ChargeTCurve.Output);
TMP_MaxChargeP =  TMP_MaxChargeI < MaxChargeI ? (TMP_MaxChargeI * BatU) : (MaxChargeI * BatU);
TMP_MaxChargeP = TMP_MaxChargeP / 1000;  // kW

// Výpočet přizpůsobené vybíjecí křivky - s ohledem na teplotu a napětí článků
DischargeTCurve(Input = MaxCellT);
DischargeCurve(Input = MinCellU);
TMP_MaxDischargeI = MIN(CellCap * DischargeCurve.Output, CellCap * DischargeTCurve.Output);
TMP_MaxDischargeP =  TMP_MaxDischargeI < ABS(MaxDischargeI) ? (TMP_MaxDischargeI * BatU) : (ABS(MaxDischargeI) * BatU);
TMP_MaxDischargeP = TMP_MaxDischargeP / 1000;  // kW


if (((MaxCellU - MinCellU) < StdCellDisbalance ) and (MinCellU > 3.4 )) or (((MinModuleU > 34) and (MaxModuleU - MinModuleU) < StdModuleDisbalance)) then
    TMP_Balance = 0; 
endif;

if ((MaxCellU - MinCellU) > ((StdCellDisbalance + MaxCellDisbalance)/2)) or ((MaxModuleU - MinModuleU) > ((StdModuleDisbalance + MaxModuleDisbalance) / 2)) then
    TMP_Balance = 2; 
endif;

if ((MaxCellU - MinCellU) > MaxCellDisbalance) or ((MaxModuleU - MinModuleU) > MaxModuleDisbalance) then
    TMP_Balance = 1; 
endif;



// ochrana před nízkým napětím
if (MinCellU < MinCellVoltage) or (MinModuleU < MinModuleVoltage) or (BatU < MinBMS_U)then
    TMP_Charge = 1;
    TMP_MaxDischargeP = 0;
endif;
// ochrana před vysokým napětím
if (MaxCellU > MaxCellVoltage) or (MaxModuleU > MaxModuleVoltage) or (BatU > MaxBMS_U) then
    TMP_MaxChargeP = 0;
endif;

// teplotní ochrana 
if MinCellT <= 0 then
     TMP_MaxChargeP = 0;
     TMP_MaxDischargeP = 0;
endif;

// teplotní ochrana 
if MaxCellT > 50 then
     TMP_MaxChargeP = 0;
endif;

// výstupy z funkčního bloku
MaxChargeP = TMP_MaxChargeP;
MaxDischargeP = TMP_MaxDischargeP;
ChargeReq = IN_ChargeReq != 0  ? 1 : TMP_Charge;  //Max(IN_ChargeReq, TMP_Charge);
BalanceReq = IN_BalanceReq != 0 ? 1 : TMP_Balance;  //Max(IN_BalanceReq, TMP_Balance);]]><Regions /></Body>
          <Object Name="ChargeReq" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>5</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BalanceReq" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>5</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxChargeP" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>5</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxDischargeP" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>5</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxChargeI" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxDischargeI" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BatU" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BatI" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinModuleU" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxModuleU" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinCellU" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxCellU" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinBMS_U" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxBMS_U" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="IN_BalanceReq" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="IN_ChargeReq" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="DischargeCurve" Class="Amit.Ngs.Core.DsInterpol" Def="Interpol">
            <Rename>True</Rename>
            <ParentObject>fb_BMS_Control</ParentObject>
            <Id>-1</Id>
            <Authority>3</Authority>
            <Section>6</Section>
            <DataValue>0;0;3;0;3.05;1;3.45;1;3.55;0.8;3.75;0</DataValue>
          </Object>
          <Object Name="TMP_Balance" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_Charge" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_MaxChargeP" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_MaxDischargeP" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxCellDisbalance" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>0.03</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxModuleDisbalance" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>0.3</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinCellVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>3</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinModuleVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>30</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxCellVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>3.65</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxModuleVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>36.5</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="KoefC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>0.95</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="StdCellDisbalance" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>0.01</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="StdModuleDisbalance" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>0.1</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ChargeCurve" Class="Amit.Ngs.Core.DsInterpol" Def="Interpol">
            <Rename>True</Rename>
            <ParentObject>fb_BMS_Control</ParentObject>
            <Id>-1</Id>
            <Authority>3</Authority>
            <Section>13</Section>
            <DataValue>0;0;2;0;2.5;0.1;3;1;3.4;1;3.43;0.5;3.45;0.3;3.47;0.2;3.49;0.1;3.51;0.05;3.55;0.005;3.6;0;4;0</DataValue>
          </Object>
          <Object Name="CellCap" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>v Ah</Comment>
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_MaxChargeI" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_MaxDischargeI" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinCellT" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxCellT" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>-1</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>4</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ChargeTCurve" Class="Amit.Ngs.Core.DsInterpol" Def="Interpol">
            <Rename>True</Rename>
            <ParentObject>fb_BMS_Control</ParentObject>
            <Id>-1</Id>
            <Authority>3</Authority>
            <Section>5</Section>
            <DataValue>0;0;0;1;38;1;45;0.1;47;0</DataValue>
          </Object>
          <Object Name="DischargeTCurve" Class="Amit.Ngs.Core.DsInterpol" Def="Interpol">
            <Rename>True</Rename>
            <ParentObject>fb_BMS_Control</ParentObject>
            <Id>-1</Id>
            <Authority>3</Authority>
            <Section>6</Section>
            <DataValue>0;0;0;0;0;1;45;1;47;0.1;50;0</DataValue>
          </Object>
          <HTMLDoc_cs>
          </HTMLDoc_cs>
          <HTMLDoc_en>
          </HTMLDoc_en>
        </Object>
        <Object Name="BAT_Refu_Read_v3" Class="Amit.Ngs.Core.NgsSubroutine" Def="Subroutine">
          <Rename>True</Rename>
          <ParentObject>Global</ParentObject>
          <Id>86</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[AC_ApparentPower = 0;
AC_Current = 0;
AC_Current_L1 = 0;
AC_Current_L2 = 0;
AC_Current_L3 = 0;
AC_Energy_Wh = 0;
AC_Frequency = 0;
AC_Power = 0;
AC_PowerFactor = 0;
AC_ReactivePower = 0;
AC_Voltage_AB = 0;
AC_Voltage_AN = 0;
AC_Voltage_BC = 0;
AC_Voltage_BN = 0;
AC_Voltage_CA = 0;
AC_Voltage_CN = 0;
ARtg = 0;
AhrRtg = 0;
ClcTotVA = 0;
Conn = 0;
ConnPh = 0;
Conn_RvrtTms = 0;
Conn_WinTms = 0;
ControllerHb = 0;
DC_Current = 0;
DC_Power = 0;
DC_Voltage = 0;
ECPNomHz = 0;
Evt1 = 0;
Evt1_DIAG = 0;
LocRemCtl = 0;
MaxA = 0;
MaxACur = 0;
MaxBatACha = 0;
MaxBatADischa = 0;
MaxChaRte = 0;
MaxDisChaRte = 0;
MaxRmpRte = 0;
Model_ID = 0;
Model_ID_120 = 0;
Model_ID_121 = 0;
Model_ID_123 = 0;
Model_ID_64800 = 0;
Model_Length = 0;
Model_Length_120 = 0;
Model_Length_121 = 0;
Model_Length_123 = 0;
Model_Length_64800 = 0;
OperatingState = -1000; // pro identifikaci nekomunikace 
OutPFSet = 0;
OutPFSet_Ena = 0;
OutPFSet_RmpTms = 0;
OutPFSet_RvrtTms = 0;
OutPFSet_WinTms = 0;
PCSAlarmReset = 0;
PCSHb = 0;
PCSSetOperation = 0;
PFMinQ1 = 0;
PFMinQ2 = 0;
PFMinQ3 = 0;
PFMinQ4 = 0;
PFRtgQ1 = 0;
PFRtgQ2 = 0;
PFRtgQ3 = 0;
PFRtgQ4 = 0;
Pad_64800 = 0;
Temp_Cabinet = 0;
Temp_Heatsink = 0;
Temp_Transf = 0;
Temp_Other = 0;
VAMax = 0;
VARtg = 0;
VArAct = 0;
VArAvalPct = 0;
VArMaxPct = 0;
VArMaxQ1 = 0;
VArMaxQ2 = 0;
VArMaxQ3 = 0;
VArMaxQ4 = 0;
VArPct_Ena = 0;
VArPct_Mod = 0;
VArPct_RmpTms = 0;
VArPct_RvrtTms = 0;
VArPct_WinTms = 0;
VArRtgQ1 = 0;
VArRtgQ2 = 0;
VArRtgQ3 = 0;
VArRtgQ4 = 0;
VArWMaxPct = 0;
VMax = 0;
VMin = 0;
VRef = 0;
VRefOfs = 0;
WGra = 0;
WHRtg = 0;
WMax = 0;
WMaxLimPct = 0;
WMaxLimPct_RmpTms = 0;
WMaxLimPct_RvrtTms = 0;
WMaxLimPct_WinTms = 0;
WMaxLim_Ena = 0;
WRtg = 0;
FW1 = 0;
FW2 = 0;
FW3 = 0;
FW4 = 0;
RemoteMaxPower = 0;
BatteryVoltageLimit_Max = 0; 
BatteryVoltageLimit_Min = 0; 
ExternalHeartbeatTimeout = 0;

CurrentRowInt = BAT_STR_CurrentRowInt; // převzetí aktuálního řádku do lokální proměnné

ValChange1(Val= DateTime.Second ,Mode=0  ,Init=0);
if ValChange1.Out then
    MB_Readed = MB_ZEROS;
endif;

Case CurrentRowInt Of 
  0:   
    If BAT.REFUv2.enabled and BAT.TCPStatus == 4 then
    // Volání modbus čtení
        BAT.REFUv2.AC_Power.Refresh(); // rychle vycitani aktualniho vykonu
        AC_Power = Int_To_Real(BAT.REFUv2.AC_Power[0,0]) * POW(10, Int_To_Real(BAT.REFUv2.AC_Power[0,1])); // W, Aktuální činný výkon
        
        
        IF (DateTime.Second MOD 3 == 0) and not(MB_Readed[CurrentRowInt,0]) then
            BAT.REFUv2.Arr103.Refresh();
            BAT.REFUv2.RemoteMaxPower.Refresh();
            BAT.REFUv2.WRtg.Refresh();
            BAT.REFUv2.PCSHb.Refresh();
        endif;   
            WRtg = Word_To_Real(BAT.REFUv2.WRtg[0,0]) * POW(10, Int_To_Real(BAT.REFUv2.WRtg[0,1])); // W, Jmenovitý činný výkon střídače
            RemoteMaxPower = BAT.REFUv2.RemoteMaxPower; // 0.1% , omezení AC activepower výstupu    
            PCSHb = BAT.REFUv2.PCSHb; // -, Heartbeat invertoru
            // Model 103 (Inverter Three Phase)
            // ===============================
            
            Model_ID = BAT.REFUv2.Arr103[0,0]; // -, SunSpec model ID (103 = Inverter Three Phase)
            Model_Length = BAT.REFUv2.Arr103[0,1]; // -, Délka modelu v registrech
            
            AC_Current = Int_To_Real(BAT.REFUv2.Arr103[0,2]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,6])); // A, Celkový AC proud (součet fází)
            AC_Current_L1 = Int_To_Real(BAT.REFUv2.Arr103[0,3]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,6])); // A, Proud fáze L1
            AC_Current_L2 = Int_To_Real(BAT.REFUv2.Arr103[0,4]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,6])); // A, Proud fáze L2
            AC_Current_L3 = Int_To_Real(BAT.REFUv2.Arr103[0,5]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,6])); // A, Proud fáze L3
            
            AC_Voltage_AB = Word_To_Real(BAT.REFUv2.Arr103[0,7]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,13])); // V, Napětí mezi fázemi AB
            AC_Voltage_BC = Word_To_Real(BAT.REFUv2.Arr103[0,8]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,13])); // V, Napětí mezi fázemi BC
            AC_Voltage_CA = Word_To_Real(BAT.REFUv2.Arr103[0,9]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,13])); // V, Napětí mezi fázemi CA
            AC_Voltage_AN = Word_To_Real(BAT.REFUv2.Arr103[0,10]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,13])); // V, Napětí fáze A vůči N
            AC_Voltage_BN = Word_To_Real(BAT.REFUv2.Arr103[0,11]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,13])); // V, Napětí fáze B vůči N
            AC_Voltage_CN = Word_To_Real(BAT.REFUv2.Arr103[0,12]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,13])); // V, Napětí fáze C vůči N
            
            // - pomalé vyčítaní : AC_Power = Int_To_Real(BAT.REFUv2.Arr103[0,14]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,15])); // W, Aktuální činný výkon
           
            AC_Frequency = Word_To_Real(BAT.REFUv2.Arr103[0,16]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,17])); // Hz, Síťová frekvence
            AC_ApparentPower = Int_To_Real(BAT.REFUv2.Arr103[0,18]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,19])); // VA, Zdanlivý výkon
            AC_ReactivePower = Int_To_Real(BAT.REFUv2.Arr103[0,20]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,21])); // var, Jalový výkon
            
            AC_PowerFactor = Int_To_Real(BAT.REFUv2.Arr103[0,22]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,23])) / 100.0; // -, Účiník (Power Factor)
            
            AC_Energy_Wh = DInt_To_Real(SwapDIntBytes(Join_Ints_To_DInt(BAT.REFUv2.Arr103[0,24], BAT.REFUv2.Arr103[0,25]),0)) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,26])); // Wh, Celková vyrobená energie
            
            DC_Current = Word_To_Real(BAT.REFUv2.Arr103[0,27]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,28])); // A, DC proud
            DC_Voltage = Word_To_Real(BAT.REFUv2.Arr103[0,29]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,30])); // V, DC napětí
            DC_Power = Int_To_Real(BAT.REFUv2.Arr103[0,31]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,32])); // W, DC výkon
            
            Temp_Cabinet = Int_To_Real(BAT.REFUv2.Arr103[0,33]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,37])); // °C, Teplota rozvaděče
            Temp_Heatsink = Int_To_Real(BAT.REFUv2.Arr103[0,34]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,37])); // °C, Teplota chladiče
            Temp_Transf = Int_To_Real(BAT.REFUv2.Arr103[0,35]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,37])); // °C, Teplota transformátoru
            Temp_Other = Int_To_Real(BAT.REFUv2.Arr103[0,36]) * POW(10, Int_To_Real(BAT.REFUv2.Arr103[0,37])); // °C, Teplota ostatní
            
            OperatingState = BAT.REFUv2.Arr103[0,38]; // -, 1-Off, 3-Starting, 4-MPPT, 5-Throttled, 6-ShuttingDown, 7-Fault, 8-Standby, 9-Started
            Evt1 = Join_Ints_To_DInt(BAT.REFUv2.Arr103[0,41], BAT.REFUv2.Arr103[0,40]); // -, Bitove pole udalosti (Evt1):
            // rozepsané v aliasech ! :)   
                //  0 = Ground fault
                //  1 = DC over voltage
                //  2 = AC disconnect open
                //  3 = DC disconnect open
                //  4 = Grid shutdown
                //  5 = Cabinet open
                //  6 = Manual shutdown
                //  7 = Over temperature
                //  8 = Over frequency
                //  9 = Under frequency
                // 10 = AC over voltage
                // 11 = AC under voltage
                // 12 = Blown string fuse
                // 13 = Under temperature
                // 14 = Memory loss / Communication error
                // 15 = Hardware test failure
                // 16 = other alarm
                // 17 = other warning
        
        
        IF (DateTime.Second MOD 15 == 0) and A_Diagnostika == 0  and not(MB_Readed[CurrentRowInt,0]) then
            BAT.REFUv2.Arr120.Refresh();
            BAT.REFUv2.Arr121.Refresh();
            BAT.REFUv2.Arr123.Refresh();
            BAT.REFUv2.Arr64800.Refresh();
            BAT.REFUv2.ArrFW.Refresh();
            BAT.REFUv2.Arr1.Refresh();
            BAT.REFUv2.ArrRO.Refresh();
            BAT.REFUv2.ModbusID.Refresh();

            // Model 1 – Common (SunSpec Info)
            // ===============================
            
            SunSpec_ID = Word_To_Real(BAT.REFUv2.Arr1[0,0]); // -, SunSpec identifikátor (vždy 0x53756E53 = "SunS")
            Model_Length = Word_To_Real(BAT.REFUv2.Arr1[0,1]); // -, Délka modelu 1 (66 wordů)
    
            DeviceAddress = BAT.REFUv2.ModbusID; // -, Modbus adresa zařízení
            
            // Model 120 (Inverter Controls Nameplate Ratings)
            // ===============================
            
            Model_ID_120 = BAT.REFUv2.Arr120[0,0]; // -, ID modelu (120 = jmenovité parametry střídače)
            Model_Length_120 = BAT.REFUv2.Arr120[0,1]; // -, Délka modelu ve slovech
            
            //WRtg = Word_To_Real(BAT.REFUv2.Arr120[0,3]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,4])); // W, Jmenovitý činný výkon střídače
            VARtg = Word_To_Real(BAT.REFUv2.Arr120[0,5]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,6])); // VA, Jmenovitý zdánlivý výkon střídače
            
            VArRtgQ1 = Int_To_Real(BAT.REFUv2.Arr120[0,7]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,11])); // var, Jalový výkon ve kvadrantu 1 (capability)
            VArRtgQ2 = Int_To_Real(BAT.REFUv2.Arr120[0,8]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,11])); // var, Jalový výkon ve kvadrantu 2 (capability)
            VArRtgQ3 = Int_To_Real(BAT.REFUv2.Arr120[0,9]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,11])); // var, Jalový výkon ve kvadrantu 3 (capability)
            VArRtgQ4 = Int_To_Real(BAT.REFUv2.Arr120[0,10]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,11])); // var, Jalový výkon ve kvadrantu 4 (capability)
            
            ARtg = Word_To_Real(BAT.REFUv2.Arr120[0,12]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,13])); // A, Jmenovitý RMS proud střídače (capability)
            
            PFRtgQ1 = Int_To_Real(BAT.REFUv2.Arr120[0,14]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,18])); // -, Minimální účiník v kvadrantu 1 (capability)
            PFRtgQ2 = Int_To_Real(BAT.REFUv2.Arr120[0,15]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,18])); // -, Minimální účiník v kvadrantu 2 (capability)
            PFRtgQ3 = Int_To_Real(BAT.REFUv2.Arr120[0,16]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,18])); // -, Minimální účiník v kvadrantu 3 (capability)
            PFRtgQ4 = Int_To_Real(BAT.REFUv2.Arr120[0,17]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,18])); // -, Minimální účiník v kvadrantu 4 (capability)
            
            WHRtg = Word_To_Real(BAT.REFUv2.Arr120[0,19]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,20])); // Wh, Jmenovitá kapacita baterie (capability)
            AhrRtg = Word_To_Real(BAT.REFUv2.Arr120[0,21]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,22])); // Ah, Kapacita v ampérhodinách (capability)
            
            MaxChaRte = Word_To_Real(BAT.REFUv2.Arr120[0,23]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,24])); // W, Maximální rychlost nabíjení (capability)
            MaxDisChaRte = Word_To_Real(BAT.REFUv2.Arr120[0,25]) * POW(10, Int_To_Real(BAT.REFUv2.Arr120[0,26])); // W, Maximální rychlost vybíjení (capability)
            
            
            // Model 121 (Inverter Controls Basic Settings) 
            // ===============================
            Model_ID_121 = BAT.REFUv2.Arr121[0,0]; // -, ID modelu (121 = nastaveni uloziste – zakladni parametry)
            Model_Length_121 = BAT.REFUv2.Arr121[0,1]; // -, Delka modelu ve slovech
            
            WMax = Word_To_Real(BAT.REFUv2.Arr121[0,2]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,22])); // W, Maximalni celkovy vykon uloziste
            VRef = Word_To_Real(BAT.REFUv2.Arr121[0,3]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,23])); // V, Referencni napeti
            VRefOfs = Int_To_Real(BAT.REFUv2.Arr121[0,4]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,24])); // V, Ofset referencniho napeti
            VMax = Word_To_Real(BAT.REFUv2.Arr121[0,5]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,25])); // V, Maximalni napeti
            VMin = Word_To_Real(BAT.REFUv2.Arr121[0,6]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,25])); // V, Minimalni napeti
            VAMax = Word_To_Real(BAT.REFUv2.Arr121[0,7]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,26])); // VA, Maximalni zdánlivy vykon
            
            VArMaxQ1 = Word_To_Real(BAT.REFUv2.Arr121[0,8]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,27])); // var, Max. jalovy vykon Q1 (capability)
            VArMaxQ2 = Word_To_Real(BAT.REFUv2.Arr121[0,9]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,27])); // var, Max. jalovy vykon Q2 (capability)
            VArMaxQ3 = Word_To_Real(BAT.REFUv2.Arr121[0,10]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,27])); // var, Max. jalovy vykon Q3 (capability)
            VArMaxQ4 = Word_To_Real(BAT.REFUv2.Arr121[0,11]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,27])); // var, Max. jalovy vykon Q4 (capability)
            
            WGra = Word_To_Real(BAT.REFUv2.Arr121[0,12]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,28])); // W/s, Rychlost nabehu vykonu
            PFMinQ1 = Int_To_Real(BAT.REFUv2.Arr121[0,13]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,29])); // -, Minimalni PF Q1
            PFMinQ2 = Int_To_Real(BAT.REFUv2.Arr121[0,14]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,29])); // -, Minimalni PF Q2
            PFMinQ3 = Int_To_Real(BAT.REFUv2.Arr121[0,15]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,29])); // -, Minimalni PF Q3
            PFMinQ4 = Int_To_Real(BAT.REFUv2.Arr121[0,16]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,29])); // -, Minimalni PF Q4
            
            VArAct = BAT.REFUv2.Arr121[0,17]; // -, Jalovy rezim: 0-Off, 1-Q1, 2-Q2, 3-Q3, 4-Q4
            ClcTotVA = BAT.REFUv2.Arr121[0,18]; // -, Pocita se VA ze slozek nebo merene
            
            MaxRmpRte = Word_To_Real(BAT.REFUv2.Arr121[0,19]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,30])); // %/s, Max. rampa aktivniho vykonu
            ECPNomHz = Word_To_Real(BAT.REFUv2.Arr121[0,20]) * POW(10, Int_To_Real(BAT.REFUv2.Arr121[0,31])); // Hz, Jmenovita frekvence pro grid
            
            ConnPh = BAT.REFUv2.Arr121[0,21]; // -, Pocet pripojenych fazi
            
            
            // Model 123 (Immediate Inverter Controls)
            // ===============================
            
            Model_ID_123 = BAT.REFUv2.Arr123[0,0]; // -, ID modelu (123 = Immediate Inverter Controls)
            Model_Length_123 = BAT.REFUv2.Arr123[0,1]; // -, Delka modelu ve slovech
            Conn_WinTms = Word_To_Real(BAT.REFUv2.Arr123[0,2]); // s, Casove okno pro pripojeni/odpojeni
            Conn_RvrtTms = Word_To_Real(BAT.REFUv2.Arr123[0,3]); // s, Timeout revert pripojeni
            Conn = BAT.REFUv2.Arr123[0,4]; // -, Rizeni pripojeni: 0=Disconnect, 1=Connect
            WMaxLimPct = Int_To_Real(BAT.REFUv2.Arr123[0,5]) * POW(10, Int_To_Real(BAT.REFUv2.Arr123[0,6])); // %, Limit vykonu v % WRtg
            WMaxLim_Ena = BAT.REFUv2.Arr123[0,7]; // -, Povoleni limitu vykonu
            WMaxLimPct_WinTms = Word_To_Real(BAT.REFUv2.Arr123[0,8]); // s, Casove okno pro zmenu limitu vykonu
            WMaxLimPct_RvrtTms = Word_To_Real(BAT.REFUv2.Arr123[0,9]); // s, Timeout pro zmenu limitu vykonu
            WMaxLimPct_RmpTms = Word_To_Real(BAT.REFUv2.Arr123[0,10]); // s, Doba rampy limitu vykonu
            OutPFSet = Int_To_Real(BAT.REFUv2.Arr123[0,11]) * POW(10, Int_To_Real(BAT.REFUv2.Arr123[0,24])) / 100.0; // -, Nastaveni vystupniho PF
            OutPFSet_WinTms = Word_To_Real(BAT.REFUv2.Arr123[0,12]); // s, Casove okno pro zmenu PF
            OutPFSet_RvrtTms = Word_To_Real(BAT.REFUv2.Arr123[0,13]); // s, Timeout pro PF
            OutPFSet_RmpTms = Word_To_Real(BAT.REFUv2.Arr123[0,14]); // s, Cas rampy PF
            OutPFSet_Ena = BAT.REFUv2.Arr123[0,15]; // -, Povoleni rizeni vystupniho PF
            VArWMaxPct = Int_To_Real(BAT.REFUv2.Arr123[0,16]); // %, Jalovy vykon jako % z WMax
            VArMaxPct = Int_To_Real(BAT.REFUv2.Arr123[0,17]); // %, Jalovy vykon jako % z VAr capability
            VArAvalPct = Int_To_Real(BAT.REFUv2.Arr123[0,18]); // %, Jalovy vykon jako % z VA
            VArPct_WinTms = Word_To_Real(BAT.REFUv2.Arr123[0,19]); // s, Casove okno pro zmenu VAr limitu
            VArPct_RvrtTms = Word_To_Real(BAT.REFUv2.Arr123[0,20]); // s, Timeout VAr
            VArPct_RmpTms = Word_To_Real(BAT.REFUv2.Arr123[0,21]); // s, Cas rampy VAr
            VArPct_Mod = BAT.REFUv2.Arr123[0,22]; // -, Mod jaloveho vykonu: 0=WMax,1=VArMax,2=VA
            VArPct_Ena = BAT.REFUv2.Arr123[0,23]; // -, Povoleni rizeni jaloveho vykonu
            
            // Model 64800 (MESA Extension)
            // ===============================
            
            Model_ID_64800 = BAT.REFUv2.Arr64800[0,0]; // -, ID modelu (64800 = rozsirene rizeni invertoru)
            Model_Length_64800 = BAT.REFUv2.Arr64800[0,1]; // -, Delka modelu ve slovech
            LocRemCtl = BAT.REFUv2.Arr64800[0,2]; // -, Rezim rizeni: 0 = local, 1 = remote
            //PCSHb = BAT.REFUv2.Arr64800[0,3]; // -, Heartbeat invertoru
            ControllerHb = BAT.REFUv2.Arr64800[0,4]; // -, Heartbeat controlleru
            PCSAlarmReset = BAT.REFUv2.Arr64800[0,5]; // -, Reset alarmu
            PCSSetOperation = BAT.REFUv2.Arr64800[0,6]; // -, Prikaz k provozu invertoru (0-Off, 1-On, 2-Standby, 3-Sleep) 
            MaxBatACha = Word_To_Real(BAT.REFUv2.Arr64800[0,7]) * POW(10, Int_To_Real(BAT.REFUv2.Arr64800[0,11])); // A, Maximalni nabijejici proud baterie
            MaxBatADischa = Word_To_Real(BAT.REFUv2.Arr64800[0,8]) * POW(10, Int_To_Real(BAT.REFUv2.Arr64800[0,11])); // A, Maximalni vybijejici proud baterie
            MaxA = Word_To_Real(BAT.REFUv2.Arr64800[0,9]) * POW(10, Int_To_Real(BAT.REFUv2.Arr64800[0,12])); // A, Maximalni proud AC
            MaxACur = Word_To_Real(BAT.REFUv2.Arr64800[0,10]) * POW(10, Int_To_Real(BAT.REFUv2.Arr64800[0,13])); // A, Aktualni limit proudu AC
            
            // registry PRAMAC nad rámec SunS
            // ===============================
            
            // verze firmware ve4 číselných oddílech postupně z leva: Eg: 310-01-07-38
            FW1 = BAT.REFUv2.ArrFW[0,0];
            FW2 = BAT.REFUv2.ArrFW[0,1];
            FW3 = BAT.REFUv2.ArrFW[0,2];
            FW4 = BAT.REFUv2.ArrFW[0,3];
            

            
    
            // "pouze pro čtení" OMEZENÝ POČET ZÁPISŮ !! 
            BatteryVoltageLimit_Max = DWORD_To_Real(BAT.REFUv2.ArrRO[0,0]);  // V, napětí bat. max. pro vypnutní PCS
            BatteryVoltageLimit_Min = DWORD_To_Real(BAT.REFUv2.ArrRO[0,1]);  // V, napětí bat. min. pro vypnutní PCS
            ExternalHeartbeatTimeout = BAT.REFUv2.ArrRO[0,2]; //s, timeout externího heartbeatu pro nouzové vypnutní PCS
        endif;
        
    endif;


EndCase;


MR_BAT_STR[CurrentRowInt, 0] = AC_Power / 1000; // AktualniCinny, kW
// MR_BAT_STR[CurrentRowInt, 1] = 0; // AktualniCinnyL1
// MR_BAT_STR[CurrentRowInt, 2] = 0; // AktualniCinnyL2
// MR_BAT_STR[CurrentRowInt, 3] = 0; // AktualniCinnyL3
MR_BAT_STR[CurrentRowInt, 4] = AC_ReactivePower / 1000; // AktualniJalovy, Kvar
// MR_BAT_STR[CurrentRowInt, 5] = 0; // AktualniJalovyL1
// MR_BAT_STR[CurrentRowInt, 6] = 0; // AktualniJalovyL2
// MR_BAT_STR[CurrentRowInt, 7] = 0; // AktualniJalovyL3
MR_BAT_STR[CurrentRowInt, 8] = AC_ApparentPower / 1000; // AktualniZdanlivy, KVA
// MR_BAT_STR[CurrentRowInt, 9] = 0; // AktualniZdanlivyL1
// MR_BAT_STR[CurrentRowInt, 10] = 0; // AktualniZdanlivyL2
// MR_BAT_STR[CurrentRowInt, 11] = 0; // AktualniZdanlivyL3
MR_BAT_STR[CurrentRowInt, 12] = AC_Frequency; // Frekvence, Hz
MR_BAT_STR[CurrentRowInt, 13] = AC_Voltage_AN; // NapetiL1, V
MR_BAT_STR[CurrentRowInt, 14] = AC_Voltage_BN; // NapetiL2, V
MR_BAT_STR[CurrentRowInt, 15] = AC_Voltage_CN; // NapetiL3, V
MR_BAT_STR[CurrentRowInt, 16] = AC_Current_L1; // ProudL1, A
MR_BAT_STR[CurrentRowInt, 17] = AC_Current_L2; // ProudL2, A
MR_BAT_STR[CurrentRowInt, 18] = AC_Current_L3; // ProudL3, A
MR_BAT_STR[CurrentRowInt, 19] = AC_PowerFactor; // Ucinik, -
// MR_BAT_STR[CurrentRowInt, 20] = 0; // UcinikL1
// MR_BAT_STR[CurrentRowInt, 21] = 0; // UcinikL2
// MR_BAT_STR[CurrentRowInt, 22] = 0; // UcinikL3
MR_BAT_STR[CurrentRowInt, 23] = AC_Voltage_AB; // NapetiL1L2, V
MR_BAT_STR[CurrentRowInt, 24] = AC_Voltage_BC; // NapetiL2L3, V
MR_BAT_STR[CurrentRowInt, 25] = AC_Voltage_CA; // NapetiL3L1, V
MR_BAT_STR[CurrentRowInt, 26] = AC_Energy_Wh / 1000; // CelkemCinny
// MR_BAT_STR[CurrentRowInt, 27] = 0; // CelkemCinnyOdber
// MR_BAT_STR[CurrentRowInt, 28] = 0; // CelkemCinnyDodavka
// MR_BAT_STR[CurrentRowInt, 29] = 0; // CelkemJalovy
// MR_BAT_STR[CurrentRowInt, 30] = 0; // CelkemJalovyOdber
// MR_BAT_STR[CurrentRowInt, 31] = 0; // CelkemJalovyDodavka
MR_BAT_STR[CurrentRowInt, 32] = DC_Voltage; // Napeti_DC, V
MR_BAT_STR[CurrentRowInt, 33] = DC_Current; // Proud_DC, A
MR_BAT_STR[CurrentRowInt, 34] = DC_Power / 1000; // Vykon_DC, kW
MR_BAT_STR[CurrentRowInt, 35] = Temp_Heatsink; // Teplota_Heatsink, °C
MR_BAT_STR[CurrentRowInt, 36] = Temp_Cabinet; // Teplota_PCB, °C
MR_BAT_STR[CurrentRowInt, 37] = PCSHb; // Heartbeat_Read, -
// tady se zapisuje!  MR_BAT_STR[CurrentRowInt, 38] = ControllerHb; // Heartbeat_Write, -
MR_BAT_STR[CurrentRowInt, 39] = WRtg / 1000; // MaxPower, W
MR_BAT_STR[CurrentRowInt, 40] = OperatingState; // Status, stav: 1-Off, 3-Starting, 4-MPPT, 5-Throttled, 6-ShuttingDown, 7-Fault, 8-Standby, 9-Started
MR_BAT_STR[CurrentRowInt, 41] = Evt1; // Alarm, bitfield (alarmy + varovani)
MR_BAT_STR[CurrentRowInt, 42] = RemoteMaxPower; // ReportRizeniP, 0.1 %, rizeni aktivniho vykonu
MR_BAT_STR[CurrentRowInt, 43] = -1; // ReportRizeniQ
// MR_BAT_STR[CurrentRowInt, 44] = ; // Povolené/ režim řízení
//MR_BAT_STR[CurrentRowInt, 45] = ; // ŘízeníP
//MR_BAT_STR[CurrentRowInt, 46] = ; // ŘízeníQ

// umožní diagnostikovat konkrétní střídač
IF A_Diagnostika == CurrentRowInt then
    Evt1_DIAG = Evt1;
    
    if (DateTime.Second MOD 15 == 0) and not(MB_Readed[CurrentRowInt,0]) then
        MR_DIAG[0,0] = AC_ApparentPower; // Zdanlivý výkon, VA
        MR_DIAG[0,1] = AC_Current; // Celkový AC proud, A
        MR_DIAG[0,2] = AC_Current_L1; // Proud fáze L1, A
        MR_DIAG[0,3] = AC_Current_L2; // Proud fáze L2, A
        MR_DIAG[0,4] = AC_Current_L3; // Proud fáze L3, A
        MR_DIAG[0,5] = AC_Energy_Wh; // Celková vyrobená energie, Wh
        MR_DIAG[0,6] = AC_Frequency; // Síťová frekvence, Hz
        MR_DIAG[0,7] = AC_Power; // Aktuální činný výkon, W
        MR_DIAG[0,8] = AC_PowerFactor; // Účiník, -
        MR_DIAG[0,9] = AC_ReactivePower; // Jalový výkon, var
        MR_DIAG[0,10] = AC_Voltage_AB; // Napětí mezi fázemi AB, V
        MR_DIAG[0,11] = AC_Voltage_AN; // Napětí fáze A vůči N, V
        MR_DIAG[0,12] = AC_Voltage_BC; // Napětí mezi fázemi BC, V
        MR_DIAG[0,13] = AC_Voltage_BN; // Napětí fáze B vůči N, V
        MR_DIAG[0,14] = AC_Voltage_CA; // Napětí mezi fázemi CA, V
        MR_DIAG[0,15] = AC_Voltage_CN; // Napětí fáze C vůči N, V
        MR_DIAG[0,16] = ARtg; // Jmenovitý proud střídače, A
        MR_DIAG[0,17] = AhrRtg; // Kapacita baterie, Ah
        MR_DIAG[0,18] = ClcTotVA; // Počítaný zdánlivý výkon, VA
        MR_DIAG[0,19] = Conn; // Řízení připojení, 0=Disconnect, 1=Connect
        MR_DIAG[0,20] = ConnPh; // Počet připojených fází, -
        MR_DIAG[0,21] = Conn_RvrtTms; // Timeout revert připojení, s
        MR_DIAG[0,22] = Conn_WinTms; // Časové okno pro připojení/odpojení, s
        MR_DIAG[0,23] = ControllerHb; // Heartbeat controlleru, -
        MR_DIAG[0,24] = DC_Current; // DC proud, A
        MR_DIAG[0,25] = DC_Power; // DC výkon, W
        MR_DIAG[0,26] = DC_Voltage; // DC napětí, V
        MR_DIAG[0,27] = ECPNomHz; // Jmenovitá frekvence sítě, Hz
        MR_DIAG[0,28] = Evt1; // Bitové pole událostí, -
        MR_DIAG[0,29] = LocRemCtl; // Režim řízení: 0=local, 1=remote
        MR_DIAG[0,30] = MaxA; // Maximální AC proud, A
        MR_DIAG[0,31] = MaxACur; // Aktuální limit AC proudu, A
        MR_DIAG[0,32] = MaxBatACha; // Maximální nabíjecí proud baterie, A
        MR_DIAG[0,33] = MaxBatADischa; // Maximální vybíjecí proud baterie, A
        MR_DIAG[0,34] = MaxChaRte; // Maximální rychlost nabíjení, W
        MR_DIAG[0,35] = MaxDisChaRte; // Maximální rychlost vybíjení, W
        MR_DIAG[0,36] = MaxRmpRte; // Maximální rampa aktivního výkonu, %/s
        MR_DIAG[0,37] = Model_ID; // ID modelu (např. 103), -
        MR_DIAG[0,38] = Model_ID_120; // ID modelu (120), -
        MR_DIAG[0,39] = Model_ID_121; // ID modelu (121), -
        MR_DIAG[0,40] = Model_ID_123; // ID modelu (123), -
        MR_DIAG[0,41] = Model_ID_64800; // ID modelu (64800), -
        MR_DIAG[0,42] = Model_Length; // Délka modelu, -
        MR_DIAG[0,43] = Model_Length_120; // Délka modelu 120, -
        MR_DIAG[0,44] = Model_Length_121; // Délka modelu 121, -
        MR_DIAG[0,45] = Model_Length_123; // Délka modelu 123, -
        MR_DIAG[0,46] = Model_Length_64800; // Délka modelu 64800, -
        MR_DIAG[0,47] = OutPFSet; // Nastavení výstupního PF, -
        MR_DIAG[0,48] = OutPFSet_Ena; // Povolení řízení výstupního PF, -
        MR_DIAG[0,49] = OutPFSet_RmpTms; // Čas rampy PF, s
        MR_DIAG[0,50] = OutPFSet_RvrtTms; // Timeout PF, s
        MR_DIAG[0,51] = OutPFSet_WinTms; // Časové okno pro změnu PF, s
        MR_DIAG[0,52] = PCSAlarmReset; // Reset alarmu invertoru, -
        MR_DIAG[0,53] = PCSHb; // Heartbeat invertoru, -
        MR_DIAG[0,54] = PCSSetOperation; // Řízení provozu invertoru (0–3), -
        MR_DIAG[0,55] = PFMinQ1; // Minimální PF Q1, -
        MR_DIAG[0,56] = PFMinQ2; // Minimální PF Q2, -
        MR_DIAG[0,57] = PFMinQ3; // Minimální PF Q3, -
        MR_DIAG[0,58] = PFMinQ4; // Minimální PF Q4, -
        MR_DIAG[0,59] = PFRtgQ1; // Minimální účiník v kvadrantu 1, -
        MR_DIAG[0,60] = PFRtgQ2; // Minimální účiník v kvadrantu 2, -
        MR_DIAG[0,61] = PFRtgQ3; // Minimální účiník v kvadrantu 3, -
        MR_DIAG[0,62] = PFRtgQ4; // Minimální účiník v kvadrantu 4, -
        MR_DIAG[0,63] = Pad_64800; // Padding registr (rezerva), -
        MR_DIAG[0,64] = Temp_Cabinet; // Teplota rozvaděče, °C
        MR_DIAG[0,65] = Temp_Heatsink; // Teplota chladiče, °C
        MR_DIAG[0,66] = VAMax; // Maximální zdánlivý výkon, VA
        MR_DIAG[0,67] = VARtg; // Jmenovitý jalový výkon, var
        MR_DIAG[0,68] = VArAct; // Jalový režim (0–4), -
        MR_DIAG[0,69] = VArAvalPct; // Jalový výkon jako % z VA, %
        MR_DIAG[0,70] = VArMaxPct; // Jalový výkon jako % z VAr capability, %
        MR_DIAG[0,71] = VArMaxQ1; // Max jalový výkon Q1, var
        MR_DIAG[0,72] = VArMaxQ2; // Max jalový výkon Q2, var
        MR_DIAG[0,73] = VArMaxQ3; // Max jalový výkon Q3, var
        MR_DIAG[0,74] = VArMaxQ4; // Max jalový výkon Q4, var
        MR_DIAG[0,75] = VArPct_Ena; // Povolení řízení jalového výkonu, -
        MR_DIAG[0,76] = VArPct_Mod; // Mod jalového výkonu (0–2), -
        MR_DIAG[0,77] = VArPct_RmpTms; // Čas rampy VAr, s
        MR_DIAG[0,78] = VArPct_RvrtTms; // Timeout VAr, s
        MR_DIAG[0,79] = VArPct_WinTms; // Časové okno pro změnu VAr, s
        MR_DIAG[0,80] = VArRtgQ1; // Jalový výkon Q1 (capability), var
        MR_DIAG[0,81] = VArRtgQ2; // Jalový výkon Q2 (capability), var
        MR_DIAG[0,82] = VArRtgQ3; // Jalový výkon Q3 (capability), var
        MR_DIAG[0,83] = VArRtgQ4; // Jalový výkon Q4 (capability), var
        MR_DIAG[0,84] = VArWMaxPct; // Jalový výkon jako % z WMax, %
        MR_DIAG[0,85] = VMax; // Maximální napětí, V
        MR_DIAG[0,86] = VMin; // Minimální napětí, V
        MR_DIAG[0,87] = VRef; // Referenční napětí, V
        MR_DIAG[0,88] = VRefOfs; // Ofset referenčního napětí, V
        MR_DIAG[0,89] = WGra; // Rychlost náběhu výkonu, W/s
        MR_DIAG[0,90] = WHRtg; // Kapacita baterie, Wh
        MR_DIAG[0,91] = WMax; // Maximální výkon úložiště, W
        MR_DIAG[0,92] = WMaxLimPct; // Limit výkonu v % WRtg, %
        MR_DIAG[0,93] = WMaxLimPct_RmpTms; // Čas rampy limitu výkonu, s
        MR_DIAG[0,94] = WMaxLimPct_RvrtTms; // Timeout limitu výkonu, s
        MR_DIAG[0,95] = WMaxLimPct_WinTms; // Časové okno limitu výkonu, s
        MR_DIAG[0,96] = WMaxLim_Ena; // Povolení limitu výkonu, -
        MR_DIAG[0,97] = WRtg; // Jmenovitý činný výkon střídače, W
        MR_DIAG[0,98] = FW1; // Verze firmware část 1, -
        MR_DIAG[0,99] = FW2; // Verze firmware část 2, -
        MR_DIAG[0,100] = FW3; // Verze firmware část 3, -
        MR_DIAG[0,101] = FW4; // Verze firmware část 4, -
        MR_DIAG[0,102] = RemoteMaxPower; // Omezení AC výkonu, 0.1 %
        MR_DIAG[0,103] = BatteryVoltageLimit_Max; // Napětí baterie max, V
        MR_DIAG[0,104] = BatteryVoltageLimit_Min; // Napětí baterie min, V
        MR_DIAG[0,105] = ExternalHeartbeatTimeout; // Timeout externího heartbeatu, s
        MR_DIAG[0,106] = OperatingState; // Stav invertoru (1–9), -
        MR_DIAG[0,107] = Temp_Transf; // Teplota tranformatoru
        MR_DIAG[0,108] = Temp_Other; // Teplota jiná
    endif;
endif;

// potvrzení přečtení v dané sekundě
    MB_Readed[CurrentRowInt,0] = true;]]><Regions /></Body>
          <Object Name="Model_ID" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>SunSpec model ID (103 = Inverter Three Phase)</Comment>
            <Id>87</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_Length" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Delka modelu v registrech</Comment>
            <Id>88</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Current" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Celkovy AC proud (soucet fazi)</Comment>
            <Id>89</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Current_L1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Proud faze L1</Comment>
            <Id>90</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Current_L2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Proud faze L2</Comment>
            <Id>91</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Current_L3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Proud faze L3</Comment>
            <Id>92</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Voltage_AB" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Napeti mezi fazemi AB</Comment>
            <Id>93</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Voltage_BC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Napeti mezi fazemi BC</Comment>
            <Id>94</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Voltage_CA" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Napeti mezi fazemi CA</Comment>
            <Id>95</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Voltage_AN" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Napeti faze A vuci N</Comment>
            <Id>96</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Voltage_BN" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Napeti faze B vuci N</Comment>
            <Id>97</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Voltage_CN" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Napeti faze C vuci N</Comment>
            <Id>98</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Power" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Aktualni cinny vykon</Comment>
            <Id>99</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Frequency" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Sitova frekvence</Comment>
            <Id>100</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_ApparentPower" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Zdanlivy vykon</Comment>
            <Id>101</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_ReactivePower" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon</Comment>
            <Id>102</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_PowerFactor" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Ucinik (Power Factor)</Comment>
            <Id>103</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AC_Energy_Wh" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Celkova vyrobena energie</Comment>
            <Id>104</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="DC_Current" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>DC proud</Comment>
            <Id>105</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="DC_Voltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>DC napeti</Comment>
            <Id>106</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="DC_Power" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>DC vykon</Comment>
            <Id>107</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Temp_Cabinet" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Teplota rozvadece</Comment>
            <Id>108</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Temp_Heatsink" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Teplota chladice</Comment>
            <Id>109</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="OperatingState" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>1-Off, 3-Starting, 4-MPPT, 5-Throttled, 6-ShuttingDown, 7-Fault, 8-Standby, 9-Started</Comment>
            <Id>110</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SunSpec_ID" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>SunSpec identifikator (vzd. 0x53756E53 = 'SunS')</Comment>
            <Id>111</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Manufacturer_StringStart" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Vyrobce (16 wordu, Arr1[0,2] az Arr1[0,17])</Comment>
            <Id>112</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_StringStart" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Model zarizeni (16 wordu)</Comment>
            <Id>113</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Options_StringStart" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Moznosti zarizeni (8 wordu)</Comment>
            <Id>114</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Version_StringStart" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Verze firmware (8 wordu)</Comment>
            <Id>115</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SerialNumber_StringStart" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Seriove cislo (16 wordu)</Comment>
            <Id>116</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="DeviceAddress" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Modbus adresa zarizeni</Comment>
            <Id>117</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Evt1_DIAG" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>118</Id>
            <Authority>3</Authority>
            <Typ>2</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Temp_Transf" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Teplota Transformátoru</Comment>
            <Id>119</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Temp_Other" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Teplota ostatní</Comment>
            <Id>120</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_ID_120" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>ID modelu (120 = jmenovite parametry stridace)</Comment>
            <Id>121</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_Length_120" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Delka modelu ve slovech</Comment>
            <Id>122</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WRtg" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jmenovity cinny vykon stridace</Comment>
            <Id>123</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VARtg" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jmenovity zdanlivy vykon stridace</Comment>
            <Id>124</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArRtgQ1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon ve kvadrantu 1 (capability)</Comment>
            <Id>125</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArRtgQ2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon ve kvadrantu 2 (capability)</Comment>
            <Id>126</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArRtgQ3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon ve kvadrantu 3 (capability)</Comment>
            <Id>127</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArRtgQ4" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon ve kvadrantu 4 (capability)</Comment>
            <Id>128</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ARtg" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jmenovity RMS proud stridace (capability)</Comment>
            <Id>129</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFRtgQ1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni ucinik v kvadrantu 1 (capability)</Comment>
            <Id>130</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFRtgQ2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni ucinik v kvadrantu 2 (capability)</Comment>
            <Id>131</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFRtgQ3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni ucinik v kvadrantu 3 (capability)</Comment>
            <Id>132</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFRtgQ4" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni ucinik v kvadrantu 4 (capability)</Comment>
            <Id>133</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WHRtg" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jmenovita kapacita baterie (capability)</Comment>
            <Id>134</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AhrRtg" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Kapacita v amperhodinach (capability)</Comment>
            <Id>135</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxChaRte" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni rychlost nabijeni (capability)</Comment>
            <Id>136</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxDisChaRte" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni rychlost vybijeni (capability)</Comment>
            <Id>137</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_ID_121" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>ID modelu (121 = nastaveni uloziste â€“ zakladni parametry)</Comment>
            <Id>138</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_Length_121" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Delka modelu ve slovech</Comment>
            <Id>139</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WMax" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni celkovy vykon uloziste</Comment>
            <Id>140</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VRef" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Referencni napeti</Comment>
            <Id>141</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VRefOfs" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Ofset referencniho napeti</Comment>
            <Id>142</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VMax" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni napeti</Comment>
            <Id>143</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VMin" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni napeti</Comment>
            <Id>144</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VAMax" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni zdanlivy vykon</Comment>
            <Id>145</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArMaxQ1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni jalovy vykon Q1 (capability)</Comment>
            <Id>146</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArMaxQ2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni jalovy vykon Q2 (capability)</Comment>
            <Id>147</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArMaxQ3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni jalovy vykon Q3 (capability)</Comment>
            <Id>148</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArMaxQ4" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni jalovy vykon Q4 (capability)</Comment>
            <Id>149</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WGra" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Rychlost nabehu vykonu</Comment>
            <Id>150</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFMinQ1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni power factor Q1</Comment>
            <Id>151</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArAvalPct" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon jako % z VA</Comment>
            <Id>152</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArMaxPct" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon jako % z VAr max</Comment>
            <Id>153</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFMinQ2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni power factor Q2</Comment>
            <Id>154</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFMinQ3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni power factor Q3</Comment>
            <Id>155</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PFMinQ4" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Minimalni power factor Q4</Comment>
            <Id>156</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArAct" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Rezim jaloveho vykonu</Comment>
            <Id>157</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ClcTotVA" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Volba vypoctu zdanliveho vykonu</Comment>
            <Id>158</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxRmpRte" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni rampa aktivniho vykonu</Comment>
            <Id>159</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ECPNomHz" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jmenovita frekvence pro grid</Comment>
            <Id>160</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ConnPh" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Pocet pripojenych fazi</Comment>
            <Id>161</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_ID_123" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>ID modelu (123 = Immediate Inverter Controls)</Comment>
            <Id>162</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_Length_123" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Delka modelu ve slovech</Comment>
            <Id>163</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Conn_WinTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Casove okno pro pripojeni/odpojeni (s)</Comment>
            <Id>164</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Conn_RvrtTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Timeout revert pripojeni (s)</Comment>
            <Id>165</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Conn" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Rizeni pripojeni (0=Disconnect, 1=Connect)</Comment>
            <Id>166</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WMaxLim_Ena" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Povoleni limitu vykonu</Comment>
            <Id>167</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArWMaxPct" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Jalovy vykon jako % z WMax</Comment>
            <Id>168</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WMaxLimPct_WinTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Casove okno zmeny limitu WMax (s)</Comment>
            <Id>169</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WMaxLimPct_RvrtTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Timeout limitu WMax (s)</Comment>
            <Id>170</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="A_Diagnostika" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>slouží pro diagnostiku jednotlivých STR</Comment>
            <Id>171</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>-1</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WMaxLimPct_RmpTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Cas rampy pro limit WMax (s)</Comment>
            <Id>172</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="OutPFSet" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Nastaveni vystupniho power factoru</Comment>
            <Id>173</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="OutPFSet_WinTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Casove okno pro zmenu PF (s)</Comment>
            <Id>174</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="OutPFSet_RvrtTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Timeout pro PF (s)</Comment>
            <Id>175</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="OutPFSet_RmpTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Cas rampy PF (s)</Comment>
            <Id>176</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="OutPFSet_Ena" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Povoleni rizeni PF</Comment>
            <Id>177</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArPct_WinTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Casove okno VAr (s)</Comment>
            <Id>178</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="WMaxLimPct" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Limit vykonu v % WRtg</Comment>
            <Id>179</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArPct_RvrtTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Timeout VAr (s)</Comment>
            <Id>180</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArPct_RmpTms" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Cas rampy VAr (s)</Comment>
            <Id>181</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArPct_Mod" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Mod jaloveho vykonu (0=WMax,1=VArMax,2=VA)</Comment>
            <Id>182</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VArPct_Ena" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Povoleni rizeni jaloveho vykonu</Comment>
            <Id>183</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_ID_64800" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>ID modelu (64800 = rozsirene rizeni invertoru)</Comment>
            <Id>184</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Model_Length_64800" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Delka modelu ve slovech</Comment>
            <Id>185</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="LocRemCtl" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Rezim rizeni: 0=local, 1=remote</Comment>
            <Id>186</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PCSSetOperation" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Prikaz k provozu invertoru (0-Off, 1-On, 2-Standby, 3-Sleep)</Comment>
            <Id>187</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PCSAlarmReset" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Reset alarmu invertoru</Comment>
            <Id>188</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxBatACha" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni nabijejici proud baterie (A)</Comment>
            <Id>189</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxBatADischa" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni vybijejici proud baterie (A)</Comment>
            <Id>190</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxA" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Maximalni AC proud (A)</Comment>
            <Id>191</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxACur" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Aktualni limit AC proudu (A)</Comment>
            <Id>192</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PCSHb" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Heartbeat invertoru</Comment>
            <Id>193</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ControllerHb" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Heartbeat controlleru</Comment>
            <Id>194</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Pad_64800" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Padding registr</Comment>
            <Id>195</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="RemoteMaxPower" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>196</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BatteryVoltageLimit_Max" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>197</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BatteryVoltageLimit_Min" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>198</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ExternalHeartbeatTimeout" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>199</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="FW1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>200</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="FW2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>201</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="FW3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>202</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="FW4" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>203</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Interní proměnná pro převzetí Aktuálního řádku</Comment>
            <Id>204</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="@Ground_fault" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Id>205</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.0</VariableLink>
          </Object>
          <Object Name="@dc_over_voltage" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>DC over voltage</Comment>
            <Id>206</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.1</VariableLink>
          </Object>
          <Object Name="@ac_disconnect_open" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>AC disconnect open</Comment>
            <Id>207</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.2</VariableLink>
          </Object>
          <Object Name="@dc_disconnect_open" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>DC disconnect open</Comment>
            <Id>208</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.3</VariableLink>
          </Object>
          <Object Name="@grid_shutdown" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Grid shutdown</Comment>
            <Id>209</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.4</VariableLink>
          </Object>
          <Object Name="@cabinet_open" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Cabinet open</Comment>
            <Id>210</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.5</VariableLink>
          </Object>
          <Object Name="@manual_shutdown" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Manual shutdown</Comment>
            <Id>211</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.6</VariableLink>
          </Object>
          <Object Name="@over_temperature" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Over temperature</Comment>
            <Id>212</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.7</VariableLink>
          </Object>
          <Object Name="@over_frequency" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Over frequency</Comment>
            <Id>213</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.8</VariableLink>
          </Object>
          <Object Name="@under_frequency" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Under frequency</Comment>
            <Id>214</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.9</VariableLink>
          </Object>
          <Object Name="@ac_over_voltage" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>AC over voltage</Comment>
            <Id>215</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.10</VariableLink>
          </Object>
          <Object Name="@ac_under_voltage" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>AC under voltage</Comment>
            <Id>216</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.11</VariableLink>
          </Object>
          <Object Name="@blown_string_fuse" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Blown string fuse</Comment>
            <Id>217</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.12</VariableLink>
          </Object>
          <Object Name="@under_temperature" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Under temperature</Comment>
            <Id>218</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.13</VariableLink>
          </Object>
          <Object Name="@memory_loss_or_comm_error" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Memory loss or comm error</Comment>
            <Id>219</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.14</VariableLink>
          </Object>
          <Object Name="@hw_test_failure" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>HW test failure</Comment>
            <Id>220</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.15</VariableLink>
          </Object>
          <Object Name="@other_alarm" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Other alarm</Comment>
            <Id>221</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.16</VariableLink>
          </Object>
          <Object Name="@other_warning" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Other warning</Comment>
            <Id>222</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>Evt1_DIAG.17</VariableLink>
          </Object>
          <Object Name="ValChange1" Class="Amit.Ngs.Core.DsGenericObject" Def="ValChange">
            <ParentObject>BAT_Refu_Read_v3</ParentObject>
            <Id>223</Id>
            <Authority>3</Authority>
            <Comment>
            </Comment>
            <Property BindId="0" Value="0" />
            <Property BindId="1" Value="0" />
            <Property BindId="2" Value="0" />
            <Property BindId="3" Value="0" />
          </Object>
          <Object Name="MB_Readed" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
            <Id>224</Id>
            <Authority>3</Authority>
            <Typ>20</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>False</CfcPin>
            <DimRow>1</DimRow>
            <DimCol>1</DimCol>
          </Object>
          <Object Name="MB_ZEROS" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
            <Id>225</Id>
            <Authority>3</Authority>
            <Typ>20</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <CfcPin>False</CfcPin>
            <DimRow>1</DimRow>
            <DimCol>1</DimCol>
          </Object>
          <Object Name="Evt1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>226</Id>
            <Authority>3</Authority>
            <Typ>2</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
        </Object>
        <Object Name="BAT_Refu_Write_v2" Class="Amit.Ngs.Core.NgsSubroutine" Def="Subroutine">
          <Rename>True</Rename>
          <ParentObject>Global</ParentObject>
          <Id>227</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[CurrentRowInt = BAT_STR_write_CurrentRowInt;

TMP_PCSSetOperation = 0;
TMP_enablePowerControl = 0;
TMP_setMaxPower = 0;
TMP_SetPowerPct = 0;
MR_BAT_STR[CurrentRowInt, 38] = 0;

Case CurrentRowInt Of
  0:
    case Real_To_Int(MR_BAT_STR[CurrentRowInt, 44]) of
        0: // to standby - grid disconnected ( idle )
            if (MR_BAT_STR[CurrentRowInt, 40] == 3) or (MR_BAT_STR[CurrentRowInt, 40] == 9) or (MR_BAT_STR[CurrentRowInt, 40] == 4) or (MR_BAT_STR[CurrentRowInt, 40] == 5) then
                TMP_PCSSetOperation = 3;
            endif;
        1: // to throttled - grid connected + IGBTs working (ready and generating)
            if (MR_BAT_STR[CurrentRowInt, 40] == 8) or (MR_BAT_STR[CurrentRowInt, 40] == 9) then
                TMP_PCSSetOperation = 1;
            endif;
        2: // to start - grid connected + IGBTs off ( powersaving)
            // pokud je ve standby
            if MR_BAT_STR[CurrentRowInt, 40] == 8 then
                TMP_PCSSetOperation = 4;
            endif;
            // pokud je v throttled nebo mppt
            if (MR_BAT_STR[CurrentRowInt, 40] == 4) or (MR_BAT_STR[CurrentRowInt, 40] == 5) then
                TMP_PCSSetOperation = 2;
            endif;
    endcase;
    
    
    // pokud je povolené řízení výkonu
    if MR_BAT_STR[CurrentRowInt, 44] == 1 then 
        TMP_enablePowerControl = 1;
        TMP_setMaxPower = Real_To_Int(ABS(MR_BAT_STR[CurrentRowInt, 45]) * 100.0) ;
        TMP_SetPowerPct = Real_To_Int(MR_BAT_STR[CurrentRowInt, 45]/ABS(MR_BAT_STR[CurrentRowInt, 45])*1000); // -100% nebo 100%
	else
        TMP_enablePowerControl = 0;
        TMP_setMaxPower = 0;
        TMP_SetPowerPct = 0;
    endif;
    
    
    // ****** Oddíl pro reálný zápis do modbus ********
    
    if BAT.REFUv2.PCSSetOperation != TMP_PCSSetOperation then
        BAT.REFUv2.PCSSetOperation = TMP_PCSSetOperation;
    endif;
    
    if  BAT.REFUv2.enablePowerControl != TMP_enablePowerControl then
        BAT.REFUv2.enablePowerControl = TMP_enablePowerControl;
    endif;
    
    if BAT.REFUv2.PowerPctTimeoutPeriod != ActivePowerTimeDuration then
        BAT.REFUv2.PowerPctTimeoutPeriod = ActivePowerTimeDuration;
    endif;
    
    BAT.REFUv2.setMaxPower = TMP_setMaxPower;
    BAT.REFUv2.SetPowerPct = TMP_SetPowerPct;
    // heartbeat
    BAT.REFUv2.HeartBeatWrite = Real_To_Word(MR_BAT_STR[CurrentRowInt, 37]); // zápis heartbeat do střídače
     // zpětná kontrola probíhajícího zápisu
    
    
EndCase;
]]><Regions /></Body>
          <Object Name="ActivePowerTimeDuration" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>228</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>10</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>229</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_PCSSetOperation" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>230</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_enablePowerControl" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>231</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_setMaxPower" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>232</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_SetPowerPct" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>233</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
        </Object>
        <Object Name="BMS_PylonTech" Class="Amit.Ngs.Core.NgsSubroutine" Def="Subroutine">
          <ParentObject>Global</ParentObject>
          <Id>234</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[BasicStatus= -1000;
ProtectionInfo= 0;
AlarmInfo = 0;
Napeti = 0;
Proud = 0;
Teplota = 0;
SOC = 0;
SOE = 0;
MaxVoltage = 0;
MaxChargeCurrent = 0;
MinVoltage = 0;
MaxDisCurrent = 0;
MaxCellVoltage = 0;
MinCellVoltage = 0;
SnOfMaxCellVoltage = 0;
SnOfMinCellVoltage = 0;
MaxCellTemp = 0;
MinCellTemp = 0;
SnOfMaxCellTemp = 0;
SnOfMinCellTemp = 0;
MaxModuleVoltage = 0;
MinModuleVoltage = 0;
SnOfMaxModuleVoltage = 0;
SnOfMinModuleVoltage = 0;
MaxModuleTemp = 0;
MinModuleTemp = 0;
SnOfMaxModuleTemp = 0;
SnOfMinModuleTemp = 0;
SOH = 0;
RemainCap = 0;
TotalChargeCap = 0;
TotalDischargeCap = 0;
NumberOfCells = 0;
NumberOfModules = 0;
ForceChargeRequest = 0;
BalanceChargeRequest = 0;
ModulNominalVoltage = 0;
ModulNominalCap = 0;
TerminalMaxTemp = 0;
TerminalMinTemp = 0;
ModulePCBmaxTemp = 0;
ModulePCBminTemp = 0;
AlarmStatus2 = 0;
ErrorCode1 = 0;

BasicStatus_Diag = 0;
ProtectionInfo_Diag = 0;
AlarmInfo_Diag = 0;
AlarmStatus2_Diag = 0;
ErrorCode1_Diag = 0;
    
    
ValChange1(Val= DateTime.Second ,Mode=0  ,Init=0);
CurrentRowInt = BAT_BMS_CurrentRowInt; // převzetí aktuálního řádku do lokální proměnné

    
Case CurrentRowInt Of 
  0:
    if PylonT.TCPStatus == 4 then
        
        IF (DateTime.Second MOD 5 == 0) and ValChange1.Out then
            PylonT.BMS.ArrPile1.Refresh();
        endif;
    
        // Zápis - řízení spánku
        
        //PylonT.MBMSold.SleepControl = MR_BAT[BAT_CurrentRowInt, 53] == 1 ? 85 : 170; // wake up Pylon při řízení
        
        // Čtení
        BasicStatus = PylonT.BMS.ArrPile1[0,0];
        ProtectionInfo = PylonT.BMS.ArrPile1[0,1];
        AlarmInfo = PylonT.BMS.ArrPile1[0,2];
        Napeti = PylonT.BMS.ArrPile1[0,3];
        Proud = Dint_To_Real(Join_Words_To_DWORD(PylonT.BMS.ArrPile1[0,5], PylonT.BMS.ArrPile1[0,4]));
        Teplota = PylonT.BMS.ArrPile1[0,6];
        SOC = PylonT.BMS.ArrPile1[0,7];
        SOE = PylonT.BMS.ArrPile1[0,72];
        MaxVoltage = PylonT.BMS.ArrPile1[0,9];
        MaxChargeCurrent = Dword_To_Dint(Join_Words_To_DWORD(PylonT.BMS.ArrPile1[0,11], PylonT.BMS.ArrPile1[0,10]));
        MinVoltage = PylonT.BMS.ArrPile1[0,12];
        MaxDisCurrent = Dword_To_Dint(Join_Words_To_DWORD(PylonT.BMS.ArrPile1[0,14], PylonT.BMS.ArrPile1[0,13]));
        MaxCellVoltage = PylonT.BMS.ArrPile1[0,16];
        MinCellVoltage = PylonT.BMS.ArrPile1[0,17];
        SnOfMaxCellVoltage = PylonT.BMS.ArrPile1[0,18];
        SnOfMinCellVoltage = PylonT.BMS.ArrPile1[0,19];
        MaxCellTemp = PylonT.BMS.ArrPile1[0,20];
        MinCellTemp = PylonT.BMS.ArrPile1[0,21];
        SnOfMaxCellTemp = PylonT.BMS.ArrPile1[0,22];
        SnOfMinCellTemp = PylonT.BMS.ArrPile1[0,23];
        MaxModuleVoltage = PylonT.BMS.ArrPile1[0,24];
        MinModuleVoltage = PylonT.BMS.ArrPile1[0,25];
        SnOfMaxModuleVoltage = PylonT.BMS.ArrPile1[0,26];
        SnOfMinModuleVoltage = PylonT.BMS.ArrPile1[0,27];
        MaxModuleTemp = PylonT.BMS.ArrPile1[0,28];
        MinModuleTemp = PylonT.BMS.ArrPile1[0,29];
        SnOfMaxModuleTemp = PylonT.BMS.ArrPile1[0,30];
        SnOfMinModuleTemp = PylonT.BMS.ArrPile1[0,31];
        SOH = PylonT.BMS.ArrPile1[0,32];
        RemainCap = Dword_To_Dint(Join_Words_To_DWORD(PylonT.BMS.ArrPile1[0,34], PylonT.BMS.ArrPile1[0,33]));
        TotalChargeCap = Dword_To_Dint(Join_Words_To_DWORD(PylonT.BMS.ArrPile1[0,44], PylonT.BMS.ArrPile1[0,43]));
        TotalDischargeCap = Dword_To_Dint(Join_Words_To_DWORD(PylonT.BMS.ArrPile1[0,46], PylonT.BMS.ArrPile1[0,45]));
        NumberOfCells = PylonT.BMS.ArrPile1[0,55];
        NumberOfModules = PylonT.BMS.ArrPile1[0,54];
        ForceChargeRequest = PylonT.BMS.ArrPile1[0,47];
        BalanceChargeRequest = PylonT.BMS.ArrPile1[0,48];
        ModulNominalVoltage = PylonT.BMS.ArrPile1[0,58];
        ModulNominalCap = PylonT.BMS.ArrPile1[0,59];
        TerminalMaxTemp = PylonT.BMS.ArrPile1[0,64];
        TerminalMinTemp = PylonT.BMS.ArrPile1[0,65];
        ModulePCBmaxTemp = PylonT.BMS.ArrPile1[0,68];
        ModulePCBminTemp = PylonT.BMS.ArrPile1[0,69];
        AlarmStatus2 = PylonT.BMS.ArrPile1[0,73];
        ErrorCode1 = Join_Words_To_DWORD(PylonT.BMS.ArrPile1[0,51], PylonT.BMS.ArrPile1[0,50]);
    endif;
EndCase;


// přepočty jednotek
Napeti = Napeti / 10;
Proud = Proud / 100;
Teplota = Teplota / 10;
MaxVoltage = MaxVoltage / 10;
MaxChargeCurrent = MaxChargeCurrent / 100;
MinVoltage = MinVoltage / 10;
MaxDisCurrent = ABS(MaxDisCurrent) / 100;
MaxCellVoltage = MaxCellVoltage / 1000;
MinCellVoltage = MinCellVoltage / 1000;
MaxCellTemp = MaxCellTemp / 10;
MinCellTemp = MinCellTemp / 10;
MaxModuleVoltage = MaxModuleVoltage / 100;
MinModuleVoltage = MinModuleVoltage / 100;

if A_BMS_Korekce then
    // nástavbový FB pro kontrolu BMS parametrů
    fb_BMS_Control(
        MaxChargeI= MaxChargeCurrent ,
        MaxDischargeI= MaxDisCurrent ,
        BatU=Napeti  ,
        BatI=Proud  ,
        MinModuleU= MinModuleVoltage ,
        MaxModuleU= MaxModuleVoltage  ,
        MinCellT = MinCellTemp,
        MaxCellT = MaxCellTemp,
        MinCellU= MinCellVoltage ,
        MaxCellU= MaxCellVoltage ,
        MinBMS_U= MinVoltage  ,
        MaxBMS_U= MaxVoltage  ,
        IN_BalanceReq= BalanceChargeRequest ,
        IN_ChargeReq= ForceChargeRequest ,	
        );
        ForceChargeRequest = fb_BMS_Control.ChargeReq; // 
        BalanceChargeRequest =fb_BMS_Control.BalanceReq;//
        MaxChargeCurrent = fb_BMS_Control.MaxChargeP; //
        MaxDisCurrent =  fb_BMS_Control.MaxDischargeP; //
else
    MaxDisCurrent = (MaxDisCurrent * Napeti) /1000;
    MaxChargeCurrent = (MaxChargeCurrent * Napeti) /1000;
endif;

MR_BAT_BMS[BAT_BMS_CurrentRowInt, 0]= BasicStatus;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 1]= ProtectionInfo;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 2]= AlarmInfo;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 3]= Napeti;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 4]= Proud;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 5]= Teplota;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 6]= SOC;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 7]= SOE;  // % of kWh
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 8]= SOH; // %
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 9]= ForceChargeRequest;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 10]=  BalanceChargeRequest;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 11]= MaxVoltage;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 12]=  MaxChargeCurrent;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 13]= MinVoltage;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 14]= MaxDisCurrent;

MR_BAT_BMS[BAT_BMS_CurrentRowInt, 15]= MaxCellVoltage;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 16]= MinCellVoltage;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 17]= SnOfMaxCellVoltage / 1000;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 18]= SnOfMinCellVoltage / 1000;

MR_BAT_BMS[BAT_BMS_CurrentRowInt, 19] = MaxCellTemp;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 20] = MinCellTemp;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 21] = SnOfMaxCellTemp / 10;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 22] = SnOfMinCellTemp / 10;

MR_BAT_BMS[BAT_BMS_CurrentRowInt, 23]= MaxModuleVoltage;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 24]= MinModuleVoltage;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 25]= SnOfMaxModuleVoltage / 100;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 26]= SnOfMinModuleVoltage / 100;

MR_BAT_BMS[BAT_BMS_CurrentRowInt, 27]= MaxModuleTemp / 10;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 28]= MinModuleTemp / 10;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 29]= SnOfMaxModuleTemp / 10;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 30]= SnOfMinModuleTemp / 10;


MR_BAT_BMS[BAT_BMS_CurrentRowInt, 31]= RemainCap / 1000; //kWh
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 32]= TotalChargeCap; //kWh
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 33]= TotalDischargeCap; //kWh
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 34]= NumberOfCells;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 35]= NumberOfModules;

MR_BAT_BMS[BAT_BMS_CurrentRowInt, 36]= ModulNominalVoltage / 10;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 37]= ModulNominalCap; // Ah
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 38]= TerminalMaxTemp;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 39]= TerminalMinTemp;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 40]= ModulePCBmaxTemp;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 41]= ModulePCBminTemp;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 42]= AlarmStatus2;
MR_BAT_BMS[BAT_BMS_CurrentRowInt, 43]= ErrorCode1;


// umožní diagnostikovat konkrétní BMS
IF A_Diagnostika == CurrentRowInt then
    BasicStatus_Diag = Real_To_Word(BasicStatus);
    ProtectionInfo_Diag = Real_To_Word(ProtectionInfo);
    AlarmInfo_Diag = Real_To_Word(AlarmInfo);
    AlarmStatus2_Diag = Real_To_Word(AlarmStatus2);
    ErrorCode1_Diag = Real_To_DWORD(ErrorCode1);
endif;]]><Regions /></Body>
          <Object Name="A_BMS_Korekce" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>235</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>True</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BasicStatus" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>236</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ProtectionInfo" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>237</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmInfo_DIAG" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>238</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>1</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmInfo" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>239</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmStatus2_DIAG" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>240</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>1</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Napeti" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>241</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Proud" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>242</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BasicStatus_DIAG" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>243</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>1</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Teplota" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>244</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SOC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>245</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ErrorCode1_DIAG" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>246</Id>
            <Authority>3</Authority>
            <Typ>15</Typ>
            <Kind>1</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SOE" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>247</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>248</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxChargeCurrent" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>249</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>250</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxDisCurrent" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>251</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxCellVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>252</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinCellVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>253</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMaxCellVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>254</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMinCellVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>255</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxCellTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>256</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinCellTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>257</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMaxCellTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>258</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMinCellTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>259</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxModuleVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>260</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinModuleVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>261</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMaxModuleVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>262</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMinModuleVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>263</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxModuleTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>264</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MinModuleTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>265</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMaxModuleTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>266</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SnOfMinModuleTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>267</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ProtectionInfo_DIAG" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>268</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>1</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SOH" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>269</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="RemainCap" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>270</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TotalChargeCap" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>271</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TotalDischargeCap" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>272</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="NumberOfCells" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>273</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="NumberOfModules" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>274</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ForceChargeRequest" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>275</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BalanceChargeRequest" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>276</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ModulNominalVoltage" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>277</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ModulNominalCap" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>278</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TerminalMaxTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>279</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TerminalMinTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>280</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ModulePCBmaxTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>281</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ModulePCBminTemp" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>282</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmStatus2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>283</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ValChange1" Class="Amit.Ngs.Core.DsGenericObject" Def="ValChange">
            <ParentObject>BMS_PylonTech</ParentObject>
            <Id>284</Id>
            <Authority>3</Authority>
            <Comment>
            </Comment>
            <Property BindId="0" Value="0" />
            <Property BindId="1" Value="0" />
            <Property BindId="2" Value="0" />
            <Property BindId="3" Value="0" />
          </Object>
          <Object Name="CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>Interní proměnná pro převzetí Aktuálního řádku</Comment>
            <Id>285</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="fb_BMS_Control" Class="Amit.Ngs.Core.NgsFbInstance" Def="fb_BMS_Control">
            <ParentObject>BMS_PylonTech</ParentObject>
            <Id>286</Id>
            <Authority>3</Authority>
            <Comment>
            </Comment>
            <Property BindId="0" Value="0" />
            <Property BindId="1" Value="0" />
            <Property BindId="2" Value="0" />
            <Property BindId="3" Value="0" />
            <Property BindId="4" Value="0" />
            <Property BindId="5" Value="0" />
            <Property BindId="6" Value="0" />
            <Property BindId="7" Value="0" />
            <Property BindId="8" Value="0" />
            <Property BindId="9" Value="0" />
            <Property BindId="10" Value="0" />
            <Property BindId="11" Value="0" />
            <Property BindId="12" Value="0" />
            <Property BindId="13" Value="0" />
            <Property BindId="14" Value="0" />
            <Property BindId="15" Value="0" />
            <Property BindId="16" Value="0" />
            <Property BindId="17" Value="0" />
            <Property BindId="18" Value="0" />
          </Object>
          <Object Name="ErrorCode1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>306</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="A_Diagnostika" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>slouží pro diagnostiku jednotlivých STR</Comment>
            <Id>307</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>-1</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="@fan_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ventilator porucha</Comment>
            <Id>308</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.14</VariableLink>
          </Object>
          <Object Name="@sleep" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Uloziste ve spanku</Comment>
            <Id>309</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.13</VariableLink>
          </Object>
          <Object Name="@discharging" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Probihajici vybijeni</Comment>
            <Id>310</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.12</VariableLink>
          </Object>
          <Object Name="@charging" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Probihajici nabijeni</Comment>
            <Id>311</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.11</VariableLink>
          </Object>
          <Object Name="@idle" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>System v klidu</Comment>
            <Id>312</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.10</VariableLink>
          </Object>
          <Object Name="@temp_alarm" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Teplotni alarm aktivni</Comment>
            <Id>313</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.9</VariableLink>
          </Object>
          <Object Name="@curr_alarm" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Proudovy alarm aktivni</Comment>
            <Id>314</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.8</VariableLink>
          </Object>
          <Object Name="@volt_alarm" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Napetovy alarm aktivni</Comment>
            <Id>315</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.7</VariableLink>
          </Object>
          <Object Name="@temp_prot" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Teplotni ochrana aktivni</Comment>
            <Id>316</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.6</VariableLink>
          </Object>
          <Object Name="@volt_prot" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Napetova ochrana aktivni</Comment>
            <Id>317</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.5</VariableLink>
          </Object>
          <Object Name="@curr_prot" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Proudova ochrana aktivni</Comment>
            <Id>318</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.4</VariableLink>
          </Object>
          <Object Name="@sys_error" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Systemova chyba</Comment>
            <Id>319</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>BasicStatus_DIAG.3</VariableLink>
          </Object>
          <Object Name="@cell_uv2" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - clanek pod napetim (uroven 2)</Comment>
            <Id>320</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.15</VariableLink>
          </Object>
          <Object Name="@mod_ov" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - modul prepeti</Comment>
            <Id>321</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.14</VariableLink>
          </Object>
          <Object Name="@mod_uv" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - modul pod napetim</Comment>
            <Id>322</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.13</VariableLink>
          </Object>
          <Object Name="@mod_temp_hi" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - vysoka teplota modulu</Comment>
            <Id>323</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.12</VariableLink>
          </Object>
          <Object Name="@short_circ" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - zkrat</Comment>
            <Id>324</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.10</VariableLink>
          </Object>
          <Object Name="@dis_oc" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - vybijeci pretizeni</Comment>
            <Id>325</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.9</VariableLink>
          </Object>
          <Object Name="@chg_oc" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - nabijeci pretizeni</Comment>
            <Id>326</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.8</VariableLink>
          </Object>
          <Object Name="@dis_temp_hi" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - vysoka teplota pri vybijeni</Comment>
            <Id>327</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.7</VariableLink>
          </Object>
          <Object Name="@dis_temp_lo" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - nizka teplota pri vybijeni</Comment>
            <Id>328</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.6</VariableLink>
          </Object>
          <Object Name="@chg_temp_hi" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - vysoka teplota pri nabijeni</Comment>
            <Id>329</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.5</VariableLink>
          </Object>
          <Object Name="@chg_temp_lo" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - nizka teplota pri nabijeni</Comment>
            <Id>330</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.4</VariableLink>
          </Object>
          <Object Name="@pack_ov" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - celkove prepeti</Comment>
            <Id>331</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.3</VariableLink>
          </Object>
          <Object Name="@pack_uv" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - celkove podpeti</Comment>
            <Id>332</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.2</VariableLink>
          </Object>
          <Object Name="@cell_ov" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - prepeti clanku</Comment>
            <Id>333</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.1</VariableLink>
          </Object>
          <Object Name="@cell_uv" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - podpeti clanku</Comment>
            <Id>334</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ProtectionInfo_DIAG.0</VariableLink>
          </Object>
          <Object Name="@term_temp" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - teplota na svorkach</Comment>
            <Id>335</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.15</VariableLink>
          </Object>
          <Object Name="@mod_ov_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - modul prepeti</Comment>
            <Id>336</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.14</VariableLink>
          </Object>
          <Object Name="@mod_uv_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - modul podpeti</Comment>
            <Id>337</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.13</VariableLink>
          </Object>
          <Object Name="@mod_temp_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - vysoka teplota modulu</Comment>
            <Id>338</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.12</VariableLink>
          </Object>
          <Object Name="@bms_temp_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - vysoka teplota BMS</Comment>
            <Id>339</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.11</VariableLink>
          </Object>
          <Object Name="@leak_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - unikejici proud</Comment>
            <Id>340</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.10</VariableLink>
          </Object>
          <Object Name="@dis_oc_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - vybijeci pretizeni</Comment>
            <Id>341</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.9</VariableLink>
          </Object>
          <Object Name="@chg_oc_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - nabijeci pretizeni</Comment>
            <Id>342</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.8</VariableLink>
          </Object>
          <Object Name="@dis_temp_hi_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - vysoka teplota pri vybijeni</Comment>
            <Id>343</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.7</VariableLink>
          </Object>
          <Object Name="@dis_temp_lo_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - nizka teplota pri vybijeni</Comment>
            <Id>344</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.6</VariableLink>
          </Object>
          <Object Name="@chg_temp_hi_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - vysoka teplota pri nabijeni</Comment>
            <Id>345</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.5</VariableLink>
          </Object>
          <Object Name="@chg_temp_lo_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - nizka teplota pri nabijeni</Comment>
            <Id>346</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.4</VariableLink>
          </Object>
          <Object Name="@pack_ov_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - celkove prepeti</Comment>
            <Id>347</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.3</VariableLink>
          </Object>
          <Object Name="@pack_uv_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - celkove podpeti</Comment>
            <Id>348</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.2</VariableLink>
          </Object>
          <Object Name="@cell_ov_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - prepeti clanku</Comment>
            <Id>349</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.1</VariableLink>
          </Object>
          <Object Name="@cell_uv_warn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - podpeti clanku</Comment>
            <Id>350</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmInfo_DIAG.0</VariableLink>
          </Object>
          <Object Name="@sys_abuse" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>System - nespravne pouziti</Comment>
            <Id>351</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus2_DIAG.4</VariableLink>
          </Object>
          <Object Name="@bms_disconnect" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>BMS odpojena</Comment>
            <Id>352</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus2_DIAG.3</VariableLink>
          </Object>
          <Object Name="@bms_commlost" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ztrata komunikace s BMS</Comment>
            <Id>353</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus2_DIAG.2</VariableLink>
          </Object>
          <Object Name="@temp_imbalance" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Nerovnomerna teplota clanku</Comment>
            <Id>354</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus2_DIAG.1</VariableLink>
          </Object>
          <Object Name="@volt_imbalance" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Nerovnomerne napeti clanku</Comment>
            <Id>355</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus2_DIAG.0</VariableLink>
          </Object>
          <Object Name="@batt_lock" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - zamknuta baterie</Comment>
            <Id>356</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.24</VariableLink>
          </Object>
          <Object Name="@comm_ext" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - externi komunikace</Comment>
            <Id>357</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.23</VariableLink>
          </Object>
          <Object Name="@curr_ic" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - snimac proudu</Comment>
            <Id>358</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.22</VariableLink>
          </Object>
          <Object Name="@leak_curr" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - unik proudu</Comment>
            <Id>359</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.21</VariableLink>
          </Object>
          <Object Name="@all_bms_off" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - vsechny BMS offline</Comment>
            <Id>360</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.20</VariableLink>
          </Object>
          <Object Name="@bmu_bus" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - interni sbernice BMU</Comment>
            <Id>361</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.18</VariableLink>
          </Object>
          <Object Name="@mbms_comm" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - MBMS &lt;-&gt; BMS komunikace</Comment>
            <Id>362</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.17</VariableLink>
          </Object>
          <Object Name="@selftest_init" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - inicializace pri startu</Comment>
            <Id>363</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.16</VariableLink>
          </Object>
          <Object Name="@selftest_coulomb" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - coulombuv citac</Comment>
            <Id>364</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.15</VariableLink>
          </Object>
          <Object Name="@selftest_serial" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - chyba poctu clanku</Comment>
            <Id>365</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.14</VariableLink>
          </Object>
          <Object Name="@emerg_stop" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - nouzove zastaveni</Comment>
            <Id>366</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.13</VariableLink>
          </Object>
          <Object Name="@insulation" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - izolace</Comment>
            <Id>367</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.12</VariableLink>
          </Object>
          <Object Name="@safety_chk" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - bezpecnostni kontrola</Comment>
            <Id>368</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.11</VariableLink>
          </Object>
          <Object Name="@selftest_volt" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - napetova kontrola</Comment>
            <Id>369</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.10</VariableLink>
          </Object>
          <Object Name="@bms_bus" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - interni sbernice BMS</Comment>
            <Id>370</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.9</VariableLink>
          </Object>
          <Object Name="@bmic" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - BMIC</Comment>
            <Id>371</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.8</VariableLink>
          </Object>
          <Object Name="@shutdown_circuit" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - vypinaci obvod</Comment>
            <Id>372</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.7</VariableLink>
          </Object>
          <Object Name="@batt_damage" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - poskozena baterie</Comment>
            <Id>373</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.6</VariableLink>
          </Object>
          <Object Name="@relay" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - rele</Comment>
            <Id>374</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.5</VariableLink>
          </Object>
          <Object Name="@input_reverse" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - prepolovani</Comment>
            <Id>375</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.4</VariableLink>
          </Object>
          <Object Name="@input_ov" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba - prepeti na vstupu</Comment>
            <Id>376</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>ErrorCode1_DIAG.3</VariableLink>
          </Object>
        </Object>
        <Object Name="BAT_Assignment" Class="Amit.Ngs.Core.NgsSubroutine" Def="Subroutine">
          <Rename>True</Rename>
          <ParentObject>Global</ParentObject>
          <Id>377</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[AktualniCinny = 0;
AktualniCinnyL1 = 0;
AktualniCinnyL2 = 0;
AktualniCinnyL3 = 0;
AktualniJalovy = 0;
AktualniJalovyL1 = 0;
AktualniJalovyL2 = 0;
AktualniJalovyL3 = 0;
Ucinik = 0;
Nabijeni = 0;
Vybijeni = 0;
Vykon_DC = 0;
Proud_DC = 0;
Napeti_DC = 0;
MaxNabijeciVykon = -1;
MaxVybijeciVykon = -1;
MaxVykon_STR = 0;
SoC = -1;
SoH = 0;
RemainCap = -1; //SoE = 0;
TotalDodavka = 0;
TotalOdber = 0;
NuceneNabijeni = 0;
BalancingRequest = 0; 
OperationStatus = -1000;    // dodělat alarmy a statusy pro BMS
AlarmStatus = 0;            // dodělat alarmy pro STR
RizeniP_Povoleno = 0;
RizeniQ_Povoleno = 0;
RizeniP = 0;
RizeniQ = 0;
NabijeciVykon_BMS = 0;
VybijeciVykon_BMS = 0;
Count_STR = 0;
Count_BMS = 0;
Count_STR_OK = 0;
Count_BMS_OK = 0;  
Count_BMS_OFF = 0;
Evt1 = 0;
BasicStatus = 0;
ProtectionInfo = 0;
AlarmInfo = 0;
AlarmStatus2 = 0;
ErrorCode1 = 0;

    
    // přiřazení hodnot z příslušných STR
    For Hodnota = 0 To (GetDimRow(MR_BAT_STR) - 1) Do
	     CurrentRowInt = Hodnota;
            // vybere jen STR zahrnuté do příslušné BAT a zároveň nejsou zakázané
        If (MR_BAT_STR_SET[CurrentRowInt, 1] == BAT_CurrentRowInt) and (MR_BAT_STR_SET[CurrentRowInt, 4] == 0) then
            
            Count_STR = Count_STR + 1;
            
            if MR_BAT_STR[CurrentRowInt, 40] != -1000 then 
               
                
                // vyjmutí STR v chybovém stavu nebo manuálním řízení
                if  (MR_BAT_STR[CurrentRowInt, 40] != 7) and (MR_BAT_STR_SET[CurrentRowInt, 2] == 0)then
                    
                    Count_STR_OK = Count_STR_OK + 1;
                    // doplněno do CASe níže MaxVykon_STR = MaxVykon_STR + MR_BAT_STR[Hodnota_2, 39];
                    
                    if Ucinik == 0 then
                        Ucinik = MR_BAT_STR[CurrentRowInt, 19];
                    else
                        Ucinik = Ucinik + MR_BAT_STR[CurrentRowInt, 19];
                    endif;
                    
                endif;

                
                AktualniCinny = AktualniCinny + MR_BAT_STR[CurrentRowInt, 0];
                AktualniCinnyL1 = AktualniCinnyL1 + MR_BAT_STR[CurrentRowInt, 1];
                AktualniCinnyL2 = AktualniCinnyL2 + MR_BAT_STR[CurrentRowInt, 2];
                AktualniCinnyL3 = AktualniCinnyL3 + MR_BAT_STR[CurrentRowInt, 3];
                AktualniJalovy = AktualniJalovy + MR_BAT_STR[CurrentRowInt, 4];
                AktualniJalovyL1 = AktualniJalovyL1 + MR_BAT_STR[CurrentRowInt, 5];
                AktualniJalovyL2 = AktualniJalovyL2 + MR_BAT_STR[CurrentRowInt, 6];
                AktualniJalovyL3 = AktualniJalovyL3 + MR_BAT_STR[CurrentRowInt, 7];

                
                if MR_BAT_STR[CurrentRowInt, 32] > Napeti_DC then
                    Napeti_DC = MR_BAT_STR[CurrentRowInt, 32];
                endif;
                
                Proud_DC = Proud_DC + MR_BAT_STR[CurrentRowInt, 33];
                Vykon_DC = Vykon_DC + MR_BAT_STR[CurrentRowInt, 34];
                
               
                // vyjmutí manuálně řízených STR
                if (MR_BAT_STR_SET[CurrentRowInt, 2] == 0) then
                    Case Real_To_Int(MR_BAT_STR[CurrentRowInt, 40]) of 
                    1: // off
                        OperationStatus = 1 > OperationStatus ? 1 : OperationStatus;
                    3: // Starting
                        OperationStatus = 3 > OperationStatus ? 3 : OperationStatus;
                    4: // MAximum Power
                        OperationStatus = 4;
                        MaxVykon_STR = MaxVykon_STR + MR_BAT_STR[CurrentRowInt, 39];
                    5: // Vyrábi dle řízení
                        OperationStatus = (OperationStatus != 4) ? 5 : OperationStatus;
                        MaxVykon_STR = MaxVykon_STR + MR_BAT_STR[CurrentRowInt, 39];
                    6: // Shutting down
                        OperationStatus = 2 > OperationStatus ? 6 : OperationStatus;
                    // 7 - fault se vyhodnocuje jinde 
                    8: // Standby - AC disconnected 
                        OperationStatus = (OperationStatus != 4) or (OperationStatus != 5) or (OperationStatus != 9) ? 8 : OperationStatus;
                    9: // Started - AC connected
                        OperationStatus = (OperationStatus != 4) or (OperationStatus != 5) ? 9 : OperationStatus;
                        MaxVykon_STR = MaxVykon_STR + MR_BAT_STR[CurrentRowInt, 39];
                    endcase;
                endif;

                // agregace alarmových hlášení
                Evt1 = Real_To_DWORD(MR_BAT_STR[CurrentRowInt, 41]);
                
                AlarmStatus.0 = (Evt1.0 != 0) ? 1 : AlarmStatus.0; // Ground fault
                AlarmStatus.1 = ((Evt1.1 != 0) OR (Evt1.10 != 0) OR (Evt1.11 != 0)) ? 1 : AlarmStatus.1; // Voltage faults
                AlarmStatus.2 = ((Evt1.2 != 0) OR (Evt1.3 != 0)) ? 1 : AlarmStatus.2; // Disconnects
                AlarmStatus.3 = ((Evt1.4 != 0) OR (Evt1.5 != 0) OR (Evt1.6 != 0)) ? 1 : AlarmStatus.3; // Shutdowns
                AlarmStatus.4 = ((Evt1.7 != 0) OR (Evt1.13 != 0)) ? 1 : AlarmStatus.4; // Temperature errors
                AlarmStatus.5 = ((Evt1.8 != 0) OR (Evt1.9 != 0)) ? 1 : AlarmStatus.5; // Frequency errors
                AlarmStatus.6 = ((Evt1.14 != 0) OR (Evt1.15 != 0)) ? 1 : AlarmStatus.6; // Communication/Memory/HW
                AlarmStatus.7 = ((Evt1.12 != 0) OR (Evt1.16 != 0) OR (Evt1.17 != 0)) ? 1 : AlarmStatus.7; // Other alarms/warnings

            endif;     
        endif;
        
    endfor;
    
    if Count_STR_OK == 0 then
        OperationStatus = 7;
        MaxVykon_STR = 0;
        Ucinik = 0;
    else
        Ucinik = Ucinik / Count_STR_OK;
    endif;
    
    
    
    Nabijeni = AktualniCinny < 0 ?  (AktualniCinny * -1): 0;
    Vybijeni = AktualniCinny > 0 ?  (AktualniCinny): 0;
    
    // přiřazení hodnot z příslušných BMS

    For Hodnota = 0 To (GetDimRow(MR_BAT_BMS) - 1) Do
        CurrentRowInt = Hodnota;
	    // počítá ručně odpojené BMSky kvůli kontrole
        If MR_BAT_BMS_SET[CurrentRowInt, 2] == 1 then
        Count_BMS_OFF = Count_BMS_OFF +1;
        endif;
        // vybere jen BMS patřící do dané BAT a není zároveň ODPOJENA/zakázána !
        If (MR_BAT_BMS_SET[CurrentRowInt, 1] == BAT_CurrentRowInt) and (MR_BAT_BMS_SET[CurrentRowInt, 2] == 0)then
            Count_BMS = Count_BMS + 1;
            if MR_BAT_BMS[CurrentRowInt, 0] != -1000 then    
                Count_BMS_OK = Count_BMS_OK + 1;
                
                
                NabijeciVykon_BMS = MR_BAT_BMS[CurrentRowInt, 12];
                VybijeciVykon_BMS = MR_BAT_BMS[CurrentRowInt, 14];
                
                if MaxNabijeciVykon == -1 then
                    MaxNabijeciVykon = NabijeciVykon_BMS;
                else   
                    MaxNabijeciVykon = MaxNabijeciVykon > NabijeciVykon_BMS ? NabijeciVykon_BMS : MaxNabijeciVykon;
                endif;
                
                if  MaxVybijeciVykon == -1 then
                    MaxVybijeciVykon = VybijeciVykon_BMS;
                else   
                    MaxVybijeciVykon = MaxVybijeciVykon > VybijeciVykon_BMS ? VybijeciVykon_BMS : MaxVybijeciVykon;
                endif;
                
                
                if SoC == -1 then    
                    SoC = MR_BAT_BMS[CurrentRowInt, 6];
                else
                    SoC = SoC > MR_BAT_BMS[CurrentRowInt, 6] ? MR_BAT_BMS[CurrentRowInt, 6] : SoC;
                endif;
                
                if RemainCap == -1 then    
                    RemainCap = MR_BAT_BMS[CurrentRowInt, 31];
                else
                    RemainCap = RemainCap > MR_BAT_BMS[CurrentRowInt, 31] ? MR_BAT_BMS[CurrentRowInt, 31] : RemainCap;
                endif;
                
                /* Nahrazeno RemainingCap
                if SoE == 0 then    
                    SoE = MR_BAT_BMS[Hodnota_2, 7];
                else
                    SoE = SoE > MR_BAT_BMS[Hodnota_2, 7] ? MR_BAT_BMS[Hodnota_2, 7] : SoE;
                endif;
                */
                if SoH == 0 then
                    SoH = MR_BAT_BMS[CurrentRowInt, 8];
                else
                    SoH = SoH + MR_BAT_BMS[CurrentRowInt, 6];
                endif;
                
                TotalDodavka = TotalDodavka + MR_BAT_BMS[CurrentRowInt, 33];
                TotalOdber = TotalOdber + MR_BAT_BMS[CurrentRowInt, 32];
                
                NuceneNabijeni = NuceneNabijeni < MR_BAT_BMS[CurrentRowInt, 9] ? MR_BAT_BMS[CurrentRowInt, 9] : NuceneNabijeni;
                BalancingRequest = BalancingRequest <  MR_BAT_BMS[CurrentRowInt, 10] ? MR_BAT_BMS[CurrentRowInt, 10] : BalancingRequest;
            
            
                // agregace alarmových hlášení
                
                BasicStatus = Real_To_Word(MR_BAT_BMS[CurrentRowInt, 0]);
                ProtectionInfo = Real_To_Word(MR_BAT_BMS[CurrentRowInt, 1]);
                AlarmInfo = Real_To_Word(MR_BAT_BMS[CurrentRowInt, 2]);
                AlarmStatus2 = Real_To_Word(MR_BAT_BMS[CurrentRowInt, 42]);
                ErrorCode1 = Real_To_DWORD(MR_BAT_BMS[CurrentRowInt, 43]);
                
                AlarmStatus.8 = (AlarmStatus2.2 != 0) ? 1 : AlarmStatus.8; // Ztrata komunikace s BMS (comm lost)
                AlarmStatus.9 = (AlarmStatus2.1 != 0 OR AlarmStatus2.0 != 0) ? 1 : AlarmStatus.9; // Imbalance – clanek ma rozdilne napeti/teplotu
                AlarmStatus.10 = (ProtectionInfo.0 != 0 OR ProtectionInfo.2 != 0) ? 1 : AlarmStatus.10; // Podnapetova ochrana (clanek/system)
                AlarmStatus.11 = (ProtectionInfo.1 != 0 OR ProtectionInfo.3 != 0) ? 1 : AlarmStatus.11; // Prepetova ochrana (clanek/system)
                AlarmStatus.12 = (ProtectionInfo.8 != 0 OR ProtectionInfo.9 != 0) ? 1 : AlarmStatus.12; // Proudova ochrana (nabijeni/vybijeni)
                AlarmStatus.13 = (ProtectionInfo.4 != 0 OR ProtectionInfo.6 != 0) ? 1 : AlarmStatus.13; // Nizka teplota (nabijeni/vybijeni)
                AlarmStatus.14 = (ProtectionInfo.5 != 0 OR ProtectionInfo.7 != 0) ? 1 : AlarmStatus.14; // Vysoka teplota (nabijeni/vybijeni)
                AlarmStatus.15 = (BasicStatus.3 != 0) ? 1 : AlarmStatus.15; // Systemova chyba (System error protection)
                AlarmStatus.16 = (ErrorCode1.23 != 0 OR ErrorCode1.14 != 0) ? 1 : AlarmStatus.16; // Chyba komunikace nebo inicializace
                AlarmStatus.17 = (ErrorCode1.22 != 0 OR ErrorCode1.21 != 0) ? 1 : AlarmStatus.17; // Chyba mereni proudu (Current IC / leakage error)
                AlarmStatus.18 = (ErrorCode1.13 != 0) ? 1 : AlarmStatus.18; // Nouzove vypnuti (Emergency stop)
                AlarmStatus.19 = (ErrorCode1.12 != 0) ? 1 : AlarmStatus.19; // Chyba izolace (Insulation fault)
                AlarmStatus.20 = (ErrorCode1.6 != 0) ? 1 : AlarmStatus.20; // Poskozena baterie (Battery damage)
                AlarmStatus.21 = (ErrorCode1.5 != 0) ? 1 : AlarmStatus.21; // Chyba rele
                AlarmStatus.22 = (AlarmInfo.10 != 0) ? 1 : AlarmStatus.22; // Alarm – unik proudu
                AlarmStatus.23 = (AlarmInfo.15 != 0) ? 1 : AlarmStatus.23; // Alarm – teplota svorek

                // doplnit min a max napětí :-- balance request
        
            endif;
        endif;
        
    endfor;
    
    SoH = SoH / Count_BMS_OK;
    // Hlídání počtu fungujících BMS i vůči enumeraci v SET maticích ( bere ohled na mauálně zakázané BMS)  
    TimerForBMSFault(Input= not((Count_BMS_OK == Count_BMS) and (Count_BMS == (MR_BAT_SET[BAT_CurrentRowInt, 5] + Count_BMS_OFF))) ,Delay= 10000);
    if  not(TimerForBMSFault.Out) then    
        MaxNabijeciVykon = MaxNabijeciVykon * Count_BMS_OK;
        MaxVybijeciVykon = MaxVybijeciVykon * Count_BMS_OK;
        RemainCap = RemainCap * Count_BMS_OK; //SoE = SoE * Count_BMS_OK;
    else
        MaxNabijeciVykon = 0;
        MaxVybijeciVykon = 0;
        RemainCap = 0; //SoE = SoE * Count_BMS_OK;
        SoC = 0;
        OperationStatus = 7;
    endif;
    // přidat kontrolu nastavené min max DC napětí 
    
MR_BAT[BAT_CurrentRowInt, 0] = AktualniCinny; // AktualniCinny
MR_BAT[BAT_CurrentRowInt, 1] = AktualniCinnyL1; // AktualniCinnyL1
MR_BAT[BAT_CurrentRowInt, 2] = AktualniCinnyL2; // AktualniCinnyL2
MR_BAT[BAT_CurrentRowInt, 3] = AktualniCinnyL3; // AktualniCinnyL3
MR_BAT[BAT_CurrentRowInt, 4] = AktualniJalovy; // AktualniJalovy
MR_BAT[BAT_CurrentRowInt, 5] = AktualniJalovyL1; // AktualniJalovyL1
MR_BAT[BAT_CurrentRowInt, 6] = AktualniJalovyL2; // AktualniJalovyL2
MR_BAT[BAT_CurrentRowInt, 7] = AktualniJalovyL3; // AktualniJalovyL3
MR_BAT[BAT_CurrentRowInt, 8] = Ucinik; // Ucinik
MR_BAT[BAT_CurrentRowInt, 9] = Nabijeni; // Nabijeni
MR_BAT[BAT_CurrentRowInt, 10] = Vybijeni; // Vybijeni
MR_BAT[BAT_CurrentRowInt, 11] = Napeti_DC; // Napeti_DC
MR_BAT[BAT_CurrentRowInt, 12] = Proud_DC; // Proud_DC
MR_BAT[BAT_CurrentRowInt, 13] = Vykon_DC; // Vykon_DC
MR_BAT[BAT_CurrentRowInt, 14] = MIN(MaxNabijeciVykon , MaxVykon_STR); // MaxNabijeciVykon - minimum z STR a BMS
MR_BAT[BAT_CurrentRowInt, 15] = MIN(MaxVybijeciVykon , MaxVykon_STR); // MaxVybijeciVykon - minimum z STR a BMS
MR_BAT[BAT_CurrentRowInt, 16] = MaxVykon_STR;
MR_BAT[BAT_CurrentRowInt, 17] = SoC; // SoC
MR_BAT[BAT_CurrentRowInt, 18] = SoH; // SoH
MR_BAT[BAT_CurrentRowInt, 19] = RemainCap;// SoE; // SoE
MR_BAT[BAT_CurrentRowInt, 20] = TotalDodavka; // TotalDodavka
MR_BAT[BAT_CurrentRowInt, 21] = TotalOdber; // TotalOdber
MR_BAT[BAT_CurrentRowInt, 22] = NuceneNabijeni; // NuceneNabijeni
MR_BAT[BAT_CurrentRowInt, 23] = BalancingRequest; // BalancingRequest
MR_BAT[BAT_CurrentRowInt, 24] = OperationStatus; // OperationStatus
MR_BAT[BAT_CurrentRowInt, 25] = AlarmStatus; // AlarmStatus
//MR_BAT[BAT_CurrentRowInt, 26] = RizeniP_Povoleno; // RizeniP_Povoleno
//MR_BAT[BAT_CurrentRowInt, 27] = RizeniQ_Povoleno; // RizeniQ_Povolena
//MR_BAT[BAT_CurrentRowInt, 28] = RizeniP; // RizeniP
//MR_BAT[BAT_CurrentRowInt, 29] = RizeniQ; // RizeniQ

// umožní diagnostikovat konkrétní virtualni baterii
IF A_Diagnostika == BAT_CurrentRowInt then
    AlarmStatus_DIAG = AlarmStatus;
endif;]]><Regions><Region><Expanded>True</Expanded></Region></Regions></Body>
          <Object Name="TimerForBMSFault" Class="Amit.Ngs.Core.DsGenericObject" Def="TimerOn">
            <ParentObject>BAT_Assignment</ParentObject>
            <Id>378</Id>
            <Authority>3</Authority>
            <Comment>
            </Comment>
            <Property BindId="0" Value="1000" />
            <Property BindId="1" Value="0" />
            <Property BindId="2" Value="0" />
            <Property BindId="3" Value="0" />
          </Object>
          <Object Name="AktualniCinny" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>379</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AktualniCinnyL1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>380</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AktualniCinnyL2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>381</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AktualniCinnyL3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>382</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AktualniJalovy" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>383</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AktualniJalovyL1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>384</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AktualniJalovyL2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>385</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AktualniJalovyL3" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>386</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmStatus" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>387</Id>
            <Authority>3</Authority>
            <Typ>15</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Ucinik" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>388</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Nabijeni" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>389</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Vybijeni" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>390</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Vykon_DC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>391</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Proud_DC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>392</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxNabijeciVykon" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>393</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxVybijeciVykon" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>394</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Evt1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>395</Id>
            <Authority>3</Authority>
            <Typ>15</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="MaxVykon_STR" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>396</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SoC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>397</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="SoH" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>398</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="RemainCap" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>399</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TotalDodavka" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>400</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TotalOdber" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>401</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="NuceneNabijeni" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>402</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="BalancingRequest" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>403</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="OperationStatus" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>404</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="RizeniP_Povoleno" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>405</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="RizeniQ_Povoleno" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>406</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="RizeniP" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>407</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="RizeniQ" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>408</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="NabijeciVykon_BMS" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>409</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VybijeciVykon_BMS" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>410</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Count_STR" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>411</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Count_BMS" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>412</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Count_STR_OK" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>413</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Count_BMS_OK" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>414</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>415</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Napeti_DC" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>416</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Count_BMS_OFF" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>417</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Hodnota" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>418</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmInfo" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>419</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmStatus2" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>420</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ProtectionInfo" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>421</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="AlarmStatus_DIAG" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>422</Id>
            <Authority>3</Authority>
            <Typ>15</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>False</CfcPin>
          </Object>
          <Object Name="BasicStatus" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>423</Id>
            <Authority>3</Authority>
            <Typ>13</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="ErrorCode1" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>424</Id>
            <Authority>3</Authority>
            <Typ>15</Typ>
            <Kind>0</Kind>
            <InitDataFormat>1</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="A_Diagnostika" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Comment>slouží pro diagnostiku jednotlivých STR</Comment>
            <Id>425</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>1</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>True</IsUserInit>
            <InitData>-1</InitData>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="@inv_ground" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Uzemnovaci chyba (Ground fault)</Comment>
            <Id>426</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.0</VariableLink>
          </Object>
          <Object Name="@inv_voltage" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Napetove chyby (DC/AC over/under voltage)</Comment>
            <Id>427</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.1</VariableLink>
          </Object>
          <Object Name="@inv_disconnect" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Otevrene odpojovace (AC/DC disconnect)</Comment>
            <Id>428</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.2</VariableLink>
          </Object>
          <Object Name="@inv_shutdown" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Odstaveni (manualni, grid, cabinet open)</Comment>
            <Id>429</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.3</VariableLink>
          </Object>
          <Object Name="@inv_temp" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Teplotni chyby (Over/Under temperature)</Comment>
            <Id>430</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.4</VariableLink>
          </Object>
          <Object Name="@inv_freq" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Frekvencni chyby (Over/Under frequency)</Comment>
            <Id>431</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.5</VariableLink>
          </Object>
          <Object Name="@inv_comm" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba komunikace / pameti / HW test</Comment>
            <Id>432</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.6</VariableLink>
          </Object>
          <Object Name="@inv_other" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ostatni alarmy a varovani</Comment>
            <Id>433</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.7</VariableLink>
          </Object>
          <Object Name="@bms_comm" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ztrata komunikace s BMS</Comment>
            <Id>434</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.8</VariableLink>
          </Object>
          <Object Name="@bms_imbalance" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Nerovnovaha clanku (napeti/teplota)</Comment>
            <Id>435</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.9</VariableLink>
          </Object>
          <Object Name="@bms_uvprot" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Podnapetova ochrana</Comment>
            <Id>436</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.10</VariableLink>
          </Object>
          <Object Name="@bms_ovprot" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Prepetova ochrana</Comment>
            <Id>437</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.11</VariableLink>
          </Object>
          <Object Name="@bms_ocprot" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Proudova ochrana</Comment>
            <Id>438</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.12</VariableLink>
          </Object>
          <Object Name="@bms_temp_lo" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - nizka teplota</Comment>
            <Id>439</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.13</VariableLink>
          </Object>
          <Object Name="@bms_temp_hi" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Ochrana - vysoka teplota</Comment>
            <Id>440</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.14</VariableLink>
          </Object>
          <Object Name="@bms_syserr" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Systemova chyba BMS</Comment>
            <Id>441</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.15</VariableLink>
          </Object>
          <Object Name="@bms_comperr" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Komunikacni/inicializacni chyba</Comment>
            <Id>442</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.16</VariableLink>
          </Object>
          <Object Name="@bms_measerr" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba mereni proudu / leakage</Comment>
            <Id>443</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.17</VariableLink>
          </Object>
          <Object Name="@bms_emstop" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Nouzove vypnuti</Comment>
            <Id>444</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.18</VariableLink>
          </Object>
          <Object Name="@bms_isofail" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba izolace</Comment>
            <Id>445</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.19</VariableLink>
          </Object>
          <Object Name="@bms_damage" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Poskozena baterie</Comment>
            <Id>446</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.20</VariableLink>
          </Object>
          <Object Name="@bms_relay" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Chyba rele</Comment>
            <Id>447</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.21</VariableLink>
          </Object>
          <Object Name="@bms_leakwarn" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - unik proudu</Comment>
            <Id>448</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.22</VariableLink>
          </Object>
          <Object Name="@bms_termtemp" Class="Amit.Ngs.Core.NgsAliasVar" Def="">
            <Comment>Alarm - teplota svorek</Comment>
            <Id>449</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <VariableLink>AlarmStatus_DIAG.23</VariableLink>
          </Object>
        </Object>
        <Object Name="BAT_to_STR_write" Class="Amit.Ngs.Core.NgsSubroutine" Def="Subroutine">
          <Rename>True</Rename>
          <ParentObject>Global</ParentObject>
          <Id>450</Id>
          <Authority>3</Authority>
          <Header Class="Amit.Ngs.Core.NgsCodeHeader"><![CDATA[POKUS]]><Regions /></Header>
          <Body Class="Amit.Ngs.Core.NgsCodeBodyText"><![CDATA[TMP_Vykon = 0;
TMP_Rezim = 0;
PowerDelivered = false;

For Hodnota = 0 To (GetDimRow(MR_BAT_STR) - 1) Do
    CurrentRowInt = Hodnota;
    // vybere jen STR zahrnuté do příslušné BAT a zároveň nejsou zakázané
    if (MR_BAT_STR_SET[CurrentRowInt, 1] == BAT_write_CurrentRowInt) and (MR_BAT_STR_SET[CurrentRowInt, 4] == 0) then
        
        // pokud STR komunikuje
       if MR_BAT_STR[CurrentRowInt, 40] != -1000 then 
            
            // vyjmutí STR v chybovém stavu nebo manuálním řízení
            if  (MR_BAT_STR[CurrentRowInt, 40] != 7) and (MR_BAT_STR_SET[CurrentRowInt, 2] == 0)then
                
                // pokud je povoleno řízení
                if MR_BAT[BAT_write_CurrentRowInt, 26] == 1 or not(PowerDelivered) then
                
                    // hystereze při požadovaném výkonu pod 5% se spustí jen jeden střídač, při jeho zatížení nad 50% se zapnou všechny
                    VykonHyst(In= MR_BAT[BAT_write_CurrentRowInt, 28] ,LowerLimit= (MR_BAT[BAT_write_CurrentRowInt, 16] * 0.05) ,UpperLimit= (MR_BAT_STR[CurrentRowInt, 39] * 0.5));
                    if VykonHyst.Out then
                        // výpočet požadovaného výkonu pro konkrétní STR z požadavku na BAT ( pozadovanyP * (MaxSTR / MaxBAT))  
                        TMP_Vykon = MR_BAT[BAT_write_CurrentRowInt, 28] * (MR_BAT_STR[CurrentRowInt, 39] / MR_BAT[BAT_write_CurrentRowInt, 16]);
                    else
                        TMP_Vykon = MR_BAT[BAT_write_CurrentRowInt, 28];
                        PowerDelivered = true;
                    endif;
                     
                else
                    TMP_Vykon = 0;
                endif;
                
                // pokud není požadován výkon a není ve výkonu zapni powersaving( vypne IGBTs, zustane na gridu) 
                if (MR_BAT_STR[CurrentRowInt, 45] == 0) and (MR_BAT_STR[CurrentRowInt, 0] == 0) then
                    TMP_Rezim = 2;
                else
                    TMP_Rezim = 1;
                endif;
            endif;
            
            // pokud je v manuálním řízení
            if (MR_BAT_STR_SET[CurrentRowInt, 2] == 1) then
                
                 // pokud není požadován výkon a není ve výkonu zapni powersaving( vypne IGBTs, zustane na gridu) 
                if (MR_BAT_STR_SET[CurrentRowInt, 2] == 0) and (MR_BAT_STR[CurrentRowInt, 0] == 0) then
                    TMP_Rezim = 2;
                else
                    TMP_Rezim = 1;
                endif;
                // zápis ruční hodnoty výkonu
                TMP_Vykon = MR_BAT_STR_SET[CurrentRowInt, 3];
            endif;
            
            // doplnění dynamické ochrany max nab vyb výkonu
            
            
            // zápis hearbeatu pro zpětnou kontolu střídače
            MR_BAT_STR[CurrentRowInt, 38] = MR_BAT_STR[CurrentRowInt, 37];
            MR_BAT_STR[CurrentRowInt, 44] = TMP_Rezim; 
            MR_BAT_STR[CurrentRowInt, 45] = TMP_Vykon;
        endif;
        
    endif;
    
    
    // pokud je STR zakázán nebo v chybě- nuluje se povolení řízení a výkon
    if (MR_BAT_STR_SET[CurrentRowInt, 4] == 1) or (MR_BAT_STR[CurrentRowInt, 40] == 7)then
        MR_BAT_STR[CurrentRowInt, 44] = 0;
        MR_BAT_STR[CurrentRowInt, 45] = 0;
        MR_BAT_STR[CurrentRowInt, 46] = 0; // řízení jaloviny - neimplementováno
    endif;
    
EndFor;]]><Regions /></Body>
          <Object Name="CurrentRowInt" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>451</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_Rezim" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>452</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="TMP_Vykon" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>453</Id>
            <Authority>3</Authority>
            <Typ>3</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="Hodnota" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>454</Id>
            <Authority>3</Authority>
            <Typ>1</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="PowerDelivered" Class="Amit.Ngs.Core.NgsLocalVar" Def="">
            <Id>455</Id>
            <Authority>3</Authority>
            <Typ>8</Typ>
            <Kind>0</Kind>
            <InitDataFormat>0</InitDataFormat>
            <IsUserInit>False</IsUserInit>
            <CfcPin>True</CfcPin>
          </Object>
          <Object Name="VykonHyst" Class="Amit.Ngs.Core.DsGenericObject" Def="Hyst2L">
            <Rename>True</Rename>
            <ParentObject>BAT_to_STR_write</ParentObject>
            <Id>456</Id>
            <Authority>3</Authority>
            <Comment>
            </Comment>
            <Property BindId="0" Value="10" />
            <Property BindId="1" Value="100" />
            <Property BindId="2" Value="0" />
            <Property BindId="3" Value="0" />
          </Object>
        </Object>
        <Object Name="BAT" Class="Amit.Ngs.Core.DsModbusIpMaster" Def="ModbusMasterTCP">
          <Rename>True</Rename>
          <ParentObject>Global</ParentObject>
          <Id>82</Id>
          <Authority>3</Authority>
          <PeerAddress>192.168.1.3</PeerAddress>
          <PeerPort>502</PeerPort>
          <InterMessageDelay>0</InterMessageDelay>
          <Object Name="REFUv2" Class="Amit.Ngs.Core.DsModbusDeviceIP" Def="ModbusDeviceTCP">
            <Rename>True</Rename>
            <ParentObject>ModbusMasterTCP1</ParentObject>
            <Id>457</Id>
            <Authority>3</Authority>
            <ModbusStatusRegister>2</ModbusStatusRegister>
            <Timeout>3000</Timeout>
            <Address>1</Address>
            <Enabled>True</Enabled>
            <Object Name="Arr1" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>458</Id>
              <Authority>3</Authority>
              <Typ>4</Typ>
              <Address>40000</Address>
              <DimRow>1</DimRow>
              <DimCol>2</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="Arr103" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>459</Id>
              <Authority>3</Authority>
              <Typ>4</Typ>
              <Address>40070</Address>
              <DimRow>1</DimRow>
              <DimCol>42</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="Arr120" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>460</Id>
              <Authority>3</Authority>
              <Typ>4</Typ>
              <Address>40122</Address>
              <DimRow>1</DimRow>
              <DimCol>28</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="Arr121" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>461</Id>
              <Authority>3</Authority>
              <Typ>4</Typ>
              <Address>40150</Address>
              <DimRow>1</DimRow>
              <DimCol>32</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="Arr123" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>462</Id>
              <Authority>3</Authority>
              <Typ>4</Typ>
              <Address>40182</Address>
              <DimRow>1</DimRow>
              <DimCol>26</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="Arr64800" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>463</Id>
              <Authority>3</Authority>
              <Typ>4</Typ>
              <Address>40225</Address>
              <DimRow>1</DimRow>
              <DimCol>14</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="RemoteMaxPower" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Comment>zpětná informace o řízení výkonu</Comment>
              <Id>464</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>2001</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="ArrFW" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>465</Id>
              <Authority>3</Authority>
              <Typ>14</Typ>
              <Address>1001</Address>
              <DimRow>1</DimRow>
              <DimCol>4</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="setPowerPct" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Comment>% of MaxPower</Comment>
              <Id>466</Id>
              <Authority>3</Authority>
              <Typ>1</Typ>
              <Address>40187</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="ArrRO" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>467</Id>
              <Authority>3</Authority>
              <Typ>16</Typ>
              <Address>3001</Address>
              <DimRow>1</DimRow>
              <DimCol>3</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="PowerPctTimeoutPeriod" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Comment>timeout pro zadaný výkon,  s</Comment>
              <Id>468</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40189</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>1</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="HeartBeatWrite" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Comment>zapisovat inkrementaci pro heartbeat</Comment>
              <Id>469</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40229</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="resetAlarm" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Comment>1: reset alarmu</Comment>
              <Id>470</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40230</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="enablePowerControl" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Comment>0: dis, 1: enable</Comment>
              <Id>471</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40191</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>1</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="setMaxPower" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>472</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40152</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="PCSSetOperation" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Comment>1: start, 2: stop, 3: standby, 4: exit-standby</Comment>
              <Id>473</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40231</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>1</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="ModbusID" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>474</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40068</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="AC_Power" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>475</Id>
              <Authority>3</Authority>
              <Typ>4</Typ>
              <Address>40084</Address>
              <DimRow>1</DimRow>
              <DimCol>2</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="WRtg" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>476</Id>
              <Authority>3</Authority>
              <Typ>14</Typ>
              <Address>40125</Address>
              <DimRow>1</DimRow>
              <DimCol>2</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="PCSHb" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>477</Id>
              <Authority>3</Authority>
              <Typ>13</Typ>
              <Address>40228</Address>
              <DimRow>0</DimRow>
              <DimCol>0</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>16</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>6</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
          </Object>
        </Object>
        <Object Name="PylonT" Class="Amit.Ngs.Core.DsModbusIpMaster" Def="ModbusMasterTCP">
          <Rename>True</Rename>
          <ParentObject>Global</ParentObject>
          <Id>478</Id>
          <Authority>3</Authority>
          <PeerAddress>192.168.1.4</PeerAddress>
          <PeerPort>502</PeerPort>
          <InterMessageDelay>0</InterMessageDelay>
          <Object Name="BMS" Class="Amit.Ngs.Core.DsModbusDeviceIP" Def="ModbusDeviceTCP">
            <Rename>True</Rename>
            <ParentObject>ModbusMasterTCP2</ParentObject>
            <Id>479</Id>
            <Authority>3</Authority>
            <ModbusStatusRegister>2</ModbusStatusRegister>
            <Timeout>3000</Timeout>
            <Address>1</Address>
            <Enabled>True</Enabled>
            <Object Name="ArrMBMS" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>480</Id>
              <Authority>3</Authority>
              <Typ>14</Typ>
              <Address>4352</Address>
              <DimRow>1</DimRow>
              <DimCol>74</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="ArrPile2" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>481</Id>
              <Authority>3</Authority>
              <Typ>14</Typ>
              <Address>6912</Address>
              <DimRow>1</DimRow>
              <DimCol>74</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
            <Object Name="ArrPile1" Class="Amit.Ngs.Core.NgsModbusMasterItem" Def="">
              <Id>482</Id>
              <Authority>3</Authority>
              <Typ>14</Typ>
              <Address>5120</Address>
              <DimRow>1</DimRow>
              <DimCol>74</DimCol>
              <Kind>0</Kind>
              <ReferenceVar>NONE</ReferenceVar>
              <Offset>0</Offset>
              <BitLength>32</BitLength>
              <Priority>0</Priority>
              <FunctionWrite>16</FunctionWrite>
              <FunctionRead>3</FunctionRead>
            </Object>
          </Object>
        </Object>
        <Object Name="MR_DIAG" Class="Amit.Ngs.Core.NgsLocalVarMatrix" Def="">
          <Id>483</Id>
          <Authority>3</Authority>
          <Typ>6</Typ>
          <Kind>3</Kind>
          <InitDataFormat>0</InitDataFormat>
          <IsUserInit>False</IsUserInit>
          <CfcPin>False</CfcPin>
          <DimRow>1</DimRow>
          <DimCol>200</DimCol>
        </Object>
      </ObjectList>
      <ReferenceId>
        <RefItem Name="IO.Vbatt" IdO="1" IdP="0" Type="3" Class="HwAmini5" ReadOnly="true" />
        <RefItem Name="IO.DI" IdO="1" IdP="9" Type="13" Class="HwAmini5" ReadOnly="true" />
        <RefItem Name="IO.DO" IdO="1" IdP="10" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.DIManMode" IdO="1" IdP="11" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.DOManMode" IdO="1" IdP="12" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.AIManMode" IdO="1" IdP="13" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.AOManMode" IdO="1" IdP="14" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.DIManVal" IdO="1" IdP="15" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.DOManVal" IdO="1" IdP="16" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.AIDI" IdO="1" IdP="17" Type="13" Class="HwAmini5" ReadOnly="true" />
        <RefItem Name="IO.DINegation" IdO="1" IdP="18" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.AIDINegation" IdO="1" IdP="19" Type="13" Class="HwAmini5" />
        <RefItem Name="IO.Vpwr" IdO="1" IdP="20" Type="3" Class="HwAmini5" ReadOnly="true" />
        <RefItem Name="IO.DI00" IdO="2" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI00.Raw" IdO="2" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI00.Negation" IdO="2" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI00.ManMode" IdO="2" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI00.ManValue" IdO="2" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI01" IdO="3" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI01.Raw" IdO="3" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI01.Negation" IdO="3" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI01.ManMode" IdO="3" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI01.ManValue" IdO="3" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI02" IdO="4" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI02.Raw" IdO="4" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI02.Negation" IdO="4" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI02.ManMode" IdO="4" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI02.ManValue" IdO="4" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI03" IdO="5" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI03.Raw" IdO="5" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI03.Negation" IdO="5" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI03.ManMode" IdO="5" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI03.ManValue" IdO="5" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI04" IdO="6" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI04.Raw" IdO="6" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI04.Negation" IdO="6" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI04.ManMode" IdO="6" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI04.ManValue" IdO="6" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI05" IdO="7" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI05.Raw" IdO="7" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI05.Negation" IdO="7" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI05.ManMode" IdO="7" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI05.ManValue" IdO="7" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI06" IdO="8" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI06.Raw" IdO="8" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI06.Negation" IdO="8" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI06.ManMode" IdO="8" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI06.ManValue" IdO="8" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI07" IdO="9" IdP="0" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI07.Raw" IdO="9" IdP="1" Type="8" Class="IoDI" ReadOnly="true" />
        <RefItem Name="IO.DI07.Negation" IdO="9" IdP="2" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI07.ManMode" IdO="9" IdP="3" Type="8" Class="IoDI" />
        <RefItem Name="IO.DI07.ManValue" IdO="9" IdP="4" Type="8" Class="IoDI" />
        <RefItem Name="IO.DO00" IdO="10" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO00.ManMode" IdO="10" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO00.ManValue" IdO="10" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO01" IdO="11" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO01.ManMode" IdO="11" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO01.ManValue" IdO="11" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO02" IdO="12" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO02.ManMode" IdO="12" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO02.ManValue" IdO="12" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO03" IdO="13" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO03.ManMode" IdO="13" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO03.ManValue" IdO="13" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO04" IdO="14" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO04.ManMode" IdO="14" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO04.ManValue" IdO="14" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO05" IdO="15" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO05.ManMode" IdO="15" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO05.ManValue" IdO="15" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO06" IdO="16" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO06.ManMode" IdO="16" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO06.ManValue" IdO="16" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO07" IdO="17" IdP="0" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO07.ManMode" IdO="17" IdP="2" Type="8" Class="IoDO" />
        <RefItem Name="IO.DO07.ManValue" IdO="17" IdP="3" Type="8" Class="IoDO" />
        <RefItem Name="IO.AI00" IdO="18" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI00.Raw" IdO="18" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI00.ElMin" IdO="18" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.ElMax" IdO="18" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.PhysMin" IdO="18" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.PhysMax" IdO="18" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.Mode" IdO="18" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.SensorType" IdO="18" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.Filter" IdO="18" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.DI" IdO="18" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI00.Negation" IdO="18" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.ManMode" IdO="18" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.ManValue" IdO="18" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.A" IdO="18" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.B" IdO="18" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI00.RawDI" IdO="18" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI00.ManDI" IdO="18" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01" IdO="19" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI01.Raw" IdO="19" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI01.ElMin" IdO="19" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.ElMax" IdO="19" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.PhysMin" IdO="19" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.PhysMax" IdO="19" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.Mode" IdO="19" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.SensorType" IdO="19" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.Filter" IdO="19" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.DI" IdO="19" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI01.Negation" IdO="19" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.ManMode" IdO="19" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.ManValue" IdO="19" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.A" IdO="19" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.B" IdO="19" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI01.RawDI" IdO="19" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI01.ManDI" IdO="19" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02" IdO="20" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI02.Raw" IdO="20" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI02.ElMin" IdO="20" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.ElMax" IdO="20" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.PhysMin" IdO="20" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.PhysMax" IdO="20" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.Mode" IdO="20" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.SensorType" IdO="20" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.Filter" IdO="20" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.DI" IdO="20" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI02.Negation" IdO="20" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.ManMode" IdO="20" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.ManValue" IdO="20" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.A" IdO="20" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.B" IdO="20" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI02.RawDI" IdO="20" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI02.ManDI" IdO="20" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03" IdO="21" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI03.Raw" IdO="21" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI03.ElMin" IdO="21" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.ElMax" IdO="21" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.PhysMin" IdO="21" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.PhysMax" IdO="21" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.Mode" IdO="21" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.SensorType" IdO="21" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.Filter" IdO="21" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.DI" IdO="21" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI03.Negation" IdO="21" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.ManMode" IdO="21" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.ManValue" IdO="21" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.A" IdO="21" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.B" IdO="21" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI03.RawDI" IdO="21" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI03.ManDI" IdO="21" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04" IdO="22" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI04.Raw" IdO="22" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI04.ElMin" IdO="22" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.ElMax" IdO="22" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.PhysMin" IdO="22" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.PhysMax" IdO="22" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.Mode" IdO="22" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.SensorType" IdO="22" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.Filter" IdO="22" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.DI" IdO="22" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI04.Negation" IdO="22" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.ManMode" IdO="22" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.ManValue" IdO="22" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.A" IdO="22" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.B" IdO="22" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI04.RawDI" IdO="22" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI04.ManDI" IdO="22" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05" IdO="23" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI05.Raw" IdO="23" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI05.ElMin" IdO="23" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.ElMax" IdO="23" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.PhysMin" IdO="23" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.PhysMax" IdO="23" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.Mode" IdO="23" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.SensorType" IdO="23" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.Filter" IdO="23" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.DI" IdO="23" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI05.Negation" IdO="23" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.ManMode" IdO="23" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.ManValue" IdO="23" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.A" IdO="23" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.B" IdO="23" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI05.RawDI" IdO="23" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI05.ManDI" IdO="23" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06" IdO="24" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI06.Raw" IdO="24" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI06.ElMin" IdO="24" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.ElMax" IdO="24" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.PhysMin" IdO="24" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.PhysMax" IdO="24" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.Mode" IdO="24" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.SensorType" IdO="24" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.Filter" IdO="24" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.DI" IdO="24" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI06.Negation" IdO="24" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.ManMode" IdO="24" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.ManValue" IdO="24" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.A" IdO="24" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.B" IdO="24" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI06.RawDI" IdO="24" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI06.ManDI" IdO="24" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07" IdO="25" IdP="0" Type="3" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI07.Raw" IdO="25" IdP="1" Type="13" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI07.ElMin" IdO="25" IdP="2" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.ElMax" IdO="25" IdP="3" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.PhysMin" IdO="25" IdP="4" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.PhysMax" IdO="25" IdP="5" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.Mode" IdO="25" IdP="6" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.SensorType" IdO="25" IdP="7" Type="13" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.Filter" IdO="25" IdP="8" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.DI" IdO="25" IdP="9" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI07.Negation" IdO="25" IdP="10" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.ManMode" IdO="25" IdP="11" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.ManValue" IdO="25" IdP="12" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.A" IdO="25" IdP="13" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.B" IdO="25" IdP="14" Type="3" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AI07.RawDI" IdO="25" IdP="15" Type="8" Class="IoAIRangeRtd" ReadOnly="true" />
        <RefItem Name="IO.AI07.ManDI" IdO="25" IdP="16" Type="8" Class="IoAIRangeRtd" />
        <RefItem Name="IO.AO0" IdO="26" IdP="0" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO0.Raw" IdO="26" IdP="1" Type="13" Class="IoAORange" ReadOnly="true" />
        <RefItem Name="IO.AO0.ElMin" IdO="26" IdP="2" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO0.ElMax" IdO="26" IdP="3" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO0.PhysMin" IdO="26" IdP="4" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO0.PhysMax" IdO="26" IdP="5" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO0.Mode" IdO="26" IdP="6" Type="13" Class="IoAORange" />
        <RefItem Name="IO.AO0.ManMode" IdO="26" IdP="7" Type="8" Class="IoAORange" />
        <RefItem Name="IO.AO0.ManValue" IdO="26" IdP="8" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO1" IdO="27" IdP="0" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO1.Raw" IdO="27" IdP="1" Type="13" Class="IoAORange" ReadOnly="true" />
        <RefItem Name="IO.AO1.ElMin" IdO="27" IdP="2" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO1.ElMax" IdO="27" IdP="3" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO1.PhysMin" IdO="27" IdP="4" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO1.PhysMax" IdO="27" IdP="5" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO1.Mode" IdO="27" IdP="6" Type="13" Class="IoAORange" />
        <RefItem Name="IO.AO1.ManMode" IdO="27" IdP="7" Type="8" Class="IoAORange" />
        <RefItem Name="IO.AO1.ManValue" IdO="27" IdP="8" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO2" IdO="28" IdP="0" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO2.Raw" IdO="28" IdP="1" Type="13" Class="IoAORange" ReadOnly="true" />
        <RefItem Name="IO.AO2.ElMin" IdO="28" IdP="2" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO2.ElMax" IdO="28" IdP="3" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO2.PhysMin" IdO="28" IdP="4" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO2.PhysMax" IdO="28" IdP="5" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO2.Mode" IdO="28" IdP="6" Type="13" Class="IoAORange" />
        <RefItem Name="IO.AO2.ManMode" IdO="28" IdP="7" Type="8" Class="IoAORange" />
        <RefItem Name="IO.AO2.ManValue" IdO="28" IdP="8" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO3" IdO="29" IdP="0" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO3.Raw" IdO="29" IdP="1" Type="13" Class="IoAORange" ReadOnly="true" />
        <RefItem Name="IO.AO3.ElMin" IdO="29" IdP="2" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO3.ElMax" IdO="29" IdP="3" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO3.PhysMin" IdO="29" IdP="4" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO3.PhysMax" IdO="29" IdP="5" Type="3" Class="IoAORange" />
        <RefItem Name="IO.AO3.Mode" IdO="29" IdP="6" Type="13" Class="IoAORange" />
        <RefItem Name="IO.AO3.ManMode" IdO="29" IdP="7" Type="8" Class="IoAORange" />
        <RefItem Name="IO.AO3.ManValue" IdO="29" IdP="8" Type="3" Class="IoAORange" />
        <RefItem Name="IO.MtxDI" IdO="30" IdP="0" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDI" Comment="." />
        <RefItem Name="IO.MtxDI.Negation" IdO="30" IdP="1" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDI" />
        <RefItem Name="IO.MtxDI.ManMode" IdO="30" IdP="3" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDI" />
        <RefItem Name="IO.MtxDI.ManValue" IdO="30" IdP="4" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDI" />
        <RefItem Name="IO.MtxDI.Raw" IdO="30" IdP="6" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDI" ReadOnly="true" />
        <RefItem Name="IO.MtxDO" IdO="31" IdP="0" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDO" Comment="." />
        <RefItem Name="IO.MtxDO.ManMode" IdO="31" IdP="8" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDO" />
        <RefItem Name="IO.MtxDO.ManValue" IdO="31" IdP="9" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxDO" />
        <RefItem Name="IO.MtxAI" IdO="32" IdP="0" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" ReadOnly="true" Comment="." />
        <RefItem Name="IO.MtxAI.Raw" IdO="32" IdP="1" Type="14" DimRow="8" DimCol="1" Class="IoLocMtxAI" ReadOnly="true" />
        <RefItem Name="IO.MtxAI.ElMin" IdO="32" IdP="2" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.ElMax" IdO="32" IdP="3" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.PhysMin" IdO="32" IdP="4" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.PhysMax" IdO="32" IdP="5" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.Mode" IdO="32" IdP="6" Type="14" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.SensorType" IdO="32" IdP="7" Type="14" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.Filter" IdO="32" IdP="8" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.DI" IdO="32" IdP="9" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxAI" ReadOnly="true" />
        <RefItem Name="IO.MtxAI.Negation" IdO="32" IdP="10" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.ManMode" IdO="32" IdP="11" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.ManValue" IdO="32" IdP="12" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.A" IdO="32" IdP="13" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.B" IdO="32" IdP="14" Type="6" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAI.RawDI" IdO="32" IdP="15" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxAI" ReadOnly="true" />
        <RefItem Name="IO.MtxAI.ManDI" IdO="32" IdP="16" Type="20" DimRow="8" DimCol="1" Class="IoLocMtxAI" />
        <RefItem Name="IO.MtxAO" IdO="33" IdP="0" Type="6" DimRow="4" DimCol="1" Class="IoLocMtxAO" Comment="." />
        <RefItem Name="IO.MtxAO.Raw" IdO="33" IdP="1" Type="14" DimRow="4" DimCol="1" Class="IoLocMtxAO" ReadOnly="true" />
        <RefItem Name="IO.MtxAO.ElMin" IdO="33" IdP="2" Type="6" DimRow="4" DimCol="1" Class="IoLocMtxAO" />
        <RefItem Name="IO.MtxAO.ElMax" IdO="33" IdP="3" Type="6" DimRow="4" DimCol="1" Class="IoLocMtxAO" />
        <RefItem Name="IO.MtxAO.PhysMin" IdO="33" IdP="4" Type="6" DimRow="4" DimCol="1" Class="IoLocMtxAO" />
        <RefItem Name="IO.MtxAO.PhysMax" IdO="33" IdP="5" Type="6" DimRow="4" DimCol="1" Class="IoLocMtxAO" />
        <RefItem Name="IO.MtxAO.Mode" IdO="33" IdP="6" Type="14" DimRow="4" DimCol="1" Class="IoLocMtxAO" />
        <RefItem Name="IO.MtxAO.ManMode" IdO="33" IdP="7" Type="20" DimRow="4" DimCol="1" Class="IoLocMtxAO" />
        <RefItem Name="IO.MtxAO.ManValue" IdO="33" IdP="8" Type="6" DimRow="4" DimCol="1" Class="IoLocMtxAO" />
        <RefItem Name="DateTime.NowLong" IdO="34" IdP="0" Type="2" Class="DateTime" />
        <RefItem Name="DateTime.Day" IdO="34" IdP="1" Type="1" Class="DateTime" ReadOnly="true" />
        <RefItem Name="DateTime.Month" IdO="34" IdP="2" Type="1" Class="DateTime" ReadOnly="true" />
        <RefItem Name="DateTime.Year" IdO="34" IdP="3" Type="1" Class="DateTime" ReadOnly="true" />
        <RefItem Name="DateTime.Hour" IdO="34" IdP="4" Type="1" Class="DateTime" ReadOnly="true" />
        <RefItem Name="DateTime.Minute" IdO="34" IdP="5" Type="1" Class="DateTime" ReadOnly="true" />
        <RefItem Name="DateTime.Second" IdO="34" IdP="6" Type="1" Class="DateTime" ReadOnly="true" />
        <RefItem Name="DateTime.DayOfWeek" IdO="34" IdP="7" Type="1" Class="DateTime" ReadOnly="true" />
        <RefItem Name="DateTime.SecondsOfDay" IdO="34" IdP="8" Type="2" Class="DateTime" ReadOnly="true" />
        <RefItem Name="App.SystemLedActivity" IdO="35" IdP="0" Type="8" Class="App" />
        <RefItem Name="App.ColdStart" IdO="35" IdP="1" Type="8" Class="App" ReadOnly="true" />
        <RefItem Name="App.CurrentLanguage" IdO="35" IdP="2" Type="13" Class="App" />
        <RefItem Name="App.SystemPort" IdO="35" IdP="3" Type="13" Class="App" />
        <RefItem Name="App.StationLoad" IdO="35" IdP="4" Type="3" Class="App" ReadOnly="true" />
        <RefItem Name="WebServer.HttpPort" IdO="37" IdP="0" Type="13" Class="WebServer" />
        <RefItem Name="WebServer.HttpsPort" IdO="37" IdP="1" Type="13" Class="WebServer" />
        <RefItem Name="WebServer.FtpEnabled" IdO="37" IdP="2" Type="8" Class="WebServer" />
        <RefItem Name="WebServer.HttpEnabled" IdO="37" IdP="3" Type="8" Class="WebServer" />
        <RefItem Name="WebServer.StorageDevice" IdO="37" IdP="4" Type="13" Class="WebServer" />
        <RefItem Name="WebServer.FtpPort" IdO="37" IdP="5" Type="13" Class="WebServer" />
        <RefItem Name="ProcessInit.ExecutionTime" IdO="45" IdP="0" Type="3" Class="ProcessInit" />
        <RefItem Name="SysCom.Enabled" IdO="46" IdP="0" Type="8" Class="SysCom" />
        <RefItem Name="SysCom.Disconnected" IdO="46" IdP="1" Type="8" Class="SysCom" ReadOnly="true" />
        <RefItem Name="SysCom.Parity" IdO="46" IdP="2" Type="13" Class="SysCom" />
        <RefItem Name="SysCom.BaudRate" IdO="46" IdP="3" Type="15" Class="SysCom" />
        <RefItem Name="DateTimeSettings.TimeZone" IdO="47" IdP="0" Type="1" Class="DateTimeSettings" />
        <RefItem Name="DateTimeSettings.DaylightSavingTime" IdO="47" IdP="1" Type="8" Class="DateTimeSettings" />
        <RefItem Name="DateTimeSettings.NTPServer" IdO="47" IdP="2" Type="7" DimRow="1" DimCol="81" Class="DateTimeSettings" />
        <RefItem Name="DateTimeSettings.NTPSyncEnabled" IdO="47" IdP="3" Type="8" Class="DateTimeSettings" />
        <RefItem Name="DateTimeSettings.NTPLastSyncTime" IdO="47" IdP="4" Type="15" Class="DateTimeSettings" ReadOnly="true" />
        <RefItem Name="DateTimeSettings.NTPSyncInterval" IdO="47" IdP="5" Type="13" Class="DateTimeSettings" />
        <RefItem Name="SystemLogger.ActualIndex" IdO="48" IdP="0" Type="13" Class="Logger" />
        <RefItem Name="SystemLogger.Size" IdO="48" IdP="1" Type="2" Class="Logger" ReadOnly="true" />
        <RefItem Name="SystemLogger.Cell" IdO="48" IdP="2" Type="4" DimRow="1" DimCol="808" Class="Logger" />
        <RefItem Name="SystemLogger.Enabled" IdO="48" IdP="3" Type="8" Class="Logger" />
        <RefItem Name="BAT_BMS_CurrentRowInt" IdO="49" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_CurrentRowInt" IdO="50" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_STR_CurrentRowInt" IdO="51" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_STR_write_CurrentRowInt" IdO="52" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_write_CurrentRowInt" IdO="53" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="MR_BAT" IdO="54" IdP="0" Type="6" DimRow="1" DimCol="30" Class="" />
        <RefItem Name="MR_BAT_BMS" IdO="55" IdP="0" Type="6" DimRow="1" DimCol="44" Class="" />
        <RefItem Name="MR_BAT_BMS_SET" IdO="56" IdP="0" Type="6" DimRow="1" DimCol="3" Class="" />
        <RefItem Name="MR_BAT_SET" IdO="57" IdP="0" Type="6" DimRow="1" DimCol="10" Class="" />
        <RefItem Name="MR_BAT_STR" IdO="58" IdP="0" Type="6" DimRow="1" DimCol="47" Class="" />
        <RefItem Name="MR_BAT_STR_SET" IdO="59" IdP="0" Type="6" DimRow="1" DimCol="6" Class="" />
        <RefItem Name="MR_BAT_TOT" IdO="60" IdP="0" Type="6" DimRow="1" DimCol="10" Class="" />
        <RefItem Name="MS_BAT_BMS_COL_DEF" IdO="61" IdP="0" Type="19" DimRow="44" DimCol="80" Class="" />
        <RefItem Name="MS_BAT_BMS_SET_COL_DEF" IdO="62" IdP="0" Type="19" DimRow="3" DimCol="80" Class="" />
        <RefItem Name="MS_BAT_COL_DEF" IdO="63" IdP="0" Type="19" DimRow="30" DimCol="80" Class="" />
        <RefItem Name="MS_BAT_SET_COL_DEF" IdO="64" IdP="0" Type="19" DimRow="10" DimCol="80" Class="" />
        <RefItem Name="MS_BAT_STR_COL_DEF" IdO="65" IdP="0" Type="19" DimRow="47" DimCol="80" Class="" />
        <RefItem Name="MS_BAT_STR_SET_COL_DEF" IdO="66" IdP="0" Type="19" DimRow="6" DimCol="80" Class="" />
        <RefItem Name="MS_BAT_TOT_COL_DEF" IdO="67" IdP="0" Type="19" DimRow="10" DimCol="80" Class="" />
        <RefItem Name="BAT_read.Period" IdO="68" IdP="0" Type="15" Class="Process" />
        <RefItem Name="BAT_read.ExecutionTime" IdO="68" IdP="1" Type="3" Class="Process" ReadOnly="true" />
        <RefItem Name="BAT_read.ExecutionTimeMax" IdO="68" IdP="2" Type="3" Class="Process" />
        <RefItem Name="BAT_read.Offset" IdO="68" IdP="3" Type="15" Class="Process" />
        <RefItem Name="BAT_read.MaxPeriod" IdO="68" IdP="4" Type="15" Class="Process" />
        <RefItem Name="BAT_read.Avg10Period" IdO="68" IdP="5" Type="15" Class="Process" ReadOnly="true" />
        <RefItem Name="BAT_read.BAT_Vybijeni" IdO="69" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.Hodnota" IdO="70" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_read.BAT_Nabijeni" IdO="71" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.BAT_CelkovaKapacita" IdO="72" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.BAT_DostupnaKapacita" IdO="73" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.Hodnota_2" IdO="74" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_read.BAT_AktVykon" IdO="75" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.BAT_MaxNabVykon" IdO="76" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.BAT_MaxVybVykon" IdO="77" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.BAT_SoC" IdO="78" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_read.CountBAT_OK" IdO="79" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_write.Period" IdO="80" IdP="0" Type="15" Class="Process" />
        <RefItem Name="BAT_write.ExecutionTime" IdO="80" IdP="1" Type="3" Class="Process" ReadOnly="true" />
        <RefItem Name="BAT_write.ExecutionTimeMax" IdO="80" IdP="2" Type="3" Class="Process" />
        <RefItem Name="BAT_write.Offset" IdO="80" IdP="3" Type="15" Class="Process" />
        <RefItem Name="BAT_write.MaxPeriod" IdO="80" IdP="4" Type="15" Class="Process" />
        <RefItem Name="BAT_write.Avg10Period" IdO="80" IdP="5" Type="15" Class="Process" ReadOnly="true" />
        <RefItem Name="BAT_write.Hodnota" IdO="81" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_write.SoC_PoweCompensation" IdO="83" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="MR_LOK" IdO="84" IdP="0" Type="6" DimRow="1" DimCol="15" Class="" />
        <RefItem Name="MR_LOK_SET" IdO="85" IdP="0" Type="6" DimRow="1" DimCol="8" Class="" />
        <RefItem Name="BAT_Refu_Read_v3.ExecutionTime" IdO="86" IdP="0" Type="3" Class="Subroutine" ReadOnly="true" />
        <RefItem Name="BAT_Refu_Read_v3.ExecutionTimeMax" IdO="86" IdP="1" Type="3" Class="Subroutine" />
        <RefItem Name="BAT_Refu_Read_v3.Model_ID" IdO="87" IdP="0" Type="3" Class="" Var="true" Comment="SunSpec model ID (103 = Inverter Three Phase)" />
        <RefItem Name="BAT_Refu_Read_v3.Model_Length" IdO="88" IdP="0" Type="3" Class="" Var="true" Comment="Delka modelu v registrech" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Current" IdO="89" IdP="0" Type="3" Class="" Var="true" Comment="Celkovy AC proud (soucet fazi)" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Current_L1" IdO="90" IdP="0" Type="3" Class="" Var="true" Comment="Proud faze L1" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Current_L2" IdO="91" IdP="0" Type="3" Class="" Var="true" Comment="Proud faze L2" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Current_L3" IdO="92" IdP="0" Type="3" Class="" Var="true" Comment="Proud faze L3" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Voltage_AB" IdO="93" IdP="0" Type="3" Class="" Var="true" Comment="Napeti mezi fazemi AB" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Voltage_BC" IdO="94" IdP="0" Type="3" Class="" Var="true" Comment="Napeti mezi fazemi BC" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Voltage_CA" IdO="95" IdP="0" Type="3" Class="" Var="true" Comment="Napeti mezi fazemi CA" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Voltage_AN" IdO="96" IdP="0" Type="3" Class="" Var="true" Comment="Napeti faze A vuci N" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Voltage_BN" IdO="97" IdP="0" Type="3" Class="" Var="true" Comment="Napeti faze B vuci N" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Voltage_CN" IdO="98" IdP="0" Type="3" Class="" Var="true" Comment="Napeti faze C vuci N" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Power" IdO="99" IdP="0" Type="3" Class="" Var="true" Comment="Aktualni cinny vykon" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Frequency" IdO="100" IdP="0" Type="3" Class="" Var="true" Comment="Sitova frekvence" />
        <RefItem Name="BAT_Refu_Read_v3.AC_ApparentPower" IdO="101" IdP="0" Type="3" Class="" Var="true" Comment="Zdanlivy vykon" />
        <RefItem Name="BAT_Refu_Read_v3.AC_ReactivePower" IdO="102" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon" />
        <RefItem Name="BAT_Refu_Read_v3.AC_PowerFactor" IdO="103" IdP="0" Type="3" Class="" Var="true" Comment="Ucinik (Power Factor)" />
        <RefItem Name="BAT_Refu_Read_v3.AC_Energy_Wh" IdO="104" IdP="0" Type="3" Class="" Var="true" Comment="Celkova vyrobena energie" />
        <RefItem Name="BAT_Refu_Read_v3.DC_Current" IdO="105" IdP="0" Type="3" Class="" Var="true" Comment="DC proud" />
        <RefItem Name="BAT_Refu_Read_v3.DC_Voltage" IdO="106" IdP="0" Type="3" Class="" Var="true" Comment="DC napeti" />
        <RefItem Name="BAT_Refu_Read_v3.DC_Power" IdO="107" IdP="0" Type="3" Class="" Var="true" Comment="DC vykon" />
        <RefItem Name="BAT_Refu_Read_v3.Temp_Cabinet" IdO="108" IdP="0" Type="3" Class="" Var="true" Comment="Teplota rozvadece" />
        <RefItem Name="BAT_Refu_Read_v3.Temp_Heatsink" IdO="109" IdP="0" Type="3" Class="" Var="true" Comment="Teplota chladice" />
        <RefItem Name="BAT_Refu_Read_v3.OperatingState" IdO="110" IdP="0" Type="3" Class="" Var="true" Comment="1-Off, 3-Starting, 4-MPPT, 5-Throttled, 6-ShuttingDown, 7-Fault, 8-Standby, 9-Started" />
        <RefItem Name="BAT_Refu_Read_v3.SunSpec_ID" IdO="111" IdP="0" Type="3" Class="" Var="true" Comment="SunSpec identifikator (vzd. 0x53756E53 = 'SunS')" />
        <RefItem Name="BAT_Refu_Read_v3.Manufacturer_StringStart" IdO="112" IdP="0" Type="3" Class="" Var="true" Comment="Vyrobce (16 wordu, Arr1[0,2] az Arr1[0,17])" />
        <RefItem Name="BAT_Refu_Read_v3.Model_StringStart" IdO="113" IdP="0" Type="3" Class="" Var="true" Comment="Model zarizeni (16 wordu)" />
        <RefItem Name="BAT_Refu_Read_v3.Options_StringStart" IdO="114" IdP="0" Type="3" Class="" Var="true" Comment="Moznosti zarizeni (8 wordu)" />
        <RefItem Name="BAT_Refu_Read_v3.Version_StringStart" IdO="115" IdP="0" Type="3" Class="" Var="true" Comment="Verze firmware (8 wordu)" />
        <RefItem Name="BAT_Refu_Read_v3.SerialNumber_StringStart" IdO="116" IdP="0" Type="3" Class="" Var="true" Comment="Seriove cislo (16 wordu)" />
        <RefItem Name="BAT_Refu_Read_v3.DeviceAddress" IdO="117" IdP="0" Type="3" Class="" Var="true" Comment="Modbus adresa zarizeni" />
        <RefItem Name="BAT_Refu_Read_v3.Evt1_DIAG" IdO="118" IdP="0" Type="2" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.Temp_Transf" IdO="119" IdP="0" Type="3" Class="" Var="true" Comment="Teplota Transformátoru" />
        <RefItem Name="BAT_Refu_Read_v3.Temp_Other" IdO="120" IdP="0" Type="3" Class="" Var="true" Comment="Teplota ostatní" />
        <RefItem Name="BAT_Refu_Read_v3.Model_ID_120" IdO="121" IdP="0" Type="3" Class="" Var="true" Comment="ID modelu (120 = jmenovite parametry stridace)" />
        <RefItem Name="BAT_Refu_Read_v3.Model_Length_120" IdO="122" IdP="0" Type="3" Class="" Var="true" Comment="Delka modelu ve slovech" />
        <RefItem Name="BAT_Refu_Read_v3.WRtg" IdO="123" IdP="0" Type="3" Class="" Var="true" Comment="Jmenovity cinny vykon stridace" />
        <RefItem Name="BAT_Refu_Read_v3.VARtg" IdO="124" IdP="0" Type="3" Class="" Var="true" Comment="Jmenovity zdanlivy vykon stridace" />
        <RefItem Name="BAT_Refu_Read_v3.VArRtgQ1" IdO="125" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon ve kvadrantu 1 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.VArRtgQ2" IdO="126" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon ve kvadrantu 2 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.VArRtgQ3" IdO="127" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon ve kvadrantu 3 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.VArRtgQ4" IdO="128" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon ve kvadrantu 4 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.ARtg" IdO="129" IdP="0" Type="3" Class="" Var="true" Comment="Jmenovity RMS proud stridace (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.PFRtgQ1" IdO="130" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni ucinik v kvadrantu 1 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.PFRtgQ2" IdO="131" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni ucinik v kvadrantu 2 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.PFRtgQ3" IdO="132" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni ucinik v kvadrantu 3 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.PFRtgQ4" IdO="133" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni ucinik v kvadrantu 4 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.WHRtg" IdO="134" IdP="0" Type="3" Class="" Var="true" Comment="Jmenovita kapacita baterie (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.AhrRtg" IdO="135" IdP="0" Type="3" Class="" Var="true" Comment="Kapacita v amperhodinach (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.MaxChaRte" IdO="136" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni rychlost nabijeni (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.MaxDisChaRte" IdO="137" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni rychlost vybijeni (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.Model_ID_121" IdO="138" IdP="0" Type="1" Class="" Var="true" Comment="ID modelu (121 = nastaveni uloziste â€“ zakladni parametry)" />
        <RefItem Name="BAT_Refu_Read_v3.Model_Length_121" IdO="139" IdP="0" Type="1" Class="" Var="true" Comment="Delka modelu ve slovech" />
        <RefItem Name="BAT_Refu_Read_v3.WMax" IdO="140" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni celkovy vykon uloziste" />
        <RefItem Name="BAT_Refu_Read_v3.VRef" IdO="141" IdP="0" Type="3" Class="" Var="true" Comment="Referencni napeti" />
        <RefItem Name="BAT_Refu_Read_v3.VRefOfs" IdO="142" IdP="0" Type="3" Class="" Var="true" Comment="Ofset referencniho napeti" />
        <RefItem Name="BAT_Refu_Read_v3.VMax" IdO="143" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni napeti" />
        <RefItem Name="BAT_Refu_Read_v3.VMin" IdO="144" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni napeti" />
        <RefItem Name="BAT_Refu_Read_v3.VAMax" IdO="145" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni zdanlivy vykon" />
        <RefItem Name="BAT_Refu_Read_v3.VArMaxQ1" IdO="146" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni jalovy vykon Q1 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.VArMaxQ2" IdO="147" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni jalovy vykon Q2 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.VArMaxQ3" IdO="148" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni jalovy vykon Q3 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.VArMaxQ4" IdO="149" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni jalovy vykon Q4 (capability)" />
        <RefItem Name="BAT_Refu_Read_v3.WGra" IdO="150" IdP="0" Type="3" Class="" Var="true" Comment="Rychlost nabehu vykonu" />
        <RefItem Name="BAT_Refu_Read_v3.PFMinQ1" IdO="151" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni power factor Q1" />
        <RefItem Name="BAT_Refu_Read_v3.VArAvalPct" IdO="152" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon jako % z VA" />
        <RefItem Name="BAT_Refu_Read_v3.VArMaxPct" IdO="153" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon jako % z VAr max" />
        <RefItem Name="BAT_Refu_Read_v3.PFMinQ2" IdO="154" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni power factor Q2" />
        <RefItem Name="BAT_Refu_Read_v3.PFMinQ3" IdO="155" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni power factor Q3" />
        <RefItem Name="BAT_Refu_Read_v3.PFMinQ4" IdO="156" IdP="0" Type="3" Class="" Var="true" Comment="Minimalni power factor Q4" />
        <RefItem Name="BAT_Refu_Read_v3.VArAct" IdO="157" IdP="0" Type="1" Class="" Var="true" Comment="Rezim jaloveho vykonu" />
        <RefItem Name="BAT_Refu_Read_v3.ClcTotVA" IdO="158" IdP="0" Type="1" Class="" Var="true" Comment="Volba vypoctu zdanliveho vykonu" />
        <RefItem Name="BAT_Refu_Read_v3.MaxRmpRte" IdO="159" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni rampa aktivniho vykonu" />
        <RefItem Name="BAT_Refu_Read_v3.ECPNomHz" IdO="160" IdP="0" Type="3" Class="" Var="true" Comment="Jmenovita frekvence pro grid" />
        <RefItem Name="BAT_Refu_Read_v3.ConnPh" IdO="161" IdP="0" Type="1" Class="" Var="true" Comment="Pocet pripojenych fazi" />
        <RefItem Name="BAT_Refu_Read_v3.Model_ID_123" IdO="162" IdP="0" Type="1" Class="" Var="true" Comment="ID modelu (123 = Immediate Inverter Controls)" />
        <RefItem Name="BAT_Refu_Read_v3.Model_Length_123" IdO="163" IdP="0" Type="1" Class="" Var="true" Comment="Delka modelu ve slovech" />
        <RefItem Name="BAT_Refu_Read_v3.Conn_WinTms" IdO="164" IdP="0" Type="3" Class="" Var="true" Comment="Casove okno pro pripojeni/odpojeni (s)" />
        <RefItem Name="BAT_Refu_Read_v3.Conn_RvrtTms" IdO="165" IdP="0" Type="3" Class="" Var="true" Comment="Timeout revert pripojeni (s)" />
        <RefItem Name="BAT_Refu_Read_v3.Conn" IdO="166" IdP="0" Type="1" Class="" Var="true" Comment="Rizeni pripojeni (0=Disconnect, 1=Connect)" />
        <RefItem Name="BAT_Refu_Read_v3.WMaxLim_Ena" IdO="167" IdP="0" Type="1" Class="" Var="true" Comment="Povoleni limitu vykonu" />
        <RefItem Name="BAT_Refu_Read_v3.VArWMaxPct" IdO="168" IdP="0" Type="3" Class="" Var="true" Comment="Jalovy vykon jako % z WMax" />
        <RefItem Name="BAT_Refu_Read_v3.WMaxLimPct_WinTms" IdO="169" IdP="0" Type="3" Class="" Var="true" Comment="Casove okno zmeny limitu WMax (s)" />
        <RefItem Name="BAT_Refu_Read_v3.WMaxLimPct_RvrtTms" IdO="170" IdP="0" Type="3" Class="" Var="true" Comment="Timeout limitu WMax (s)" />
        <RefItem Name="BAT_Refu_Read_v3.A_Diagnostika" IdO="171" IdP="0" Type="1" Class="" Var="true" Comment="slouží pro diagnostiku jednotlivých STR" />
        <RefItem Name="BAT_Refu_Read_v3.WMaxLimPct_RmpTms" IdO="172" IdP="0" Type="3" Class="" Var="true" Comment="Cas rampy pro limit WMax (s)" />
        <RefItem Name="BAT_Refu_Read_v3.OutPFSet" IdO="173" IdP="0" Type="3" Class="" Var="true" Comment="Nastaveni vystupniho power factoru" />
        <RefItem Name="BAT_Refu_Read_v3.OutPFSet_WinTms" IdO="174" IdP="0" Type="3" Class="" Var="true" Comment="Casove okno pro zmenu PF (s)" />
        <RefItem Name="BAT_Refu_Read_v3.OutPFSet_RvrtTms" IdO="175" IdP="0" Type="3" Class="" Var="true" Comment="Timeout pro PF (s)" />
        <RefItem Name="BAT_Refu_Read_v3.OutPFSet_RmpTms" IdO="176" IdP="0" Type="3" Class="" Var="true" Comment="Cas rampy PF (s)" />
        <RefItem Name="BAT_Refu_Read_v3.OutPFSet_Ena" IdO="177" IdP="0" Type="3" Class="" Var="true" Comment="Povoleni rizeni PF" />
        <RefItem Name="BAT_Refu_Read_v3.VArPct_WinTms" IdO="178" IdP="0" Type="3" Class="" Var="true" Comment="Casove okno VAr (s)" />
        <RefItem Name="BAT_Refu_Read_v3.WMaxLimPct" IdO="179" IdP="0" Type="3" Class="" Var="true" Comment="Limit vykonu v % WRtg" />
        <RefItem Name="BAT_Refu_Read_v3.VArPct_RvrtTms" IdO="180" IdP="0" Type="3" Class="" Var="true" Comment="Timeout VAr (s)" />
        <RefItem Name="BAT_Refu_Read_v3.VArPct_RmpTms" IdO="181" IdP="0" Type="3" Class="" Var="true" Comment="Cas rampy VAr (s)" />
        <RefItem Name="BAT_Refu_Read_v3.VArPct_Mod" IdO="182" IdP="0" Type="1" Class="" Var="true" Comment="Mod jaloveho vykonu (0=WMax,1=VArMax,2=VA)" />
        <RefItem Name="BAT_Refu_Read_v3.VArPct_Ena" IdO="183" IdP="0" Type="1" Class="" Var="true" Comment="Povoleni rizeni jaloveho vykonu" />
        <RefItem Name="BAT_Refu_Read_v3.Model_ID_64800" IdO="184" IdP="0" Type="1" Class="" Var="true" Comment="ID modelu (64800 = rozsirene rizeni invertoru)" />
        <RefItem Name="BAT_Refu_Read_v3.Model_Length_64800" IdO="185" IdP="0" Type="1" Class="" Var="true" Comment="Delka modelu ve slovech" />
        <RefItem Name="BAT_Refu_Read_v3.LocRemCtl" IdO="186" IdP="0" Type="1" Class="" Var="true" Comment="Rezim rizeni: 0=local, 1=remote" />
        <RefItem Name="BAT_Refu_Read_v3.PCSSetOperation" IdO="187" IdP="0" Type="1" Class="" Var="true" Comment="Prikaz k provozu invertoru (0-Off, 1-On, 2-Standby, 3-Sleep)" />
        <RefItem Name="BAT_Refu_Read_v3.PCSAlarmReset" IdO="188" IdP="0" Type="1" Class="" Var="true" Comment="Reset alarmu invertoru" />
        <RefItem Name="BAT_Refu_Read_v3.MaxBatACha" IdO="189" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni nabijejici proud baterie (A)" />
        <RefItem Name="BAT_Refu_Read_v3.MaxBatADischa" IdO="190" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni vybijejici proud baterie (A)" />
        <RefItem Name="BAT_Refu_Read_v3.MaxA" IdO="191" IdP="0" Type="3" Class="" Var="true" Comment="Maximalni AC proud (A)" />
        <RefItem Name="BAT_Refu_Read_v3.MaxACur" IdO="192" IdP="0" Type="3" Class="" Var="true" Comment="Aktualni limit AC proudu (A)" />
        <RefItem Name="BAT_Refu_Read_v3.PCSHb" IdO="193" IdP="0" Type="3" Class="" Var="true" Comment="Heartbeat invertoru" />
        <RefItem Name="BAT_Refu_Read_v3.ControllerHb" IdO="194" IdP="0" Type="3" Class="" Var="true" Comment="Heartbeat controlleru" />
        <RefItem Name="BAT_Refu_Read_v3.Pad_64800" IdO="195" IdP="0" Type="1" Class="" Var="true" Comment="Padding registr" />
        <RefItem Name="BAT_Refu_Read_v3.RemoteMaxPower" IdO="196" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.BatteryVoltageLimit_Max" IdO="197" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.BatteryVoltageLimit_Min" IdO="198" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.ExternalHeartbeatTimeout" IdO="199" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.FW1" IdO="200" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.FW2" IdO="201" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.FW3" IdO="202" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.FW4" IdO="203" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Read_v3.CurrentRowInt" IdO="204" IdP="0" Type="1" Class="" Var="true" Comment="Interní proměnná pro převzetí Aktuálního řádku" />
        <RefItem Name="BAT_Refu_Read_v3.@Ground_fault" IdO="205" IdP="0" Type="8" Class="" />
        <RefItem Name="BAT_Refu_Read_v3.@dc_over_voltage" IdO="206" IdP="0" Type="8" Class="" Comment="DC over voltage" />
        <RefItem Name="BAT_Refu_Read_v3.@ac_disconnect_open" IdO="207" IdP="0" Type="8" Class="" Comment="AC disconnect open" />
        <RefItem Name="BAT_Refu_Read_v3.@dc_disconnect_open" IdO="208" IdP="0" Type="8" Class="" Comment="DC disconnect open" />
        <RefItem Name="BAT_Refu_Read_v3.@grid_shutdown" IdO="209" IdP="0" Type="8" Class="" Comment="Grid shutdown" />
        <RefItem Name="BAT_Refu_Read_v3.@cabinet_open" IdO="210" IdP="0" Type="8" Class="" Comment="Cabinet open" />
        <RefItem Name="BAT_Refu_Read_v3.@manual_shutdown" IdO="211" IdP="0" Type="8" Class="" Comment="Manual shutdown" />
        <RefItem Name="BAT_Refu_Read_v3.@over_temperature" IdO="212" IdP="0" Type="8" Class="" Comment="Over temperature" />
        <RefItem Name="BAT_Refu_Read_v3.@over_frequency" IdO="213" IdP="0" Type="8" Class="" Comment="Over frequency" />
        <RefItem Name="BAT_Refu_Read_v3.@under_frequency" IdO="214" IdP="0" Type="8" Class="" Comment="Under frequency" />
        <RefItem Name="BAT_Refu_Read_v3.@ac_over_voltage" IdO="215" IdP="0" Type="8" Class="" Comment="AC over voltage" />
        <RefItem Name="BAT_Refu_Read_v3.@ac_under_voltage" IdO="216" IdP="0" Type="8" Class="" Comment="AC under voltage" />
        <RefItem Name="BAT_Refu_Read_v3.@blown_string_fuse" IdO="217" IdP="0" Type="8" Class="" Comment="Blown string fuse" />
        <RefItem Name="BAT_Refu_Read_v3.@under_temperature" IdO="218" IdP="0" Type="8" Class="" Comment="Under temperature" />
        <RefItem Name="BAT_Refu_Read_v3.@memory_loss_or_comm_error" IdO="219" IdP="0" Type="8" Class="" Comment="Memory loss or comm error" />
        <RefItem Name="BAT_Refu_Read_v3.@hw_test_failure" IdO="220" IdP="0" Type="8" Class="" Comment="HW test failure" />
        <RefItem Name="BAT_Refu_Read_v3.@other_alarm" IdO="221" IdP="0" Type="8" Class="" Comment="Other alarm" />
        <RefItem Name="BAT_Refu_Read_v3.@other_warning" IdO="222" IdP="0" Type="8" Class="" Comment="Other warning" />
        <RefItem Name="BAT_Refu_Read_v3.ValChange1.Mode" IdO="223" IdP="1" Type="13" Class="ValChange" />
        <RefItem Name="BAT_Refu_Read_v3.ValChange1.Init" IdO="223" IdP="2" Type="13" Class="ValChange" />
        <RefItem Name="BAT_Refu_Read_v3.ValChange1.Out" IdO="223" IdP="3" Type="8" Class="ValChange" ReadOnly="true" />
        <RefItem Name="BAT_Refu_Read_v3.MB_Readed" IdO="224" IdP="0" Type="20" DimRow="1" DimCol="1" Class="" />
        <RefItem Name="BAT_Refu_Read_v3.MB_ZEROS" IdO="225" IdP="0" Type="20" DimRow="1" DimCol="1" Class="" />
        <RefItem Name="BAT_Refu_Read_v3.Evt1" IdO="226" IdP="0" Type="2" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Write_v2.ExecutionTime" IdO="227" IdP="0" Type="3" Class="Subroutine" ReadOnly="true" />
        <RefItem Name="BAT_Refu_Write_v2.ExecutionTimeMax" IdO="227" IdP="1" Type="3" Class="Subroutine" />
        <RefItem Name="BAT_Refu_Write_v2.ActivePowerTimeDuration" IdO="228" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Write_v2.CurrentRowInt" IdO="229" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Write_v2.TMP_PCSSetOperation" IdO="230" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Write_v2.TMP_enablePowerControl" IdO="231" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Write_v2.TMP_setMaxPower" IdO="232" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_Refu_Write_v2.TMP_SetPowerPct" IdO="233" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ExecutionTime" IdO="234" IdP="0" Type="3" Class="Subroutine" ReadOnly="true" />
        <RefItem Name="BMS_PylonTech.ExecutionTimeMax" IdO="234" IdP="1" Type="3" Class="Subroutine" />
        <RefItem Name="BMS_PylonTech.A_BMS_Korekce" IdO="235" IdP="0" Type="8" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.BasicStatus" IdO="236" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ProtectionInfo" IdO="237" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.AlarmInfo_DIAG" IdO="238" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.AlarmInfo" IdO="239" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.AlarmStatus2_DIAG" IdO="240" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.Napeti" IdO="241" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.Proud" IdO="242" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.BasicStatus_DIAG" IdO="243" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.Teplota" IdO="244" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SOC" IdO="245" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ErrorCode1_DIAG" IdO="246" IdP="0" Type="15" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SOE" IdO="247" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MaxVoltage" IdO="248" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MaxChargeCurrent" IdO="249" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MinVoltage" IdO="250" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MaxDisCurrent" IdO="251" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MaxCellVoltage" IdO="252" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MinCellVoltage" IdO="253" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMaxCellVoltage" IdO="254" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMinCellVoltage" IdO="255" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MaxCellTemp" IdO="256" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MinCellTemp" IdO="257" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMaxCellTemp" IdO="258" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMinCellTemp" IdO="259" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MaxModuleVoltage" IdO="260" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MinModuleVoltage" IdO="261" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMaxModuleVoltage" IdO="262" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMinModuleVoltage" IdO="263" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MaxModuleTemp" IdO="264" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.MinModuleTemp" IdO="265" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMaxModuleTemp" IdO="266" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SnOfMinModuleTemp" IdO="267" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ProtectionInfo_DIAG" IdO="268" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.SOH" IdO="269" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.RemainCap" IdO="270" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.TotalChargeCap" IdO="271" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.TotalDischargeCap" IdO="272" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.NumberOfCells" IdO="273" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.NumberOfModules" IdO="274" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ForceChargeRequest" IdO="275" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.BalanceChargeRequest" IdO="276" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ModulNominalVoltage" IdO="277" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ModulNominalCap" IdO="278" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.TerminalMaxTemp" IdO="279" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.TerminalMinTemp" IdO="280" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ModulePCBmaxTemp" IdO="281" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ModulePCBminTemp" IdO="282" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.AlarmStatus2" IdO="283" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.ValChange1.Mode" IdO="284" IdP="1" Type="13" Class="ValChange" />
        <RefItem Name="BMS_PylonTech.ValChange1.Init" IdO="284" IdP="2" Type="13" Class="ValChange" />
        <RefItem Name="BMS_PylonTech.ValChange1.Out" IdO="284" IdP="3" Type="8" Class="ValChange" ReadOnly="true" />
        <RefItem Name="BMS_PylonTech.CurrentRowInt" IdO="285" IdP="0" Type="1" Class="" Var="true" Comment="Interní proměnná pro převzetí Aktuálního řádku" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.ChargeReq" IdO="286" IdP="0" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.BalanceReq" IdO="286" IdP="1" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxChargeP" IdO="286" IdP="2" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxDischargeP" IdO="286" IdP="3" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxChargeI" IdO="286" IdP="4" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxDischargeI" IdO="286" IdP="5" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.BatU" IdO="286" IdP="6" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.BatI" IdO="286" IdP="7" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MinModuleU" IdO="286" IdP="8" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxModuleU" IdO="286" IdP="9" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MinCellU" IdO="286" IdP="10" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxCellU" IdO="286" IdP="11" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MinBMS_U" IdO="286" IdP="12" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxBMS_U" IdO="286" IdP="13" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.IN_BalanceReq" IdO="286" IdP="14" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.IN_ChargeReq" IdO="286" IdP="15" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.CellCap" IdO="286" IdP="16" Type="3" Class="fb_BMS_Control" Comment="v Ah" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MinCellT" IdO="286" IdP="17" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.fb_BMS_Control.MaxCellT" IdO="286" IdP="18" Type="3" Class="fb_BMS_Control" />
        <RefItem Name="BMS_PylonTech.ErrorCode1" IdO="306" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BMS_PylonTech.A_Diagnostika" IdO="307" IdP="0" Type="1" Class="" Var="true" Comment="slouží pro diagnostiku jednotlivých STR" />
        <RefItem Name="BMS_PylonTech.@fan_warn" IdO="308" IdP="0" Type="8" Class="" Comment="Ventilator porucha" />
        <RefItem Name="BMS_PylonTech.@sleep" IdO="309" IdP="0" Type="8" Class="" Comment="Uloziste ve spanku" />
        <RefItem Name="BMS_PylonTech.@discharging" IdO="310" IdP="0" Type="8" Class="" Comment="Probihajici vybijeni" />
        <RefItem Name="BMS_PylonTech.@charging" IdO="311" IdP="0" Type="8" Class="" Comment="Probihajici nabijeni" />
        <RefItem Name="BMS_PylonTech.@idle" IdO="312" IdP="0" Type="8" Class="" Comment="System v klidu" />
        <RefItem Name="BMS_PylonTech.@temp_alarm" IdO="313" IdP="0" Type="8" Class="" Comment="Teplotni alarm aktivni" />
        <RefItem Name="BMS_PylonTech.@curr_alarm" IdO="314" IdP="0" Type="8" Class="" Comment="Proudovy alarm aktivni" />
        <RefItem Name="BMS_PylonTech.@volt_alarm" IdO="315" IdP="0" Type="8" Class="" Comment="Napetovy alarm aktivni" />
        <RefItem Name="BMS_PylonTech.@temp_prot" IdO="316" IdP="0" Type="8" Class="" Comment="Teplotni ochrana aktivni" />
        <RefItem Name="BMS_PylonTech.@volt_prot" IdO="317" IdP="0" Type="8" Class="" Comment="Napetova ochrana aktivni" />
        <RefItem Name="BMS_PylonTech.@curr_prot" IdO="318" IdP="0" Type="8" Class="" Comment="Proudova ochrana aktivni" />
        <RefItem Name="BMS_PylonTech.@sys_error" IdO="319" IdP="0" Type="8" Class="" Comment="Systemova chyba" />
        <RefItem Name="BMS_PylonTech.@cell_uv2" IdO="320" IdP="0" Type="8" Class="" Comment="Ochrana - clanek pod napetim (uroven 2)" />
        <RefItem Name="BMS_PylonTech.@mod_ov" IdO="321" IdP="0" Type="8" Class="" Comment="Ochrana - modul prepeti" />
        <RefItem Name="BMS_PylonTech.@mod_uv" IdO="322" IdP="0" Type="8" Class="" Comment="Ochrana - modul pod napetim" />
        <RefItem Name="BMS_PylonTech.@mod_temp_hi" IdO="323" IdP="0" Type="8" Class="" Comment="Ochrana - vysoka teplota modulu" />
        <RefItem Name="BMS_PylonTech.@short_circ" IdO="324" IdP="0" Type="8" Class="" Comment="Ochrana - zkrat" />
        <RefItem Name="BMS_PylonTech.@dis_oc" IdO="325" IdP="0" Type="8" Class="" Comment="Ochrana - vybijeci pretizeni" />
        <RefItem Name="BMS_PylonTech.@chg_oc" IdO="326" IdP="0" Type="8" Class="" Comment="Ochrana - nabijeci pretizeni" />
        <RefItem Name="BMS_PylonTech.@dis_temp_hi" IdO="327" IdP="0" Type="8" Class="" Comment="Ochrana - vysoka teplota pri vybijeni" />
        <RefItem Name="BMS_PylonTech.@dis_temp_lo" IdO="328" IdP="0" Type="8" Class="" Comment="Ochrana - nizka teplota pri vybijeni" />
        <RefItem Name="BMS_PylonTech.@chg_temp_hi" IdO="329" IdP="0" Type="8" Class="" Comment="Ochrana - vysoka teplota pri nabijeni" />
        <RefItem Name="BMS_PylonTech.@chg_temp_lo" IdO="330" IdP="0" Type="8" Class="" Comment="Ochrana - nizka teplota pri nabijeni" />
        <RefItem Name="BMS_PylonTech.@pack_ov" IdO="331" IdP="0" Type="8" Class="" Comment="Ochrana - celkove prepeti" />
        <RefItem Name="BMS_PylonTech.@pack_uv" IdO="332" IdP="0" Type="8" Class="" Comment="Ochrana - celkove podpeti" />
        <RefItem Name="BMS_PylonTech.@cell_ov" IdO="333" IdP="0" Type="8" Class="" Comment="Ochrana - prepeti clanku" />
        <RefItem Name="BMS_PylonTech.@cell_uv" IdO="334" IdP="0" Type="8" Class="" Comment="Ochrana - podpeti clanku" />
        <RefItem Name="BMS_PylonTech.@term_temp" IdO="335" IdP="0" Type="8" Class="" Comment="Alarm - teplota na svorkach" />
        <RefItem Name="BMS_PylonTech.@mod_ov_warn" IdO="336" IdP="0" Type="8" Class="" Comment="Alarm - modul prepeti" />
        <RefItem Name="BMS_PylonTech.@mod_uv_warn" IdO="337" IdP="0" Type="8" Class="" Comment="Alarm - modul podpeti" />
        <RefItem Name="BMS_PylonTech.@mod_temp_warn" IdO="338" IdP="0" Type="8" Class="" Comment="Alarm - vysoka teplota modulu" />
        <RefItem Name="BMS_PylonTech.@bms_temp_warn" IdO="339" IdP="0" Type="8" Class="" Comment="Alarm - vysoka teplota BMS" />
        <RefItem Name="BMS_PylonTech.@leak_warn" IdO="340" IdP="0" Type="8" Class="" Comment="Alarm - unikejici proud" />
        <RefItem Name="BMS_PylonTech.@dis_oc_warn" IdO="341" IdP="0" Type="8" Class="" Comment="Alarm - vybijeci pretizeni" />
        <RefItem Name="BMS_PylonTech.@chg_oc_warn" IdO="342" IdP="0" Type="8" Class="" Comment="Alarm - nabijeci pretizeni" />
        <RefItem Name="BMS_PylonTech.@dis_temp_hi_warn" IdO="343" IdP="0" Type="8" Class="" Comment="Alarm - vysoka teplota pri vybijeni" />
        <RefItem Name="BMS_PylonTech.@dis_temp_lo_warn" IdO="344" IdP="0" Type="8" Class="" Comment="Alarm - nizka teplota pri vybijeni" />
        <RefItem Name="BMS_PylonTech.@chg_temp_hi_warn" IdO="345" IdP="0" Type="8" Class="" Comment="Alarm - vysoka teplota pri nabijeni" />
        <RefItem Name="BMS_PylonTech.@chg_temp_lo_warn" IdO="346" IdP="0" Type="8" Class="" Comment="Alarm - nizka teplota pri nabijeni" />
        <RefItem Name="BMS_PylonTech.@pack_ov_warn" IdO="347" IdP="0" Type="8" Class="" Comment="Alarm - celkove prepeti" />
        <RefItem Name="BMS_PylonTech.@pack_uv_warn" IdO="348" IdP="0" Type="8" Class="" Comment="Alarm - celkove podpeti" />
        <RefItem Name="BMS_PylonTech.@cell_ov_warn" IdO="349" IdP="0" Type="8" Class="" Comment="Alarm - prepeti clanku" />
        <RefItem Name="BMS_PylonTech.@cell_uv_warn" IdO="350" IdP="0" Type="8" Class="" Comment="Alarm - podpeti clanku" />
        <RefItem Name="BMS_PylonTech.@sys_abuse" IdO="351" IdP="0" Type="8" Class="" Comment="System - nespravne pouziti" />
        <RefItem Name="BMS_PylonTech.@bms_disconnect" IdO="352" IdP="0" Type="8" Class="" Comment="BMS odpojena" />
        <RefItem Name="BMS_PylonTech.@bms_commlost" IdO="353" IdP="0" Type="8" Class="" Comment="Ztrata komunikace s BMS" />
        <RefItem Name="BMS_PylonTech.@temp_imbalance" IdO="354" IdP="0" Type="8" Class="" Comment="Nerovnomerna teplota clanku" />
        <RefItem Name="BMS_PylonTech.@volt_imbalance" IdO="355" IdP="0" Type="8" Class="" Comment="Nerovnomerne napeti clanku" />
        <RefItem Name="BMS_PylonTech.@batt_lock" IdO="356" IdP="0" Type="8" Class="" Comment="Chyba - zamknuta baterie" />
        <RefItem Name="BMS_PylonTech.@comm_ext" IdO="357" IdP="0" Type="8" Class="" Comment="Chyba - externi komunikace" />
        <RefItem Name="BMS_PylonTech.@curr_ic" IdO="358" IdP="0" Type="8" Class="" Comment="Chyba - snimac proudu" />
        <RefItem Name="BMS_PylonTech.@leak_curr" IdO="359" IdP="0" Type="8" Class="" Comment="Chyba - unik proudu" />
        <RefItem Name="BMS_PylonTech.@all_bms_off" IdO="360" IdP="0" Type="8" Class="" Comment="Chyba - vsechny BMS offline" />
        <RefItem Name="BMS_PylonTech.@bmu_bus" IdO="361" IdP="0" Type="8" Class="" Comment="Chyba - interni sbernice BMU" />
        <RefItem Name="BMS_PylonTech.@mbms_comm" IdO="362" IdP="0" Type="8" Class="" Comment="Chyba - MBMS &lt;-&gt; BMS komunikace" />
        <RefItem Name="BMS_PylonTech.@selftest_init" IdO="363" IdP="0" Type="8" Class="" Comment="Chyba - inicializace pri startu" />
        <RefItem Name="BMS_PylonTech.@selftest_coulomb" IdO="364" IdP="0" Type="8" Class="" Comment="Chyba - coulombuv citac" />
        <RefItem Name="BMS_PylonTech.@selftest_serial" IdO="365" IdP="0" Type="8" Class="" Comment="Chyba - chyba poctu clanku" />
        <RefItem Name="BMS_PylonTech.@emerg_stop" IdO="366" IdP="0" Type="8" Class="" Comment="Chyba - nouzove zastaveni" />
        <RefItem Name="BMS_PylonTech.@insulation" IdO="367" IdP="0" Type="8" Class="" Comment="Chyba - izolace" />
        <RefItem Name="BMS_PylonTech.@safety_chk" IdO="368" IdP="0" Type="8" Class="" Comment="Chyba - bezpecnostni kontrola" />
        <RefItem Name="BMS_PylonTech.@selftest_volt" IdO="369" IdP="0" Type="8" Class="" Comment="Chyba - napetova kontrola" />
        <RefItem Name="BMS_PylonTech.@bms_bus" IdO="370" IdP="0" Type="8" Class="" Comment="Chyba - interni sbernice BMS" />
        <RefItem Name="BMS_PylonTech.@bmic" IdO="371" IdP="0" Type="8" Class="" Comment="Chyba - BMIC" />
        <RefItem Name="BMS_PylonTech.@shutdown_circuit" IdO="372" IdP="0" Type="8" Class="" Comment="Chyba - vypinaci obvod" />
        <RefItem Name="BMS_PylonTech.@batt_damage" IdO="373" IdP="0" Type="8" Class="" Comment="Chyba - poskozena baterie" />
        <RefItem Name="BMS_PylonTech.@relay" IdO="374" IdP="0" Type="8" Class="" Comment="Chyba - rele" />
        <RefItem Name="BMS_PylonTech.@input_reverse" IdO="375" IdP="0" Type="8" Class="" Comment="Chyba - prepolovani" />
        <RefItem Name="BMS_PylonTech.@input_ov" IdO="376" IdP="0" Type="8" Class="" Comment="Chyba - prepeti na vstupu" />
        <RefItem Name="BAT_Assignment.ExecutionTime" IdO="377" IdP="0" Type="3" Class="Subroutine" ReadOnly="true" />
        <RefItem Name="BAT_Assignment.ExecutionTimeMax" IdO="377" IdP="1" Type="3" Class="Subroutine" />
        <RefItem Name="BAT_Assignment.TimerForBMSFault.Delay" IdO="378" IdP="0" Type="15" Class="TimerOn" />
        <RefItem Name="BAT_Assignment.TimerForBMSFault.ElapsedTime" IdO="378" IdP="1" Type="15" Class="TimerOn" ReadOnly="true" />
        <RefItem Name="BAT_Assignment.TimerForBMSFault.Out" IdO="378" IdP="2" Type="8" Class="TimerOn" ReadOnly="true" />
        <RefItem Name="BAT_Assignment.TimerForBMSFault.Input" IdO="378" IdP="3" Type="8" Class="TimerOn" />
        <RefItem Name="BAT_Assignment.AktualniCinny" IdO="379" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AktualniCinnyL1" IdO="380" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AktualniCinnyL2" IdO="381" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AktualniCinnyL3" IdO="382" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AktualniJalovy" IdO="383" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AktualniJalovyL1" IdO="384" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AktualniJalovyL2" IdO="385" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AktualniJalovyL3" IdO="386" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AlarmStatus" IdO="387" IdP="0" Type="15" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Ucinik" IdO="388" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Nabijeni" IdO="389" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Vybijeni" IdO="390" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Vykon_DC" IdO="391" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Proud_DC" IdO="392" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.MaxNabijeciVykon" IdO="393" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.MaxVybijeciVykon" IdO="394" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Evt1" IdO="395" IdP="0" Type="15" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.MaxVykon_STR" IdO="396" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.SoC" IdO="397" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.SoH" IdO="398" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.RemainCap" IdO="399" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.TotalDodavka" IdO="400" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.TotalOdber" IdO="401" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.NuceneNabijeni" IdO="402" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.BalancingRequest" IdO="403" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.OperationStatus" IdO="404" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.RizeniP_Povoleno" IdO="405" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.RizeniQ_Povoleno" IdO="406" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.RizeniP" IdO="407" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.RizeniQ" IdO="408" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.NabijeciVykon_BMS" IdO="409" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.VybijeciVykon_BMS" IdO="410" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Count_STR" IdO="411" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Count_BMS" IdO="412" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Count_STR_OK" IdO="413" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Count_BMS_OK" IdO="414" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.CurrentRowInt" IdO="415" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Napeti_DC" IdO="416" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Count_BMS_OFF" IdO="417" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.Hodnota" IdO="418" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AlarmInfo" IdO="419" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AlarmStatus2" IdO="420" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.ProtectionInfo" IdO="421" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.AlarmStatus_DIAG" IdO="422" IdP="0" Type="15" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.BasicStatus" IdO="423" IdP="0" Type="13" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.ErrorCode1" IdO="424" IdP="0" Type="15" Class="" Var="true" />
        <RefItem Name="BAT_Assignment.A_Diagnostika" IdO="425" IdP="0" Type="1" Class="" Var="true" Comment="slouží pro diagnostiku jednotlivých STR" />
        <RefItem Name="BAT_Assignment.@inv_ground" IdO="426" IdP="0" Type="8" Class="" Comment="Uzemnovaci chyba (Ground fault)" />
        <RefItem Name="BAT_Assignment.@inv_voltage" IdO="427" IdP="0" Type="8" Class="" Comment="Napetove chyby (DC/AC over/under voltage)" />
        <RefItem Name="BAT_Assignment.@inv_disconnect" IdO="428" IdP="0" Type="8" Class="" Comment="Otevrene odpojovace (AC/DC disconnect)" />
        <RefItem Name="BAT_Assignment.@inv_shutdown" IdO="429" IdP="0" Type="8" Class="" Comment="Odstaveni (manualni, grid, cabinet open)" />
        <RefItem Name="BAT_Assignment.@inv_temp" IdO="430" IdP="0" Type="8" Class="" Comment="Teplotni chyby (Over/Under temperature)" />
        <RefItem Name="BAT_Assignment.@inv_freq" IdO="431" IdP="0" Type="8" Class="" Comment="Frekvencni chyby (Over/Under frequency)" />
        <RefItem Name="BAT_Assignment.@inv_comm" IdO="432" IdP="0" Type="8" Class="" Comment="Chyba komunikace / pameti / HW test" />
        <RefItem Name="BAT_Assignment.@inv_other" IdO="433" IdP="0" Type="8" Class="" Comment="Ostatni alarmy a varovani" />
        <RefItem Name="BAT_Assignment.@bms_comm" IdO="434" IdP="0" Type="8" Class="" Comment="Ztrata komunikace s BMS" />
        <RefItem Name="BAT_Assignment.@bms_imbalance" IdO="435" IdP="0" Type="8" Class="" Comment="Nerovnovaha clanku (napeti/teplota)" />
        <RefItem Name="BAT_Assignment.@bms_uvprot" IdO="436" IdP="0" Type="8" Class="" Comment="Podnapetova ochrana" />
        <RefItem Name="BAT_Assignment.@bms_ovprot" IdO="437" IdP="0" Type="8" Class="" Comment="Prepetova ochrana" />
        <RefItem Name="BAT_Assignment.@bms_ocprot" IdO="438" IdP="0" Type="8" Class="" Comment="Proudova ochrana" />
        <RefItem Name="BAT_Assignment.@bms_temp_lo" IdO="439" IdP="0" Type="8" Class="" Comment="Ochrana - nizka teplota" />
        <RefItem Name="BAT_Assignment.@bms_temp_hi" IdO="440" IdP="0" Type="8" Class="" Comment="Ochrana - vysoka teplota" />
        <RefItem Name="BAT_Assignment.@bms_syserr" IdO="441" IdP="0" Type="8" Class="" Comment="Systemova chyba BMS" />
        <RefItem Name="BAT_Assignment.@bms_comperr" IdO="442" IdP="0" Type="8" Class="" Comment="Komunikacni/inicializacni chyba" />
        <RefItem Name="BAT_Assignment.@bms_measerr" IdO="443" IdP="0" Type="8" Class="" Comment="Chyba mereni proudu / leakage" />
        <RefItem Name="BAT_Assignment.@bms_emstop" IdO="444" IdP="0" Type="8" Class="" Comment="Nouzove vypnuti" />
        <RefItem Name="BAT_Assignment.@bms_isofail" IdO="445" IdP="0" Type="8" Class="" Comment="Chyba izolace" />
        <RefItem Name="BAT_Assignment.@bms_damage" IdO="446" IdP="0" Type="8" Class="" Comment="Poskozena baterie" />
        <RefItem Name="BAT_Assignment.@bms_relay" IdO="447" IdP="0" Type="8" Class="" Comment="Chyba rele" />
        <RefItem Name="BAT_Assignment.@bms_leakwarn" IdO="448" IdP="0" Type="8" Class="" Comment="Alarm - unik proudu" />
        <RefItem Name="BAT_Assignment.@bms_termtemp" IdO="449" IdP="0" Type="8" Class="" Comment="Alarm - teplota svorek" />
        <RefItem Name="BAT_to_STR_write.ExecutionTime" IdO="450" IdP="0" Type="3" Class="Subroutine" ReadOnly="true" />
        <RefItem Name="BAT_to_STR_write.ExecutionTimeMax" IdO="450" IdP="1" Type="3" Class="Subroutine" />
        <RefItem Name="BAT_to_STR_write.CurrentRowInt" IdO="451" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_to_STR_write.TMP_Rezim" IdO="452" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_to_STR_write.TMP_Vykon" IdO="453" IdP="0" Type="3" Class="" Var="true" />
        <RefItem Name="BAT_to_STR_write.Hodnota" IdO="454" IdP="0" Type="1" Class="" Var="true" />
        <RefItem Name="BAT_to_STR_write.PowerDelivered" IdO="455" IdP="0" Type="8" Class="" Var="true" />
        <RefItem Name="BAT_to_STR_write.VykonHyst.LowerLimit" IdO="456" IdP="0" Type="3" Class="Hyst2L" />
        <RefItem Name="BAT_to_STR_write.VykonHyst.UpperLimit" IdO="456" IdP="1" Type="3" Class="Hyst2L" />
        <RefItem Name="BAT_to_STR_write.VykonHyst.In" IdO="456" IdP="2" Type="3" Class="Hyst2L" />
        <RefItem Name="BAT_to_STR_write.VykonHyst.Out" IdO="456" IdP="3" Type="8" Class="Hyst2L" ReadOnly="true" />
        <RefItem Name="BAT.HostName" IdO="82" IdP="0" Type="7" DimRow="1" DimCol="81" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="BAT.RemotePort" IdO="82" IdP="1" Type="13" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="BAT.LocalPort" IdO="82" IdP="2" Type="13" Class="ModbusMasterTCP" ReadOnly="true" Var="true" />
        <RefItem Name="BAT.TCPStatus" IdO="82" IdP="3" Type="13" Class="ModbusMasterTCP" ReadOnly="true" Var="true" />
        <RefItem Name="BAT.OKMessages" IdO="82" IdP="4" Type="2" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="BAT.OKConnections" IdO="82" IdP="5" Type="13" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="BAT.FailConnections" IdO="82" IdP="6" Type="13" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="BAT.ErrMessages" IdO="82" IdP="7" Type="2" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="BAT.REFUv2.Enabled" IdO="457" IdP="0" Type="8" Class="ModbusDeviceTCP" />
        <RefItem Name="BAT.REFUv2.Arr1.ComState" IdO="458" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr1.LastError" IdO="458" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr1" IdO="458" IdP="0" Type="4" DimRow="1" DimCol="2" Class="" />
        <RefItem Name="BAT.REFUv2.Arr103.ComState" IdO="459" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr103.LastError" IdO="459" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr103" IdO="459" IdP="0" Type="4" DimRow="1" DimCol="42" Class="" />
        <RefItem Name="BAT.REFUv2.Arr120.ComState" IdO="460" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr120.LastError" IdO="460" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr120" IdO="460" IdP="0" Type="4" DimRow="1" DimCol="28" Class="" />
        <RefItem Name="BAT.REFUv2.Arr121.ComState" IdO="461" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr121.LastError" IdO="461" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr121" IdO="461" IdP="0" Type="4" DimRow="1" DimCol="32" Class="" />
        <RefItem Name="BAT.REFUv2.Arr123.ComState" IdO="462" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr123.LastError" IdO="462" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr123" IdO="462" IdP="0" Type="4" DimRow="1" DimCol="26" Class="" />
        <RefItem Name="BAT.REFUv2.Arr64800.ComState" IdO="463" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr64800.LastError" IdO="463" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.Arr64800" IdO="463" IdP="0" Type="4" DimRow="1" DimCol="14" Class="" />
        <RefItem Name="BAT.REFUv2.RemoteMaxPower.ComState" IdO="464" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.RemoteMaxPower.LastError" IdO="464" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.RemoteMaxPower" IdO="464" IdP="0" Type="13" Class="" Comment="zpětná informace o řízení výkonu" />
        <RefItem Name="BAT.REFUv2.ArrFW.ComState" IdO="465" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.ArrFW.LastError" IdO="465" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.ArrFW" IdO="465" IdP="0" Type="14" DimRow="1" DimCol="4" Class="" />
        <RefItem Name="BAT.REFUv2.setPowerPct.ComState" IdO="466" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.setPowerPct.LastError" IdO="466" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.setPowerPct" IdO="466" IdP="0" Type="1" Class="" Comment="% of MaxPower" />
        <RefItem Name="BAT.REFUv2.ArrRO.ComState" IdO="467" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.ArrRO.LastError" IdO="467" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.ArrRO" IdO="467" IdP="0" Type="16" DimRow="1" DimCol="3" Class="" />
        <RefItem Name="BAT.REFUv2.PowerPctTimeoutPeriod.ComState" IdO="468" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.PowerPctTimeoutPeriod.LastError" IdO="468" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.PowerPctTimeoutPeriod" IdO="468" IdP="0" Type="13" Class="" Comment="timeout pro zadaný výkon,  s" />
        <RefItem Name="BAT.REFUv2.HeartBeatWrite.ComState" IdO="469" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.HeartBeatWrite.LastError" IdO="469" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.HeartBeatWrite" IdO="469" IdP="0" Type="13" Class="" Comment="zapisovat inkrementaci pro heartbeat" />
        <RefItem Name="BAT.REFUv2.resetAlarm.ComState" IdO="470" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.resetAlarm.LastError" IdO="470" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.resetAlarm" IdO="470" IdP="0" Type="13" Class="" Comment="1: reset alarmu" />
        <RefItem Name="BAT.REFUv2.enablePowerControl.ComState" IdO="471" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.enablePowerControl.LastError" IdO="471" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.enablePowerControl" IdO="471" IdP="0" Type="13" Class="" Comment="0: dis, 1: enable" />
        <RefItem Name="BAT.REFUv2.setMaxPower.ComState" IdO="472" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.setMaxPower.LastError" IdO="472" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.setMaxPower" IdO="472" IdP="0" Type="13" Class="" />
        <RefItem Name="BAT.REFUv2.PCSSetOperation.ComState" IdO="473" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.PCSSetOperation.LastError" IdO="473" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.PCSSetOperation" IdO="473" IdP="0" Type="13" Class="" Comment="1: start, 2: stop, 3: standby, 4: exit-standby" />
        <RefItem Name="BAT.REFUv2.ModbusID.ComState" IdO="474" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.ModbusID.LastError" IdO="474" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.ModbusID" IdO="474" IdP="0" Type="13" Class="" />
        <RefItem Name="BAT.REFUv2.AC_Power.ComState" IdO="475" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.AC_Power.LastError" IdO="475" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.AC_Power" IdO="475" IdP="0" Type="4" DimRow="1" DimCol="2" Class="" />
        <RefItem Name="BAT.REFUv2.WRtg.ComState" IdO="476" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.WRtg.LastError" IdO="476" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.WRtg" IdO="476" IdP="0" Type="14" DimRow="1" DimCol="2" Class="" />
        <RefItem Name="BAT.REFUv2.PCSHb.ComState" IdO="477" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.PCSHb.LastError" IdO="477" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="BAT.REFUv2.PCSHb" IdO="477" IdP="0" Type="13" Class="" />
        <RefItem Name="PylonT.HostName" IdO="478" IdP="0" Type="7" DimRow="1" DimCol="81" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="PylonT.RemotePort" IdO="478" IdP="1" Type="13" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="PylonT.LocalPort" IdO="478" IdP="2" Type="13" Class="ModbusMasterTCP" ReadOnly="true" Var="true" />
        <RefItem Name="PylonT.TCPStatus" IdO="478" IdP="3" Type="13" Class="ModbusMasterTCP" ReadOnly="true" Var="true" />
        <RefItem Name="PylonT.OKMessages" IdO="478" IdP="4" Type="2" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="PylonT.OKConnections" IdO="478" IdP="5" Type="13" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="PylonT.FailConnections" IdO="478" IdP="6" Type="13" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="PylonT.ErrMessages" IdO="478" IdP="7" Type="2" Class="ModbusMasterTCP" Var="true" />
        <RefItem Name="PylonT.BMS.Enabled" IdO="479" IdP="0" Type="8" Class="ModbusDeviceTCP" />
        <RefItem Name="PylonT.BMS.ArrMBMS.ComState" IdO="480" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="PylonT.BMS.ArrMBMS.LastError" IdO="480" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="PylonT.BMS.ArrMBMS" IdO="480" IdP="0" Type="14" DimRow="1" DimCol="74" Class="" />
        <RefItem Name="PylonT.BMS.ArrPile2.ComState" IdO="481" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="PylonT.BMS.ArrPile2.LastError" IdO="481" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="PylonT.BMS.ArrPile2" IdO="481" IdP="0" Type="14" DimRow="1" DimCol="74" Class="" />
        <RefItem Name="PylonT.BMS.ArrPile1.ComState" IdO="482" IdP="2" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="PylonT.BMS.ArrPile1.LastError" IdO="482" IdP="3" Type="13" Class="" ReadOnly="true" />
        <RefItem Name="PylonT.BMS.ArrPile1" IdO="482" IdP="0" Type="14" DimRow="1" DimCol="74" Class="" />
        <RefItem Name="MR_DIAG" IdO="483" IdP="0" Type="6" DimRow="1" DimCol="200" Class="" />
      </ReferenceId>
      <DteData>
        <EndOfLineCR>False</EndOfLineCR>
        <EndOfLineLF>False</EndOfLineLF>
        <Increment>10</Increment>
        <Formaty>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>0</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="OK" />
            <Text Lang="cs-CZ" Text="Žádná chyba" />
            <Comment_cs>OK</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="Db" />
            <Text Lang="cs-CZ" Text="WID %0i neexistuje." />
            <Comment_cs>Neplatný WID proměnné</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>33</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="Db" />
            <Text Lang="cs-CZ" Text="Neplatný handle proměnné %0w" />
            <Comment_cs>Neplatný vnitřní identifikátor proměnné</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>34</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="Db" />
            <Text Lang="cs-CZ" Text="Neplatný typ %1sw proměnné %0i" />
            <Comment_cs>Neplatný typ proměnné</Comment_cs>
            <DWTabulka>Typy</DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>35</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="Db" />
            <Text Lang="cs-CZ" Text="Neplatný řádek %1w proměnné %0w" />
            <Comment_cs>Neplatný řádek proměnné</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>36</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="Db" />
            <Text Lang="cs-CZ" Text="Neplatný sloupec %1w proměnné %0w" />
            <Comment_cs>Neplatný sloupec proměnné</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>37</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="Db" />
            <Text Lang="cs-CZ" Text="Neplatný počet řádků %1w proměnné %0w" />
            <Comment_cs>Neplatný počet řádků proměnné</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>38</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="Db" />
            <Text Lang="cs-CZ" Text="Neplatný počet sloupců %1w proměnné %0w" />
            <Comment_cs>Neplatný počet sloupců proměnné</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32772</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="val" />
            <Text Lang="cs-CZ" Text="U ventilu %0w - %1w jsou oba dva KS sepnuty" />
            <Comment_cs>U ventilu jsou oba koncové spínače sepnuté</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32773</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="val" />
            <Text Lang="cs-CZ" Text="U ventilu %0w - %1w jsou oba dva KS v pořádku" />
            <Comment_cs>U ventilu jsou oba koncové spínače v pořádku</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32774</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="val" />
            <Text Lang="cs-CZ" Text="Ventil %0w - %1w nedojel na KS OTEVRENO" />
            <Comment_cs>Ventil nedojel v časovém limitu na koncový spínač OTEVŘENO</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32775</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="val" />
            <Text Lang="cs-CZ" Text="Ventil %0w - %1w nedojel na KS ZAVRENO" />
            <Comment_cs>Ventil nedojel v časovém limitu na koncový spínač OTEVŘENO</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32776</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="val" />
            <Text Lang="cs-CZ" Text="Ventil %0w - %1w dojel na KS OTEVRENO" />
            <Comment_cs>Ventil dojel na koncový spínač OTEVŘENO</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32777</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="val" />
            <Text Lang="cs-CZ" Text="Ventil %0w - %1w dojel na KS ZAVRENO" />
            <Comment_cs>Ventil dojel na koncový spínač ZAVŘENO</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32800</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="lcd" />
            <Text Lang="cs-CZ" Text="Nelze vložit čtecí požadavek do buferu %sl" />
            <Comment_cs>Nelze vložit čtecí požadavek</Comment_cs>
            <DWTabulka>Bufer</DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32801</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="lcd" />
            <Text Lang="cs-CZ" Text="Nelze vložit zápisový požadavek do buferu %sl" />
            <Comment_cs>Nelze vložit zápisový požadavek</Comment_cs>
            <DWTabulka>Bufer</DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32802</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="lcd" />
            <Text Lang="cs-CZ" Text="Přihlášení uživatele %0w" />
            <Comment_cs>Přihlášení uživatele</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>32803</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="lcd" />
            <Text Lang="cs-CZ" Text="Odhlašení uživatele %0w" />
            <Comment_cs>Odhlášení uživatele</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>50</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Studený start aplikace" />
            <Comment_cs>Studený start aplikace</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>51</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Teplý start aplikace (výpadek: %T)" />
            <Comment_cs>Teplý start aplikace</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>52</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Chyba inicializace RTOS %w" />
            <Comment_cs>Chyba inicializace RTOS</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>53</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Chybný uživatelský zápis do provozního deníku %w" />
            <Comment_cs>Chybný zápis do provozního deníku</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>54</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Přístup na neplatný index matice (%w, %l, %g)" />
            <Comment_cs>Přístup na neplatný index matice (objekt, řádka, 0)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>58</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Přístup na nepřiřazenou referenci (%w, %l, %g)" />
            <Comment_cs>Přístup na nepřiřazenou referenci (objekt, řádka, 0)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>59</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Reference je nesprávného typu (%w, %l, %g)" />
            <Comment_cs>Reference je nesprávného typu (objekt, řádka, 0)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>60</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Přístup na neplatný index bitu (%w, %l, %g)" />
            <Comment_cs>Přístup na neplatný index bitu (objekt, řádka, 0)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>61</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Neplatný vstupní parametr (%w, %l, %g)" />
            <Comment_cs>Neplatný vstupní parametr (objekt, řádka, 0)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>62</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Ethernet link ETH%w %l" />
            <Comment_cs>Ethernet kabel 0=odpojen, 1=připojen</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>63</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="EAP status %w (err code %l)" />
            <Comment_cs>EAP status 0=OK, 1=error (kód chyby)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>64</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Poškozena zálohovaná paměť (err code %w)" />
            <Comment_cs>EAP status 0=OK, 1=error (kód chyby)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>65</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Kritická chyba definice Ethernet komunikace." />
            <Comment_cs>Nedostatečně dlouhá interní tabulka pro Ethernet komunikace.</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>66</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Reference má nesprávné dimenze (%w, %l, %g)" />
            <Comment_cs>Reference má nesprávné dimenze (matice, očekávaná dimenze, aktuální dimenze)</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>67</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Reset způsoben watchdogem (code %w)" />
            <Comment_cs>Reset způsoben watchdogem 0=obrazovky, 1=procesy, 2=ethernet</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
          <Format Class="Amit.DetStudio.Shared.DteItem">
            <Kod>68</Kod>
            <System>True</System>
            <Prefix Lang="cs-CZ" Text="esi" />
            <Text Lang="cs-CZ" Text="Čas přenastaven na: %T" />
            <Comment_cs>Přenastaven čas ve stanici</Comment_cs>
            <DWTabulka>
            </DWTabulka>
            <FTabulka>
            </FTabulka>
          </Format>
        </Formaty>
        <Tabulky>
          <Tabulka Class="Amit.DetStudio.Shared.DteTable">
            <Nazev>Bufer</Nazev>
            <Comment>
            </Comment>
            <Typ>Long</Typ>
            <Polozky>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>0</Dolni>
                <Horni>0</Horni>
                <Text Lang="cs-CZ" Text="NOSu" />
              </Polozka>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>65536</Dolni>
                <Horni>65536</Horni>
                <Text Lang="cs-CZ" Text="LCDSHELLu" />
              </Polozka>
            </Polozky>
          </Tabulka>
          <Tabulka Class="Amit.DetStudio.Shared.DteTable">
            <Nazev>Typy</Nazev>
            <Comment>
            </Comment>
            <Typ>Long</Typ>
            <Polozky>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>0</Dolni>
                <Horni>0</Horni>
                <Text Lang="cs-CZ" Text="DBT_INT" />
              </Polozka>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>1</Dolni>
                <Horni>1</Horni>
                <Text Lang="cs-CZ" Text="DBT_LONG" />
              </Polozka>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>2</Dolni>
                <Horni>2</Horni>
                <Text Lang="cs-CZ" Text="DBT_FLOAT" />
              </Polozka>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>3</Dolni>
                <Horni>3</Horni>
                <Text Lang="cs-CZ" Text="DBT_INTMTX" />
              </Polozka>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>4</Dolni>
                <Horni>4</Horni>
                <Text Lang="cs-CZ" Text="DBT_LONGMTX" />
              </Polozka>
              <Polozka Class="Amit.DetStudio.Shared.DteTable+DteTableItemFloat">
                <Dolni>5</Dolni>
                <Horni>5</Horni>
                <Text Lang="cs-CZ" Text="DBT_FLOATMTX" />
              </Polozka>
            </Polozky>
          </Tabulka>
        </Tabulky>
      </DteData>
      <Metadata />
    </Data>
    <DataManager>
      <Investigator Name="LoadSave" Class="Amit.Ngs.Ide.NgsDataManagerControl">
        <Settings>
          <FilterExcludeArray>False</FilterExcludeArray>
          <FilterDimRow>10</FilterDimRow>
          <FilterDimCol>10</FilterDimCol>
          <FilterExcludeArchive>False</FilterExcludeArchive>
          <FilterExcludeLogger>False</FilterExcludeLogger>
          <FilterExcludeIO>False</FilterExcludeIO>
          <FilterExcludeReadOnly>True</FilterExcludeReadOnly>
          <UserFilter>False</UserFilter>
          <FilterInclude>ALL</FilterInclude>
          <ExpandNodes>
          </ExpandNodes>
          <Include>
          </Include>
        </Settings>
        <Files />
      </Investigator>
      <StoreRestore>
        <Settings>
          <FilterExcludeArray>False</FilterExcludeArray>
          <FilterDimRow>10</FilterDimRow>
          <FilterDimCol>10</FilterDimCol>
          <FilterExcludeArchive>False</FilterExcludeArchive>
          <FilterExcludeLogger>False</FilterExcludeLogger>
          <FilterExcludeIO>True</FilterExcludeIO>
          <FilterExcludeReadOnly>True</FilterExcludeReadOnly>
          <UserFilter>False</UserFilter>
          <FilterInclude>ALL</FilterInclude>
          <ExpandNodes>
          </ExpandNodes>
          <Include>
          </Include>
        </Settings>
      </StoreRestore>
    </DataManager>
    <Exporter>
      <StoreRestore>
        <Settings>
          <FilterExcludeArchive>False</FilterExcludeArchive>
          <UserFilter>False</UserFilter>
          <FilterExcludeDayPlanObject>False</FilterExcludeDayPlanObject>
          <FilterExcludeDaysOffDatasObject>False</FilterExcludeDaysOffDatasObject>
          <FilterExcludeHolidaysObject>False</FilterExcludeHolidaysObject>
          <FilterInclude>ALL</FilterInclude>
          <ExpandNodes>
          </ExpandNodes>
          <Include>
          </Include>
        </Settings>
      </StoreRestore>
    </Exporter>
  </Project>
</DetStation>